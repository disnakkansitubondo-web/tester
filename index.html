<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APLIKASI BARJAS - SISTEM BANTUAN</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary-color: #0d47a1;
            --secondary-color: #00695c;
            --accent-color: #ff8f00;
            --light-blue: #e3f2fd;
            --dark-blue: #082e5c;
            --gradient-primary: linear-gradient(135deg, var(--primary-color), var(--dark-blue));
            --gradient-secondary: linear-gradient(135deg, var(--secondary-color), #004d40);
            --gradient-accent: linear-gradient(135deg, var(--accent-color), #e65100);
            --shadow-sm: 0 2px 8px rgba(0,0,0,0.08);
            --shadow-md: 0 4px 16px rgba(0,0,0,0.12);
            --shadow-lg: 0 8px 28px rgba(0,0,0,0.15);
            --login-gradient: linear-gradient(135deg, #0d47a1, #00695c, #ff8f00);
        }
        
        body {
            background: linear-gradient(135deg, #f5f9ff 0%, #e8f5e9 100%);
            font-family: 'Poppins', 'Segoe UI', sans-serif;
            min-height: 100vh;
            padding: 10px 0;
            overflow-x: hidden;
        }
        
        .app-container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            box-shadow: var(--shadow-lg);
            border-radius: 12px;
            overflow: hidden;
            position: relative;
            z-index: 10;
        }
        
        .app-header {
            background: var(--gradient-primary);
            color: white;
            padding: 20px 15px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .app-header::before {
            content: "";
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.15) 0%, transparent 70%);
            pointer-events: none;
        }
        
        .app-logo {
            font-size: 2.5rem;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }
        
        .app-title {
            font-size: 1.8rem;
            font-weight: 800;
            margin: 0;
            position: relative;
            z-index: 1;
            text-shadow: 1px 1px 4px rgba(0,0,0,0.3);
        }
        
        .app-subtitle {
            font-size: 1rem;
            opacity: 0.95;
            position: relative;
            z-index: 1;
            font-weight: 300;
            letter-spacing: 0.5px;
            margin-bottom: 5px;
        }
        
        .nav-pills .nav-link {
            border-radius: 8px;
            margin-bottom: 8px;
            padding: 12px 15px;
            font-weight: 500;
            color: #444;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            font-size: 0.9rem;
        }
        
        .nav-pills .nav-link:hover {
            background-color: #f0f7ff;
            transform: translateX(3px);
        }
        
        .nav-pills .nav-link.active {
            background: var(--gradient-primary);
            font-weight: 600;
            box-shadow: var(--shadow-md);
            transform: translateX(3px);
            color: white;
        }
        
        .section-title {
            border-left: 4px solid var(--primary-color);
            padding-left: 12px;
            margin: 20px 0;
            font-weight: 700;
            color: var(--dark-blue);
            font-size: 1.4rem;
            position: relative;
        }
        
        .section-title::after {
            content: "";
            position: absolute;
            bottom: -5px;
            left: 12px;
            width: 40px;
            height: 2px;
            background: var(--gradient-primary);
            border-radius: 2px;
        }
        
        .btn-primary {
            background: var(--gradient-primary);
            border: none;
            padding: 10px 20px;
            font-weight: 600;
            box-shadow: var(--shadow-md);
            border-radius: 8px;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .btn-success {
            background: var(--gradient-secondary);
            border: none;
            padding: 10px 20px;
            font-weight: 600;
            box-shadow: var(--shadow-md);
            border-radius: 8px;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .btn-warning {
            background: var(--gradient-accent);
            border: none;
            padding: 10px 20px;
            font-weight: 600;
            box-shadow: var(--shadow-md);
            border-radius: 8px;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .btn-warning:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .form-label {
            font-weight: 600;
            color: #444;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            font-size: 0.9rem;
        }
        
        .form-label i {
            margin-right: 6px;
            color: var(--primary-color);
        }
        
        .form-control, .form-select {
            border-radius: 8px;
            padding: 12px 15px;
            border: 1px solid #ddd;
            transition: all 0.3s;
            box-shadow: var(--shadow-sm);
            font-size: 0.9rem;
        }
        
        .form-control:focus, .form-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(13, 71, 161, 0.2);
            transform: translateY(-2px);
        }
        
        .copyright {
            text-align: center;
            padding: 20px;
            background-color: var(--light-blue);
            color: var(--dark-blue);
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .data-table {
            font-size: 0.85rem;
            border-collapse: separate;
            border-spacing: 0;
            box-shadow: var(--shadow-sm);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .data-table th {
            background: var(--gradient-primary);
            color: white;
            font-weight: 600;
            padding: 12px 10px;
            text-align: center;
            position: relative;
            font-size: 0.85rem;
        }
        
        .data-table th::after {
            content: "";
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 1px;
            background: rgba(255,255,255,0.3);
        }
        
        .data-table td {
            padding: 10px 8px;
            vertical-align: middle;
            border-bottom: 1px solid #eee;
            font-size: 0.85rem;
        }
        
        .data-table tr:nth-child(even) {
            background-color: #f9fbff;
        }
        
        .data-table tr:hover {
            background-color: #edf5ff;
        }
        
        .feature-icon {
            font-size: 1.1rem;
            margin-right: 8px;
            width: 24px;
            text-align: center;
        }
        
        .card {
            border-radius: 10px;
            border: none;
            box-shadow: var(--shadow-md);
            transition: all 0.3s ease;
            overflow: hidden;
            margin-bottom: 15px;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        
        .card-header {
            border-radius: 10px 10px 0 0 !important;
            font-weight: 600;
            padding: 15px 20px;
            background: var(--gradient-primary);
            color: white;
            font-size: 0.95rem;
        }
        
        .stats-box {
            text-align: center;
            padding: 20px 15px;
            border-radius: 10px;
            background: white;
            box-shadow: var(--shadow-md);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
            margin-bottom: 15px;
        }
        
        .stats-box::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--gradient-primary);
            border-radius: 2px;
        }
        
        .stats-box:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }
        
        .stats-number {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--primary-color);
            margin: 10px 0;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        
        .stats-label {
            font-size: 0.9rem;
            color: #666;
            font-weight: 500;
        }
        
        .notification-toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1050;
            min-width: 280px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: var(--shadow-lg);
            max-width: calc(100vw - 40px);
        }
        
        .input-error {
            border-color: #dc3545;
            box-shadow: 0 0 0 3px rgba(220, 53, 69, 0.2);
        }
        
        .error-message {
            color: #dc3545;
            font-size: 0.8rem;
            margin-top: 5px;
            display: none;
            font-weight: 500;
        }
        
        .watermark {
            position: absolute;
            bottom: 10px;
            right: 15px;
            opacity: 0.8;
            font-size: 0.8rem;
            color: white;
            font-weight: 300;
        }
        
        .control-panel {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            box-shadow: var(--shadow-sm);
        }
        
        .control-title {
            font-size: 1rem;
            color: var(--primary-color);
            font-weight: 600;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--light-blue);
        }
        
        .floating-action-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--gradient-primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .floating-action-btn:hover {
            transform: scale(1.1) rotate(90deg);
        }
        
        .filter-section {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-sm);
        }
        
        .badge-custom {
            background: var(--gradient-primary);
            color: white;
            padding: 6px 12px;
            border-radius: 16px;
            font-weight: 600;
            font-size: 0.8rem;
        }
        
        .mobile-menu-btn {
            display: none;
            position: fixed;
            top: 15px;
            left: 15px;
            z-index: 1050;
            background: var(--gradient-primary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            box-shadow: var(--shadow-lg);
        }
        
        .sidebar-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1040;
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-fadeIn {
            animation: fadeIn 0.5s ease forwards;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 8px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 8px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--dark-blue);
        }
        
        /* Responsive styles */
        @media (max-width: 991.98px) {
            .col-md-3.col-lg-2 {
                position: fixed;
                left: -300px;
                top: 0;
                bottom: 0;
                z-index: 1050;
                width: 280px;
                transition: left 0.3s ease;
                overflow-y: auto;
                padding-top: 60px;
            }
            
            .col-md-3.col-lg-2.mobile-show {
                left: 0;
            }
            
            .col-md-9.col-lg-10 {
                width: 100%;
                flex: 0 0 100%;
                max-width: 100%;
            }
            
            .mobile-menu-btn {
                display: flex;
                align-items: center;
                justify-content: center;
            }
            
            .sidebar-overlay.mobile-show {
                display: block;
            }
        }
        
        /* Print Styles - IMPROVED FOR LANDSCAPE */
        @media print {
            @page {
                size: landscape;
                margin: 0.5cm;
            }
            
            body * {
                visibility: hidden;
            }
            
            .app-container, .app-container * {
                visibility: visible;
            }
            
            .app-container {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                box-shadow: none;
            }
            
            .nav-pills, .mobile-menu-btn, .sidebar-overlay, .floating-action-btn,
            .btn-group, .filter-section, .toast {
                display: none !important;
            }
            
            .col-md-3.col-lg-2.p-4.bg-light {
                display: none !important;
            }
            
            .col-md-9.col-lg-10.p-5 {
                width: 100%;
                flex: 0 0 100%;
                max-width: 100%;
                padding: 0 !important;
            }
            
            .copyright {
                display: none;
            }
            
            .data-table {
                font-size: 10px;
                width: 100% !important;
            }
            
            .data-table th, .data-table td {
                padding: 4px 2px;
            }
            
            /* Sembunyikan kolom aksi dan link Google Drive saat mencetak */
            .data-table th:last-child,
            .data-table td:last-child {
                display: none !important;
            }
            
            /* Judul untuk laporan cetak */
            .print-header {
                display: block !important;
                text-align: center;
                margin-bottom: 15px;
            }
            
            .print-title {
                font-size: 18px;
                font-weight: bold;
                margin-bottom: 5px;
            }
            
            .print-subtitle {
                font-size: 14px;
                margin-bottom: 10px;
            }
            
            .print-date {
                font-size: 12px;
                text-align: right;
                margin-bottom: 10px;
            }
        }

        /* WhatsApp link style */
        .whatsapp-link {
            color: #25D366;
            text-decoration: none;
        }
        
        .whatsapp-link:hover {
            text-decoration: underline;
        }
        
        /* View Link Button */
        .btn-view {
            background: linear-gradient(135deg, #17a2b8, #138496);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
        }
        
        .btn-view:hover {
            background: linear-gradient(135deg, #138496, #117a8b);
            color: white;
        }
        
        /* Undo Button */
        .btn-undo {
            background: linear-gradient(135deg, #6c757d, #5a6268);
            color: white;
            border: none;
        }
        
        .btn-undo:hover {
            background: linear-gradient(135deg, #5a6268, #4e555b);
            color: white;
        }
        
        /* WhatsApp number link in table */
        .whatsapp-number {
            color: #25D366;
            cursor: pointer;
            text-decoration: underline;
        }
        
        /* Welcome Modal Styles */
        .welcome-modal .modal-content {
            border-radius: 15px;
            overflow: hidden;
            border: none;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .welcome-header {
            background: var(--gradient-primary);
            color: white;
            text-align: center;
            padding: 25px;
        }
        
        .welcome-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }
        
        .welcome-body {
            padding: 25px;
            text-align: center;
        }
        
        .welcome-footer {
            background: #f8f9fa;
            padding: 15px;
            text-align: center;
            border-top: 1px solid #eee;
        }
        
        .countdown-timer {
            font-size: 0.9rem;
            color: #6c757d;
            margin-top: 10px;
        }
        
        /* Button untuk cetak per data */
        .btn-print-individual {
            background: linear-gradient(135deg, #6f42c1, #5a2d95);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
        }
        
        .btn-print-individual:hover {
            background: linear-gradient(135deg, #5a2d95, #4a2479);
            color: white;
        }
        
        /* Developer Info Styles */
        .developer-info {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            box-shadow: var(--shadow-sm);
            font-size: 0.85rem;
        }
        
        .developer-logo {
            max-width: 120px;
            margin-bottom: 15px;
            border-radius: 8px;
        }
        
        .developer-contact a {
            color: var(--primary-color);
            text-decoration: none;
            transition: all 0.3s;
        }
        
        .developer-contact a:hover {
            color: var(--dark-blue);
            text-decoration: underline;
        }
        
        /* Welcome Splash Screen */
        .welcome-splash {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient-primary);
            color: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }
        
        .welcome-splash-content {
            text-align: center;
            max-width: 600px;
            padding: 30px;
        }
        
        .welcome-splash-logo {
            font-size: 4rem;
            margin-bottom: 20px;
        }
        
        .welcome-splash-title {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 15px;
        }
        
        .welcome-splash-message {
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 25px;
        }
        
        .welcome-splash-countdown {
            font-size: 1rem;
            margin-top: 20px;
        }
        
        .welcome-splash-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .welcome-splash-close:hover {
            background: rgba(255,255,255,0.3);
            transform: rotate(90deg);
        }
        
        /* Loading spinner */
        .spinner-border-sm {
            width: 1rem;
            height: 1rem;
        }

        /* Login Modal Styles */
        .login-modal .modal-content {
            border-radius: 15px;
            overflow: hidden;
            border: none;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .login-header {
            background: var(--login-gradient);
            color: white;
            text-align: center;
            padding: 25px 20px;
            position: relative;
        }

        .login-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            color: white;
        }

        .login-title {
            font-size: 1.8rem;
            font-weight: 700;
            margin: 0;
        }

        .login-subtitle {
            font-size: 1rem;
            opacity: 0.9;
            margin: 5px 0 0;
        }

        .login-body {
            padding: 25px;
            position: relative;
            z-index: 1;
        }

        .login-form-group {
            margin-bottom: 20px;
        }

        .login-form-label {
            font-weight: 600;
            color: var(--dark-blue);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
        }

        .login-form-label i {
            margin-right: 10px;
            color: var(--dark-blue);
        }

        .login-form-control {
            border-radius: 8px;
            padding: 12px 15px;
            border: 2px solid #ddd;
            transition: all 0.3s;
        }

        .login-form-control:focus {
            border-color: var(--dark-blue);
            box-shadow: 0 0 0 3px rgba(13, 71, 161, 0.2);
        }

        .login-input-group-text {
            background: var(--light-blue);
            border: 2px solid #ddd;
            border-left: none;
        }

        .btn-login {
            background: var(--gradient-secondary);
            color: white;
            border: none;
            padding: 12px;
            font-weight: 600;
            border-radius: 8px;
            width: 100%;
            transition: all 0.3s;
            margin-top: 10px;
        }

        .btn-login:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 105, 92, 0.4);
        }

        .btn-login:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .login-security-notice {
            text-align: center;
            margin-top: 20px;
            font-size: 0.85rem;
            color: #666;
        }

        .login-attempts-count {
            text-align: center;
            font-size: 0.9rem;
            color: #ff8f00;
            font-weight: 500;
            margin-top: 5px;
        }

        .login-blocked-message {
            text-align: center;
            background: rgba(220, 53, 69, 0.1);
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            color: #dc3545;
            font-weight: 500;
        }

        .login-countdown {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--dark-blue);
        }

        .login-developer-info {
            background: var(--light-blue);
            border-radius: 10px;
            padding: 20px;
            margin-top: 25px;
            text-align: center;
        }

        .login-developer-logo {
            max-width: 180px;
            margin-bottom: 15px;
            border-radius: 8px;
        }

        .login-developer-contact a {
            color: var(--dark-blue);
            text-decoration: none;
            transition: all 0.3s;
            display: inline-block;
            margin: 5px 0;
        }

        .login-developer-contact a:hover {
            color: var(--primary-color);
            text-decoration: underline;
            transform: translateY(-2px);
        }

        .login-copyright {
            text-align: center;
            margin-top: 20px;
            color: #666;
            font-size: 0.9rem;
            opacity: 0.9;
        }

        /* Animations */
        @keyframes login-shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-10px); }
            20%, 40%, 60%, 80% { transform: translateX(10px); }
        }

        .login-shake {
            animation: login-shake 0.6s cubic-bezier(.36,.07,.19,.97) both;
        }

        /* Login particle background */
        #login-particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1040; /* Higher than modal backdrop */
            display: none;
        }

        /* Link Google Drive dalam tabel */
        .drive-link {
            color: #0d47a1;
            text-decoration: none;
            cursor: pointer;
        }

        .drive-link:hover {
            text-decoration: underline;
        }

        /* Modal untuk menambah link */
        .link-modal .modal-dialog {
            max-width: 600px;
        }
        
        /* App content when not authenticated */
        .app-content-unauthenticated {
            display: none;
        }

        /* Search box for desa dropdown */
        .desa-search-container {
            position: relative;
        }
        
        .desa-search-input {
            margin-bottom: 8px;
        }
        
        .desa-dropdown-menu {
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <!-- Login Modal -->
    <div class="modal fade login-modal" id="loginModal" tabindex="-1" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="login-header">
                    <div class="login-icon">
                        <i class="fas fa-lock"></i>
                    </div>
                    <h2 class="login-title">AUTHENTICATION REQUIRED</h2>
                    <p class="login-subtitle">Masukkan Kode Keamanan untuk Mengakses Aplikasi</p>
                </div>
                <div class="login-body">
                    <form id="loginForm">
                        <div class="mb-3 login-form-group">
                            <label class="form-label login-form-label">
                                <i class="fas fa-key"></i> Kode Keamanan
                            </label>
                            <div class="input-group">
                                <input type="password" class="form-control login-form-control" id="securityCode" placeholder="Masukkan kode akses aplikasi">
                                <button class="btn btn-outline-secondary toggle-password" type="button">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                            <div class="form-text text-danger login-attempts-count" id="attemptsCount"></div>
                        </div>
                        <button type="submit" class="btn btn-login" id="loginButton">
                            <span class="login-button-text">Masuk ke Aplikasi</span>
                            <span class="spinner-border spinner-border-sm d-none" id="loginSpinner"></span>
                        </button>
                    </form>
                    
                    <div class="login-blocked-message d-none" id="blockedMessage">
                        <i class="fas fa-ban me-2"></i>
                        <span id="blockedText">Terlalu banyak percobaan gagal. Silakan coba lagi dalam </span>
                        <span class="login-countdown" id="countdown">30</span> detik.
                    </div>
                    
                    <div class="login-security-notice">
                        <i class="fas fa-info-circle me-2"></i>
                        Hubungi Administrator untuk mendapatkan kode akses
                    </div>
                    
                    <div class="login-developer-info">
                        <h5 class="mb-3">Developer Information</h5>
                        <div class="login-developer-contact">
                            <p><i class="fab fa-whatsapp me-2"></i> <a href="https://wa.me/6285647709114" target="_blank">+62 856-4770-9114</a></p>
                            <p><i class="fas fa-envelope me-2"></i> <a href="mailto:admin@anekamarket.my.id">admin@anekamarket.my.id</a></p>
                        </div>
                    </div>
                    
                    <div class="login-copyright">
                        &copy; 2025 Lentera karya Situbondo
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Login particle background -->
    <div id="login-particles"></div>
    
    <!-- Welcome Splash Screen -->
    <div class="welcome-splash" id="welcomeSplash">
        <button class="welcome-splash-close" id="closeSplash">
            <i class="fas fa-times"></i>
        </button>
        <div class="welcome-splash-content">
            <div class="welcome-splash-logo">
                <i class="fas fa-hands-helping"></i>
            </div>
            <h1 class="welcome-splash-title">SISTEM BANTUAN BARJAS</h1>
            <p class="welcome-splash-message">
                Aplikasi Sistem Bantuan BARJAS merupakan platform terpadu yang dirancang untuk mentransformasi pendataan, penyaluran, 
                dan monitoring program bantuan pemerintah. Aplikasi ini kami ciptakan untuk mendorong efisiensi, akurasi, 
                dan transparansi dalam pengelolaan bantuan, guna mempercepat penyerapan dan meningkatkan akuntabilitas.
            </p>
            <div class="welcome-splash-countdown" id="splashCountdown">
                Membuka aplikasi dalam <span id="countdownTimer">5</span> detik...
            </div>
        </div>
    </div>
    
    <!-- Main Application Content (initially hidden) -->
    <div class="app-content-unauthenticated" id="appContent">
        <!-- Mobile Menu Button -->
        <button class="mobile-menu-btn" id="mobileMenuBtn">
            <i class="fas fa-bars"></i>
        </button>
        
        <!-- Sidebar Overlay -->
        <div class="sidebar-overlay" id="sidebarOverlay"></div>
        
        <div class="app-container animate-fadeIn">
            <div class="app-header">
                <div class="app-logo">
                    <i class="fas fa-hands-helping"></i>
                </div>
                <h1 class="app-title">BARJAS</h1>
                <p class="app-subtitle">Sistem Bantuan Terpadu</p>
                <p class="app-subtitle" id="institutionName">Dinas Peternakan dan Perikanan Kabupaten Situbondo</p>
                <div class="watermark">v2.1.0</div>
            </div>
            
            <div class="row g-0">
                <!-- Sidebar Navigation -->
                <div class="col-md-3 col-lg-2 p-4 bg-light" id="sidebar">
                    <ul class="nav nav-pills flex-column mb-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link active" data-bs-target="dashboard">
                                <span class="feature-icon"><i class="fas fa-tachometer-alt"></i></span>
                                Dashboard
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-target="inputData">
                                <span class="feature-icon"><i class="fas fa-pencil-alt"></i></span>
                                Input Data Bantuan
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-target="dataTable">
                                <span class="feature-icon"><i class="fas fa-table"></i></span>
                                Tabel Data Bantuan
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-target="statistik">
                                <span class="feature-icon"><i class="fas fa-chart-pie"></i></span>
                                Statistik
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-target="pengaturan">
                                <span class="feature-icon"><i class="fas fa-cog"></i></span>
                                Pengaturan
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" id="logoutButton">
                                <span class="feature-icon"><i class="fas fa-sign-out-alt"></i></span>
                                Keluar
                            </a>
                        </li>
                    </ul>
                    
                    <!-- Developer Information -->
                    <div class="developer-info">
                        <h6 class="mb-3 text-center">Developer Information</h6>
                        <div class="developer-contact text-center">
                            <p><i class="fab fa-whatsapp me-2"></i> <a href="https://wa.me/6285647709114" target="_blank" class="whatsapp-link">+62 856-4770-9114</a></p>
                            <p><i class="fas fa-envelope me-2"></i> <a href="mailto:admin@anekamarket.my.id">admin@anekamarket.my.id</a></p>
                        </div>
                    </div>
                </div>
                
                <!-- Main Content -->
                <div class="col-md-9 col-lg-10 p-5">
                    <!-- Dashboard Section -->
                    <div class="content-section" id="dashboard">
                        <h3 class="section-title">Dashboard</h3>
                        
                        <div class="row mb-4">
                            <div class="col-md-3">
                                <div class="stats-box">
                                    <i class="fas fa-users fa-2x text-primary"></i>
                                    <div class="stats-number" id="totalPenerima">0</div>
                                    <div class="stats-label">Total Penerima</div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="stats-box">
                                    <i class="fas fa-hand-holding-usd fa-2x text-success"></i>
                                    <div class="stats-number" id="totalBantuan">0</div>
                                    <div class="stats-label">Total Bantuan</div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="stats-box">
                                    <i class="fas fa-map-marker-alt fa-2x text-warning"></i>
                                    <div class="stats-number" id="totalDesa">0</div>
                                    <div class="stats-label">Desa Terjangkau</div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="stats-box">
                                    <i class="fas fa-calendar-alt fa-2x text-info"></i>
                                    <div class="stats-number" id="tahunAktif">2025</div>
                                    <div class="stats-label">Tahun Anggaran</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-8">
                                <div class="card mb-4">
                                    <div class="card-header">
                                        <i class="fas fa-chart-bar me-2"></i> Statistik Bantuan per Desa
                                    </div>
                                    <div class="card-body">
                                        <canvas id="desaChart" height="250"></canvas>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card mb-4">
                                    <div class="card-header">
                                        <i class="fas fa-chart-pie me-2"></i> Jenis Bantuan
                                    </div>
                                    <div class="card-body">
                                        <canvas id="jenisChart" height="250"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <i class="fas fa-history me-2"></i> Data Bantuan Terbaru
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover data-table">
                                        <thead>
                                            <tr>
                                                <th>No</th>
                                                <th>Nama</th>
                                                <th>Desa</th>
                                                <th>Jenis Bantuan</th>
                                                <th>Tanggal</th>
                                                <th>Jumlah</th>
                                                <th>Aksi</th>
                                            </tr>
                                        </thead>
                                        <tbody id="recentDataTable">
                                            <tr>
                                                <td colspan="7" class="text-center">Tidak ada data</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Input Data Section -->
                    <div class="content-section d-none" id="inputData">
                        <h3 class="section-title">Input Data Bantuan</h3>
                        
                        <div class="card mb-4">
                            <div class="card-header">
                                <i class="fas fa-pencil-alt me-2"></i> Form Input Data
                            </div>
                            <div class="card-body">
                                <form id="bantuanForm">
                                    <div class="row mb-3">
                                        <div class="col-md-6">
                                            <label for="nama" class="form-label">
                                                <i class="fas fa-user"></i> Nama Penerima
                                            </label>
                                            <input type="text" class="form-control" id="nama" required>
                                            <div class="error-message" id="namaError"></div>
                                        </div>
                                        <div class="col-md-6">
                                            <label for="nik" class="form-label">
                                                <i class="fas fa-id-card"></i> NIK (16 digit)
                                            </label>
                                            <input type="text" class="form-control" id="nik" maxlength="16" required>
                                            <div class="error-message" id="nikError">NIK harus 16 digit angka</div>
                                        </div>
                                    </div>
                                    
                                    <div class="row mb-3">
                                        <div class="col-md-6">
                                            <label for="namaKelompok" class="form-label">
                                                <i class="fas fa-users"></i> Nama Kelompok
                                            </label>
                                            <input type="text" class="form-control" id="namaKelompok" oninput="this.value = this.value.toUpperCase()">
                                        </div>
                                        <div class="col-md-6">
                                            <label for="jabatan" class="form-label">
                                                <i class="fas fa-user-tag"></i> Jabatan
                                            </label>
                                            <select class="form-select" id="jabatan">
                                                <option value="">Pilih Jabatan</option>
                                                <option value="Ketua Kelompok">Ketua Kelompok</option>
                                                <option value="Sekretaris">Sekretaris</option>
                                                <option value="Bendahara">Bendahara</option>
                                                <option value="Pengawas">Pengawas</option>
                                                <option value="Anggota">Anggota</option>
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <div class="row mb-3">
                                        <div class="col-md-6">
                                            <label for="tahunAnggaran" class="form-label">
                                                <i class="fas fa-calendar-alt"></i> Tahun Anggaran
                                            </label>
                                            <select class="form-select" id="tahunAnggaran" required>
                                                <option value="">Pilih Tahun</option>
                                                <!-- Tahun akan diisi oleh JavaScript -->
                                            </select>
                                        </div>
                                        <div class="col-md-6">
                                            <label for="jenisBantuan" class="form-label">
                                                <i class="fas fa-gift"></i> Jenis Bantuan
                                            </label>
                                            <select class="form-select" id="jenisBantuan" required>
                                                <option value="">Pilih Jenis Bantuan</option>
                                                <option value="Bibit Sapi">Bibit Sapi</option>
                                                <option value="Bibit Kambing">Bibit Kambing</option>
                                                <option value="Pakan Ternak">Pakan Ternak</option>
                                                <option value="Vitamin Hewan">Vitamin Hewan</option>
                                                <option value="Alat Pertanian">Alat Pertanian</option>
                                                <option value="Bantuan Tunai">Bantuan Tunai</option>
                                            </select>
                                            <div class="error-message" id="jenisBantuanError"></div>
                                        </div>
                                    </div>
                                    
                                    <div class="row mb-3">
                                        <div class="col-md-6">
                                            <label for="desa" class="form-label">
                                                <i class="fas fa-map-marker-alt"></i> Desa/Kelurahan
                                            </label>
                                            <div class="desa-search-container">
                                                <input type="text" class="form-control desa-search-input" id="desaSearch" placeholder="Cari desa...">
                                                <select class="form-select" id="desa" required>
                                                    <option value="">Pilih Desa/Kelurahan</option>
                                                    <!-- Opsi desa akan diisi oleh JavaScript -->
                                                </select>
                                            </div>
                                            <div class="error-message" id="desaError"></div>
                                        </div>
                                        <div class="col-md-6">
                                            <label for="jumlah" class="form-label">
                                                <i class="fas fa-coins"></i> Jumlah Bantuan
                                            </label>
                                            <input type="number" class="form-control" id="jumlah" min="1" required>
                                            <div class="error-message" id="jumlahError"></div>
                                        </div>
                                    </div>
                                    
                                    <div class="row mb-3">
                                        <div class="col-md-6">
                                            <label for="tanggal" class="form-label">
                                                <i class="fas fa-calendar"></i> Tanggal Penyerahan
                                            </label>
                                            <input type="date" class="form-control" id="tanggal" required>
                                            <div class="error-message" id="tanggalError"></div>
                                        </div>
                                        <div class="col-md-6">
                                            <label for="driveLink" class="form-label">
                                                <i class="fab fa-google-drive"></i> Link Google Drive (opsional)
                                            </label>
                                            <input type="url" class="form-control" id="driveLink" placeholder="https://drive.google.com/...">
                                        </div>
                                    </div>
                                    
                                    <div class="row mb-3">
                                        <div class="col-md-12">
                                            <label for="keterangan" class="form-label">
                                                <i class="fas fa-sticky-note"></i> Keterangan (opsional)
                                            </label>
                                            <textarea class="form-control" id="keterangan" rows="2"></textarea>
                                        </div>
                                    </div>
                                    
                                    <div class="d-flex justify-content-end mt-4">
                                        <button type="reset" class="btn btn-secondary me-3">
                                            <i class="fas fa-undo me-1"></i> Reset
                                        </button>
                                        <button type="submit" class="btn btn-primary">
                                            <i class="fas fa-save me-1"></i> Simpan Data
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Data Table Section -->
                    <div class="content-section d-none" id="dataTable">
                        <h3 class="section-title">Tabel Data Bantuan</h3>
                        
                        <div class="filter-section">
                            <div class="row">
                                <div class="col-md-3">
                                    <label for="filterTahun" class="form-label">
                                        <i class="fas fa-filter"></i> Filter Tahun
                                    </label>
                                    <select class="form-select" id="filterTahun">
                                        <option value="">Semua Tahun</option>
                                        <!-- Tahun akan diisi oleh JavaScript -->
                                    </select>
                                </div>
                                <div class="col-md-3">
                                    <label for="filterJenis" class="form-label">
                                        <i class="fas fa-filter"></i> Filter Jenis
                                    </label>
                                    <select class="form-select" id="filterJenis">
                                        <option value="">Semua Jenis</option>
                                        <option value="Bibit Sapi">Bibit Sapi</option>
                                        <option value="Bibit Kambing">Bibit Kambing</option>
                                        <option value="Pakan Ternak">Pakan Ternak</option>
                                        <option value="Vitamin Hewan">Vitamin Hewan</option>
                                        <option value="Alat Pertanian">Alat Pertanian</option>
                                        <option value="Bantuan Tunai">Bantuan Tunai</option>
                                    </select>
                                </div>
                                <div class="col-md-3">
                                    <label for="filterDesa" class="form-label">
                                        <i class="fas fa-filter"></i> Filter Desa
                                    </label>
                                    <select class="form-select" id="filterDesa">
                                        <option value="">Semua Desa</option>
                                        <!-- Opsi desa akan diisi oleh JavaScript -->
                                    </select>
                                </div>
                                <div class="col-md-3">
                                    <label for="searchInput" class="form-label">
                                        <i class="fas fa-search"></i> Pencarian
                                    </label>
                                    <input type="text" class="form-control" id="searchInput" placeholder="Cari data...">
                                </div>
                            </div>
                        </div>
                        
                        <div class="control-panel">
                            <div class="control-title">Kelola Data</div>
                            <div class="d-flex flex-wrap gap-2">
                                <button class="btn btn-primary" id="exportExcelBtn">
                                    <i class="fas fa-file-excel me-1"></i> Export Excel
                                </button>
                                <button class="btn btn-success" id="exportPDFBtn">
                                    <i class="fas fa-file-pdf me-1"></i> Export PDF
                                </button>
                                <button class="btn btn-warning" id="printBtn">
                                    <i class="fas fa-print me-1"></i> Cetak
                                </button>
                                <button class="btn btn-danger" id="deleteAllBtn">
                                    <i class="fas fa-trash-alt me-1"></i> Hapus Semua Data
                                </button>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <div>
                                    <i class="fas fa-table me-2"></i> Data Bantuan
                                </div>
                                <div class="badge badge-custom" id="totalRecords">0 Data</div>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover data-table">
                                        <thead>
                                            <tr>
                                                <th>No</th>
                                                <th>Nama</th>
                                                <th>NIK</th>
                                                <th>Nama Kelompok</th>
                                                <th>Jabatan</th>
                                                <th>Tahun</th>
                                                <th>Jenis Bantuan</th>
                                                <th>Desa</th>
                                                <th>Jumlah</th>
                                                <th>Tanggal</th>
                                                <th>Link Drive</th>
                                                <th>Aksi</th>
                                            </tr>
                                        </thead>
                                        <tbody id="dataTableBody">
                                            <tr>
                                                <td colspan="12" class="text-center">Tidak ada data</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                
                                <nav aria-label="Page navigation">
                                    <ul class="pagination justify-content-center" id="pagination">
                                        <li class="page-item disabled">
                                            <a class="page-link" href="#" tabindex="-1">Previous</a>
                                        </li>
                                        <li class="page-item active"><a class="page-link" href="#">1</a></li>
                                        <li class="page-item">
                                            <a class="page-link" href="#">Next</a>
                                        </li>
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Statistik Section -->
                    <div class="content-section d-none" id="statistik">
                        <h3 class="section-title">Statistik Bantuan</h3>
                        
                        <div class="row mb-4">
                            <div class="col-md-4">
                                <div class="card">
                                    <div class="card-header">
                                        <i class="fas fa-filter me-2"></i> Filter Statistik
                                    </div>
                                    <div class="card-body">
                                        <div class="mb-3">
                                            <label for="statTahun" class="form-label">Tahun</label>
                                            <select class="form-select" id="statTahun">
                                                <option value="">Semua Tahun</option>
                                                <!-- Tahun akan diisi oleh JavaScript -->
                                            </select>
                                        </div>
                                        <div class="mb-3">
                                            <label for="statJenis" class="form-label">Jenis Bantuan</label>
                                            <select class="form-select" id="statJenis">
                                                <option value="">Semua Jenis</option>
                                                <option value="Bibit Sapi">Bibit Sapi</option>
                                                <option value="Bibit Kambing">Bibit Kambing</option>
                                                <option value="Pakan Ternak">Pakan Ternak</option>
                                                <option value="Vitamin Hewan">Vitamin Hewan</option>
                                                <option value="Alat Pertanian">Alat Pertanian</option>
                                                <option value="Bantuan Tunai">Bantuan Tunai</option>
                                            </select>
                                        </div>
                                        <button class="btn btn-primary w-100" id="generateStatBtn">
                                            <i class="fas fa-chart-line me-1"></i> Generate Statistik
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-8">
                                <div class="card mb-4">
                                    <div class="card-header">
                                        <i class="fas fa-chart-bar me-2"></i> Grafik Bantuan per Bulan
                                    </div>
                                    <div class="card-body">
                                        <canvas id="monthlyChart" height="250"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="card mb-4">
                                    <div class="card-header">
                                        <i class="fas fa-chart-pie me-2"></i> Distribusi per Jenis Bantuan
                                    </div>
                                    <div class="card-body">
                                        <canvas id="distributionChart" height="250"></canvas>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-header">
                                        <i class="fas fa-map me-2"></i> Distribusi per Desa
                                    </div>
                                    <div class="card-body">
                                        <canvas id="desaDistributionChart" height="250"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Pengaturan Section -->
                    <div class="content-section d-none" id="pengaturan">
                        <h3 class="section-title">Pengaturan Aplikasi</h3>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="card mb-4">
                                    <div class="card-header">
                                        <i class="fas fa-database me-2"></i> Kelola Data
                                    </div>
                                    <div class="card-body">
                                        <div class="mb-3">
                                            <label class="form-label">Backup Data</label>
                                            <p class="text-muted small">Simpan salinan data ke file JSON</p>
                                            <button class="btn btn-primary w-100" id="backupBtn">
                                                <i class="fas fa-download me-1"></i> Backup Data
                                            </button>
                                        </div>
                                        
                                        <div class="mb-3">
                                            <label class="form-label">Restore Data</label>
                                            <p class="text-muted small">Muat data dari file JSON backup</p>
                                            <input type="file" class="form-control mb-2" id="restoreFile" accept=".json">
                                            <button class="btn btn-success w-100" id="restoreBtn">
                                                <i class="fas fa-upload me-1"></i> Restore Data
                                            </button>
                                        </div>
                                        
                                        <div class="mb-3">
                                            <label class="form-label">Hapus Semua Data</label>
                                            <p class="text-muted small">Hapus permanen semua data dari aplikasi</p>
                                            <button class="btn btn-danger w-100" id="deleteAllDataBtn">
                                                <i class="fas fa-trash-alt me-1"></i> Hapus Semua Data
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="card mb-4">
                                    <div class="card-header">
                                        <i class="fas fa-info-circle me-2"></i> Informasi Aplikasi
                                    </div>
                                    <div class="card-body">
                                        <div class="mb-3">
                                            <label class="form-label">Nama Aplikasi</label>
                                            <p>BARJAS - Sistem Bantuan Terpadu</p>
                                        </div>
                                        
                                        <div class="mb-3">
                                            <label class="form-label">Versi</label>
                                            <p>v2.1.0</p>
                                        </div>
                                        
                                        <div class="mb-3">
                                            <label class="form-label">Pengembang</label>
                                            <p>Lentera Karya Situbondo</p>
                                        </div>
                                        
                                        <div class="mb-3">
                                            <label class="form-label">Kontak</label>
                                            <p><i class="fab fa-whatsapp me-2"></i> <a href="https://wa.me/6285647709114" target="_blank" class="whatsapp-link">+62 856-4770-9114</a></p>
                                            <p><i class="fas fa-envelope me-2"></i> <a href="mailto:admin@anekamarket.my.id">admin@anekamarket.my.id</a></p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="copyright">
                &copy; 2025 BARJAS - Sistem Bantuan Terpadu. Dikembangkan oleh <strong>Lentera Karya Situbondo</strong>
            </div>
        </div>
        
        <!-- Floating Action Button -->
        <div class="floating-action-btn" id="scrollToTopBtn">
            <i class="fas fa-arrow-up"></i>
        </div>
        
        <!-- Notification Toast -->
        <div class="toast notification-toast" role="alert" aria-live="assertive" aria-atomic="true" id="notificationToast">
            <div class="toast-header">
                <strong class="me-auto" id="toastTitle">Notification</strong>
                <small id="toastTime">Just now</small>
                <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
            <div class="toast-body" id="toastMessage">
                Operation completed successfully.
            </div>
        </div>
    </div>
    
    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <script>
        // Inisialisasi variabel global
        window.jsPDF = window.jspdf.jsPDF;
        const appDataKey = 'barjas_data';
        const securityCode = "BARJAS2025"; // Kode keamanan default
        let loginAttempts = 0;
        let isBlocked = false;
        let blockTime = 0;
        let dataBantuan = [];
        let currentPage = 1;
        const itemsPerPage = 10;
        
        // Daftar desa/kelurahan
        const daftarDesa = [
            "Agel", "Alas Bayur", "Alasmalang", "Alastengah", "Arjasa", "Ardirejo", "Asembagus", 
            "Awar-awar", "Awang-awang", "Baderan", "Balung", "Bantal", "Battal", "Bayeman", "Besuki", "Bletok", "Blimbing", "Bloro", "Buduan", "Bugeman", "Bungatan", 
            "Campoan", "Cemara", "Curah Cottok", "Curah Jeru", "Curah Kalak", "Curah Suri", "Curah Tatal", "Dawuhan", "Demung", "Duwet", "Gadingan", "Gebangan", 
            "Gelung", "Gudang", "Gunung Malang", "Gunung Putri", "Jangkar", "Jatisari", "Jatibanteng", "Jetis", "Juglangan", "Kalianget", "Kalibagor", "Kalimas", 
            "Kalirejo", "Kalisari", "Kandang", "Kayu Putih", "Kayumas", "Kedungdowo", "Kedunglo", "Kembangsari", "Ketah", "Ketowan", "Kilensari", "Klampokan", 
            "Klatakan", "Kotakan", "Kumbangsari", "Kukusan", "Lamongan", "Landangan", "Langkap", "Lebeng", "Lubawang", "Mangaran", "Mimbaan", "Mlandingan Kulon", 
            "Mlandingan Wetan", "Mojodungkol", "Mojosari", "Olean", "Palangan", "Panarukan", "Panji Kidul", "Panji Lor", "Parante", "Pasir Putih", "Patemon", 
            "Patokan", "Paowan", "Peleyan", "Pesisir", "Pesanggrahan", "Pategalan", "Patemon", "Plalangan", "Pokaan", "Rajekwesi", "Seletreng", "Selobanteng", 
            "Selomukti", "Selowogo", "Semambung", "Semiring", "Sliwung", "Sopet", "Sumber Pinang", "Sumberanyar", "Sumberargo", "Sumberkolak", "Sumberejo", 
            "Sumbertengah", "Sumberwaru", "Tamankursi", "Tamansari", "Taman", "Talkandang", "Tanjung Glugur", "Tanjung Kamal", "Tanjung Pecinan", "Tambak Ukir", 
            "Telempong", "Tenggir", "Tepos", "Tokelan", "Tlogosari", "Trigonco", "Trebungan", "Widoropayung", "Wonokoyo", "Wonorejo", "Wringinanom"
        ];
        
        // Fungsi untuk inisialisasi aplikasi
        function initApp() {
            // Load data dari localStorage
            loadData();
            
            // Setup event listeners
            setupEventListeners();
            
            // Setup UI components
            setupUIComponents();
            
            // Tampilkan dashboard sebagai default
            showSection('dashboard');
            
            // Update dashboard stats
            updateDashboardStats();
            
            // Tampilkan data terbaru di dashboard
            displayRecentData();
            
            // Tampilkan data di tabel
            displayDataTable();
        }
        
        // Fungsi untuk setup event listeners
        function setupEventListeners() {
            // Navigation menu
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const target = this.getAttribute('data-bs-target');
                    showSection(target);
                });
            });
            
            // Form submission
            document.getElementById('bantuanForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveData();
            });
            
            // Filter events
            document.getElementById('filterTahun').addEventListener('change', filterDataTable);
            document.getElementById('filterJenis').addEventListener('change', filterDataTable);
            document.getElementById('filterDesa').addEventListener('change', filterDataTable);
            document.getElementById('searchInput').addEventListener('input', filterDataTable);
            
            // Export buttons
            document.getElementById('exportExcelBtn').addEventListener('click', exportToExcel);
            document.getElementById('exportPDFBtn').addEventListener('click', exportToPDF);
            document.getElementById('printBtn').addEventListener('click', printData);
            
            // Delete buttons
            document.getElementById('deleteAllBtn').addEventListener('click', confirmDeleteAll);
            document.getElementById('deleteAllDataBtn').addEventListener('click', confirmDeleteAll);
            
            // Backup and restore
            document.getElementById('backupBtn').addEventListener('click', backupData);
            document.getElementById('restoreBtn').addEventListener('click', restoreData);
            
            // Scroll to top button
            document.getElementById('scrollToTopBtn').addEventListener('click', scrollToTop);
            
            // Mobile menu button
            document.getElementById('mobileMenuBtn').addEventListener('click', toggleMobileMenu);
            document.getElementById('sidebarOverlay').addEventListener('click', toggleMobileMenu);
            
            // Logout button
            document.getElementById('logoutButton').addEventListener('click', logout);
            
            // Generate stat button
            document.getElementById('generateStatBtn').addEventListener('click', generateStatistics);
            
            // Validasi NIK (hanya angka)
            document.getElementById('nik').addEventListener('input', function(e) {
                this.value = this.value.replace(/\D/g, '');
                if (this.value.length > 16) {
                    this.value = this.value.slice(0, 16);
                }
            });
            
            // Pencarian untuk dropdown desa
            document.getElementById('desaSearch').addEventListener('input', filterDesaOptions);
        }
        
        // Fungsi untuk setup UI components
        function setupUIComponents() {
            // Isi dropdown tahun (2020-2090)
            const tahunSekarang = new Date().getFullYear();
            const tahunDropdowns = [
                document.getElementById('tahunAnggaran'),
                document.getElementById('filterTahun'),
                document.getElementById('statTahun')
            ];
            
            tahunDropdowns.forEach(dropdown => {
                if (dropdown) {
                    dropdown.innerHTML = '<option value="">Pilih Tahun</option>';
                    for (let tahun = 2020; tahun <= 2090; tahun++) {
                        const option = document.createElement('option');
                        option.value = tahun;
                        option.textContent = tahun;
                        if (tahun === tahunSekarang) {
                            option.selected = true;
                        }
                        dropdown.appendChild(option);
                    }
                }
            });
            
            // Isi dropdown desa
            const desaDropdowns = [
                document.getElementById('desa'),
                document.getElementById('filterDesa')
            ];
            
            desaDropdowns.forEach(dropdown => {
                if (dropdown) {
                    dropdown.innerHTML = '<option value="">Pilih Desa/Kelurahan</option>';
                    daftarDesa.sort().forEach(desa => {
                        const option = document.createElement('option');
                        option.value = desa;
                        option.textContent = desa;
                        dropdown.appendChild(option);
                    });
                }
            });
            
            // Set tanggal hari ini untuk input tanggal
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('tanggal').value = today;
        }
        
        // Fungsi untuk memfilter opsi desa berdasarkan pencarian
        function filterDesaOptions() {
            const searchText = document.getElementById('desaSearch').value.toLowerCase();
            const desaDropdown = document.getElementById('desa');
            const options = desaDropdown.getElementsByTagName('option');
            
            for (let i = 1; i < options.length; i++) { // Mulai dari 1 untuk melewatkan opsi default
                const desa = options[i].value.toLowerCase();
                if (desa.includes(searchText)) {
                    options[i].style.display = '';
                } else {
                    options[i].style.display = 'none';
                }
            }
        }
        
        // Fungsi untuk menampilkan section yang dipilih
        function showSection(sectionId) {
            // Sembunyikan semua section
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.add('d-none');
            });
            
            // Tampilkan section yang dipilih
            document.getElementById(sectionId).classList.remove('d-none');
            
            // Update menu aktif
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('data-bs-target') === sectionId) {
                    link.classList.add('active');
                }
            });
            
            // Jika section adalah dataTable, refresh tabel
            if (sectionId === 'dataTable') {
                displayDataTable();
            }
            
            // Jika section adalah statistik, generate statistik
            if (sectionId === 'statistik') {
                generateStatistics();
            }
        }
        
        // Fungsi untuk menyimpan data
        function saveData() {
            // Validasi form
            if (!validateForm()) {
                showNotification('Error', 'Harap periksa form input', 'danger');
                return;
            }
            
            // Ambil nilai dari form
            const newData = {
                id: Date.now(), // ID unik berdasarkan timestamp
                nama: document.getElementById('nama').value,
                nik: document.getElementById('nik').value,
                namaKelompok: document.getElementById('namaKelompok').value,
                jabatan: document.getElementById('jabatan').value,
                tahunAnggaran: document.getElementById('tahunAnggaran').value,
                jenisBantuan: document.getElementById('jenisBantuan').value,
                desa: document.getElementById('desa').value,
                jumlah: parseInt(document.getElementById('jumlah').value),
                tanggal: document.getElementById('tanggal').value,
                driveLink: document.getElementById('driveLink').value,
                keterangan: document.getElementById('keterangan').value,
                createdAt: new Date().toISOString()
            };
            
            // Tambahkan ke array dataBantuan
            dataBantuan.push(newData);
            
            // Simpan ke localStorage
            saveToLocalStorage();
            
            // Reset form
            document.getElementById('bantuanForm').reset();
            
            // Set tanggal ke hari ini
            document.getElementById('tanggal').value = new Date().toISOString().split('T')[0];
            
            // Update UI
            updateDashboardStats();
            displayRecentData();
            
            // Tampilkan notifikasi
            showNotification('Sukses', 'Data berhasil disimpan', 'success');
        }
        
        // Fungsi untuk validasi form
        function validateForm() {
            let isValid = true;
            
            // Validasi NIK (harus 16 digit angka)
            const nik = document.getElementById('nik').value;
            if (nik.length !== 16 || !/^\d+$/.test(nik)) {
                document.getElementById('nik').classList.add('input-error');
                document.getElementById('nikError').style.display = 'block';
                isValid = false;
            } else {
                document.getElementById('nik').classList.remove('input-error');
                document.getElementById('nikError').style.display = 'none';
            }
            
            // Validasi field wajib lainnya
            const requiredFields = ['nama', 'tahunAnggaran', 'jenisBantuan', 'desa', 'jumlah', 'tanggal'];
            requiredFields.forEach(field => {
                const element = document.getElementById(field);
                if (!element.value.trim()) {
                    element.classList.add('input-error');
                    isValid = false;
                } else {
                    element.classList.remove('input-error');
                }
            });
            
            return isValid;
        }
        
        // Fungsi untuk menampilkan data di tabel
        function displayDataTable(page = 1) {
            const tableBody = document.getElementById('dataTableBody');
            tableBody.innerHTML = '';
            
            if (dataBantuan.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="12" class="text-center">Tidak ada data</td></tr>';
                document.getElementById('totalRecords').textContent = '0 Data';
                return;
            }
            
            // Filter data berdasarkan kriteria
            let filteredData = filterData(dataBantuan);
            
            // Hitung total halaman
            const totalPages = Math.ceil(filteredData.length / itemsPerPage);
            
            // Pastikan halaman saat ini valid
            currentPage = Math.max(1, Math.min(page, totalPages));
            
            // Potong data untuk halaman saat ini
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = Math.min(startIndex + itemsPerPage, filteredData.length);
            const currentData = filteredData.slice(startIndex, endIndex);
            
            // Isi tabel dengan data
            currentData.forEach((data, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${startIndex + index + 1}</td>
                    <td>${data.nama}</td>
                    <td>${data.nik}</td>
                    <td>${data.namaKelompok || '-'}</td>
                    <td>${data.jabatan || '-'}</td>
                    <td>${data.tahunAnggaran}</td>
                    <td>${data.jenisBantuan}</td>
                    <td>${data.desa}</td>
                    <td>${data.jumlah.toLocaleString()}</td>
                    <td>${formatDate(data.tanggal)}</td>
                    <td>
                        ${data.driveLink ? 
                            `<a href="${data.driveLink}" target="_blank" class="drive-link">Lihat Dokumen</a>` : 
                            '-'}
                    </td>
                    <td>
                        <button class="btn btn-sm btn-danger delete-btn" data-id="${data.id}">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
            
            // Update info total data
            document.getElementById('totalRecords').textContent = `${filteredData.length} Data`;
            
            // Setup pagination
            setupPagination(filteredData.length);
            
            // Setup event listeners untuk tombol delete
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    deleteData(id);
                });
            });
        }
        
        // Fungsi untuk filter data berdasarkan kriteria
        function filterData(data) {
            const tahun = document.getElementById('filterTahun').value;
            const jenis = document.getElementById('filterJenis').value;
            const desa = document.getElementById('filterDesa').value;
            const searchText = document.getElementById('searchInput').value.toLowerCase();
            
            return data.filter(item => {
                // Filter tahun
                if (tahun && item.tahunAnggaran !== tahun) return false;
                
                // Filter jenis
                if (jenis && item.jenisBantuan !== jenis) return false;
                
                // Filter desa
                if (desa && item.desa !== desa) return false;
                
                // Filter pencarian
                if (searchText) {
                    const searchableFields = [
                        item.nama, 
                        item.nik, 
                        item.namaKelompok, 
                        item.jenisBantuan, 
                        item.desa,
                        item.jabatan
                    ].map(field => field ? field.toLowerCase() : '');
                    
                    if (!searchableFields.some(field => field.includes(searchText))) {
                        return false;
                    }
                }
                
                return true;
            });
        }
        
        // Fungsi untuk setup pagination
        function setupPagination(totalItems) {
            const totalPages = Math.ceil(totalItems / itemsPerPage);
            const paginationElement = document.getElementById('pagination');
            
            if (totalPages <= 1) {
                paginationElement.innerHTML = '';
                return;
            }
            
            let paginationHTML = '';
            
            // Tombol Previous
            if (currentPage > 1) {
                paginationHTML += `<li class="page-item">
                    <a class="page-link" href="#" data-page="${currentPage - 1}">Previous</a>
                </li>`;
            } else {
                paginationHTML += `<li class="page-item disabled">
                    <a class="page-link" href="#">Previous</a>
                </li>`;
            }
            
            // Tampilkan halaman
            const startPage = Math.max(1, currentPage - 2);
            const endPage = Math.min(totalPages, startPage + 4);
            
            for (let i = startPage; i <= endPage; i++) {
                if (i === currentPage) {
                    paginationHTML += `<li class="page-item active">
                        <a class="page-link" href="#">${i}</a>
                    </li>`;
                } else {
                    paginationHTML += `<li class="page-item">
                        <a class="page-link" href="#" data-page="${i}">${i}</a>
                    </li>`;
                }
            }
            
            // Tombol Next
            if (currentPage < totalPages) {
                paginationHTML += `<li class="page-item">
                    <a class="page-link" href="#" data-page="${currentPage + 1}">Next</a>
                </li>`;
            } else {
                paginationHTML += `<li class="page-item disabled">
                    <a class="page-link" href="#">Next</a>
                </li>`;
            }
            
            paginationElement.innerHTML = paginationHTML;
            
            // Event listeners untuk pagination
            paginationElement.querySelectorAll('.page-link').forEach(link => {
                const page = link.getAttribute('data-page');
                if (page) {
                    link.addEventListener('click', function(e) {
                        e.preventDefault();
                        displayDataTable(parseInt(page));
                    });
                }
            });
        }
        
        // Fungsi untuk menampilkan data terbaru di dashboard
        function displayRecentData() {
            const tableBody = document.getElementById('recentDataTable');
            tableBody.innerHTML = '';
            
            if (dataBantuan.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="7" class="text-center">Tidak ada data</td></tr>';
                return;
            }
            
            // Ambil 5 data terbaru
            const recentData = [...dataBantuan]
                .sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt))
                .slice(0, 5);
            
            recentData.forEach((data, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${data.nama}</td>
                    <td>${data.desa}</td>
                    <td>${data.jenisBantuan}</td>
                    <td>${formatDate(data.tanggal)}</td>
                    <td>${data.jumlah.toLocaleString()}</td>
                    <td>
                        <button class="btn btn-sm btn-primary view-btn" data-id="${data.id}">
                            <i class="fas fa-eye"></i>
                        </button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
            
            // Setup event listeners untuk tombol view
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    // Tampilkan section dataTable dan filter berdasarkan ID
                    showSection('dataTable');
                    // TODO: Implementasi filter berdasarkan ID
                });
            });
        }
        
        // Fungsi untuk update dashboard stats
        function updateDashboardStats() {
            document.getElementById('totalPenerima').textContent = dataBantuan.length.toLocaleString();
            
            const totalBantuan = dataBantuan.reduce((sum, item) => sum + item.jumlah, 0);
            document.getElementById('totalBantuan').textContent = totalBantuan.toLocaleString();
            
            const uniqueDesa = new Set(dataBantuan.map(item => item.desa));
            document.getElementById('totalDesa').textContent = uniqueDesa.size.toLocaleString();
            
            // Tahun anggaran aktif (tahun dengan data terbanyak)
            const tahunCount = {};
            dataBantuan.forEach(item => {
                tahunCount[item.tahunAnggaran] = (tahunCount[item.tahunAnggaran] || 0) + 1;
            });
            
            let tahunAktif = '2025';
            let maxCount = 0;
            for (const tahun in tahunCount) {
                if (tahunCount[tahun] > maxCount) {
                    maxCount = tahunCount[tahun];
                    tahunAktif = tahun;
                }
            }
            document.getElementById('tahunAktif').textContent = tahunAktif;
            
            // Update chart
            updateCharts();
        }
        
        // Fungsi untuk update charts
        function updateCharts() {
            // Data untuk chart desa
            const desaCount = {};
            dataBantuan.forEach(item => {
                desaCount[item.desa] = (desaCount[item.desa] || 0) + 1;
            });
            
            const sortedDesa = Object.entries(desaCount)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 5);
            
            const desaLabels = sortedDesa.map(item => item[0]);
            const desaData = sortedDesa.map(item => item[1]);
            
            // Data untuk chart jenis bantuan
            const jenisCount = {};
            dataBantuan.forEach(item => {
                jenisCount[item.jenisBantuan] = (jenisCount[item.jenisBantuan] || 0) + 1;
            });
            
            const jenisLabels = Object.keys(jenisCount);
            const jenisData = Object.values(jenisCount);
            
            // Render charts
            renderChart('desaChart', 'bar', desaLabels, desaData, 'Jumlah Penerima per Desa', '#0d47a1');
            renderChart('jenisChart', 'pie', jenisLabels, jenisData, 'Distribusi Jenis Bantuan');
        }
        
        // Fungsi untuk render chart
        function renderChart(canvasId, type, labels, data, title, color = null) {
            const ctx = document.getElementById(canvasId).getContext('2d');
            
            // Hapus chart sebelumnya jika ada
            if (window[canvasId + 'Chart']) {
                window[canvasId + 'Chart'].destroy();
            }
            
            const backgroundColors = color ? 
                Array(data.length).fill(color) : 
                [
                    '#0d47a1', '#00695c', '#ff8f00', '#5e35b1', '#c62828',
                    '#2e7d32', '#6a1b9a', '#e65100', '#0277bd', '#283593'
                ];
            
            window[canvasId + 'Chart'] = new Chart(ctx, {
                type: type,
                data: {
                    labels: labels,
                    datasets: [{
                        label: title,
                        data: data,
                        backgroundColor: backgroundColors,
                        borderColor: type === 'bar' ? backgroundColors.map(c => c.replace('0.8', '1')) : undefined,
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: type === 'pie' ? 'right' : 'top',
                        },
                        title: {
                            display: true,
                            text: title
                        }
                    }
                }
            });
        }
        
        // Fungsi untuk generate statistics
        function generateStatistics() {
            // Filter data berdasarkan tahun dan jenis yang dipilih
            const tahun = document.getElementById('statTahun').value;
            const jenis = document.getElementById('statJenis').value;
            
            let filteredData = dataBantuan;
            
            if (tahun) {
                filteredData = filteredData.filter(item => item.tahunAnggaran === tahun);
            }
            
            if (jenis) {
                filteredData = filteredData.filter(item => item.jenisBantuan === jenis);
            }
            
            if (filteredData.length === 0) {
                showNotification('Info', 'Tidak ada data untuk kriteria yang dipilih', 'info');
                return;
            }
            
            // Data untuk chart bulanan
            const monthlyData = Array(12).fill(0);
            filteredData.forEach(item => {
                const month = new Date(item.tanggal).getMonth();
                monthlyData[month] += item.jumlah;
            });
            
            const monthLabels = ['Jan', 'Feb', 'Mar', 'Apr', 'Mei', 'Jun', 'Jul', 'Agu', 'Sep', 'Okt', 'Nov', 'Des'];
            
            // Data untuk distribusi jenis bantuan
            const jenisCount = {};
            filteredData.forEach(item => {
                jenisCount[item.jenisBantuan] = (jenisCount[item.jenisBantuan] || 0) + 1;
            });
            
            const jenisLabels = Object.keys(jenisCount);
            const jenisData = Object.values(jenisCount);
            
            // Data untuk distribusi desa
            const desaCount = {};
            filteredData.forEach(item => {
                desaCount[item.desa] = (desaCount[item.desa] || 0) + 1;
            });
            
            const sortedDesa = Object.entries(desaCount)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 8);
            
            const desaLabels = sortedDesa.map(item => item[0]);
            const desaData = sortedDesa.map(item => item[1]);
            
            // Render charts
            renderChart('monthlyChart', 'bar', monthLabels, monthlyData, 'Bantuan per Bulan', '#00695c');
            renderChart('distributionChart', 'pie', jenisLabels, jenisData, 'Distribusi Jenis Bantuan');
            renderChart('desaDistributionChart', 'doughnut', desaLabels, desaData, 'Distribusi per Desa');
        }
        
        // Fungsi untuk menghapus data
        function deleteData(id) {
            if (confirm('Apakah Anda yakin ingin menghapus data ini?')) {
                dataBantuan = dataBantuan.filter(item => item.id !== id);
                saveToLocalStorage();
                displayDataTable(currentPage);
                updateDashboardStats();
                displayRecentData();
                showNotification('Sukses', 'Data berhasil dihapus', 'success');
            }
        }
        
        // Fungsi untuk konfirmasi hapus semua data
        function confirmDeleteAll() {
            if (confirm('Apakah Anda yakin ingin menghapus SEMUA data? Tindakan ini tidak dapat dibatalkan!')) {
                dataBantuan = [];
                saveToLocalStorage();
                displayDataTable();
                updateDashboardStats();
                displayRecentData();
                showNotification('Sukses', 'Semua data berhasil dihapus', 'success');
            }
        }
        
        // Fungsi untuk export ke Excel
        function exportToExcel() {
            if (dataBantuan.length === 0) {
                showNotification('Info', 'Tidak ada data untuk diexport', 'info');
                return;
            }
            
            // Filter data berdasarkan kriteria
            let filteredData = filterData(dataBantuan);
            
            if (filteredData.length === 0) {
                showNotification('Info', 'Tidak ada data untuk kriteria yang dipilih', 'info');
                return;
            }
            
            // Siapkan data untuk Excel
            const excelData = filteredData.map(item => ({
                'Nama Penerima': item.nama,
                'NIK': item.nik,
                'Nama Kelompok': item.namaKelompok || '',
                'Jabatan': item.jabatan || '',
                'Tahun Anggaran': item.tahunAnggaran,
                'Jenis Bantuan': item.jenisBantuan,
                'Desa/Kelurahan': item.desa,
                'Jumlah': item.jumlah,
                'Tanggal Penyerahan': formatDate(item.tanggal),
                'Link Drive': item.driveLink || '',
                'Keterangan': item.keterangan || ''
            }));
            
            // Buat worksheet
            const worksheet = XLSX.utils.json_to_sheet(excelData);
            
            // Buat workbook
            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, 'Data Bantuan');
            
            // Export ke file
            const fileName = `Data_Bantuan_${new Date().toISOString().split('T')[0]}.xlsx`;
            XLSX.writeFile(workbook, fileName);
            
            showNotification('Sukses', `Data berhasil diexport ke ${fileName}`, 'success');
        }
        
        // Fungsi untuk export ke PDF
        function exportToPDF() {
            if (dataBantuan.length === 0) {
                showNotification('Info', 'Tidak ada data untuk diexport', 'info');
                return;
            }
            
            // Filter data berdasarkan kriteria
            let filteredData = filterData(dataBantuan);
            
            if (filteredData.length === 0) {
                showNotification('Info', 'Tidak ada data untuk kriteria yang dipilih', 'info');
                return;
            }
            
            // Buat PDF
            const doc = new jsPDF();
            
            // Judul
            doc.setFontSize(18);
            doc.text('LAPORAN DATA BANTUAN', 105, 15, { align: 'center' });
            
            // Info filter
            doc.setFontSize(10);
            const tahun = document.getElementById('filterTahun').value;
            const jenis = document.getElementById('filterJenis').value;
            const desa = document.getElementById('filterDesa').value;
            
            let filterInfo = 'Semua Data';
            if (tahun || jenis || desa) {
                filterInfo = 'Filter: ';
                if (tahun) filterInfo += `Tahun: ${tahun} `;
                if (jenis) filterInfo += `Jenis: ${jenis} `;
                if (desa) filterInfo += `Desa: ${desa}`;
            }
            
            doc.text(filterInfo, 105, 22, { align: 'center' });
            
            // Tanggal export
            doc.text(`Tanggal Export: ${new Date().toLocaleDateString('id-ID')}`, 105, 29, { align: 'center' });
            
            // Siapkan data untuk tabel
            const tableData = filteredData.map(item => [
                item.nama,
                item.nik,
                item.namaKelompok || '-',
                item.jabatan || '-',
                item.tahunAnggaran,
                item.jenisBantuan,
                item.desa,
                item.jumlah.toLocaleString(),
                formatDate(item.tanggal)
            ]);
            
            // Buat tabel
            doc.autoTable({
                startY: 35,
                head: [['Nama', 'NIK', 'Kelompok', 'Jabatan', 'Tahun', 'Jenis', 'Desa', 'Jumlah', 'Tanggal']],
                body: tableData,
                theme: 'grid',
                headStyles: {
                    fillColor: [13, 71, 161],
                    textColor: 255
                },
                alternateRowStyles: {
                    fillColor: [240, 240, 240]
                },
                margin: { top: 35 }
            });
            
            // Total data
            doc.setFontSize(10);
            doc.text(`Total Data: ${filteredData.length}`, 14, doc.lastAutoTable.finalY + 10);
            
            // Simpan PDF
            const fileName = `Data_Bantuan_${new Date().toISOString().split('T')[0]}.pdf`;
            doc.save(fileName);
            
            showNotification('Sukses', `Data berhasil diexport ke ${fileName}`, 'success');
        }
        
        // Fungsi untuk print data
        function printData() {
            if (dataBantuan.length === 0) {
                showNotification('Info', 'Tidak ada data untuk dicetak', 'info');
                return;
            }
            
            // Filter data berdasarkan kriteria
            let filteredData = filterData(dataBantuan);
            
            if (filteredData.length === 0) {
                showNotification('Info', 'Tidak ada data untuk kriteria yang dipilih', 'info');
                return;
            }
            
            // Buat elemen untuk print
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Cetak Data Bantuan</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        .print-header { text-align: center; margin-bottom: 20px; }
                        .print-title { font-size: 18px; font-weight: bold; }
                        .print-subtitle { font-size: 14px; }
                        .print-date { text-align: right; margin-bottom: 10px; }
                        table { width: 100%; border-collapse: collapse; font-size: 12px; }
                        th, td { border: 1px solid #ddd; padding: 6px; text-align: left; }
                        th { background-color: #0d47a1; color: white; }
                        tr:nth-child(even) { background-color: #f2f2f2; }
                        .print-footer { margin-top: 20px; font-size: 12px; }
                        @media print {
                            @page { size: landscape; margin: 0.5cm; }
                            body { margin: 0; }
                        }
                    </style>
                </head>
                <body>
                    <div class="print-header">
                        <div class="print-title">LAPORAN DATA BANTUAN</div>
                        <div class="print-subtitle">Dinas Peternakan dan Perikanan Kabupaten Situbondo</div>
                    </div>
                    <div class="print-date">Tanggal Cetak: ${new Date().toLocaleDateString('id-ID')}</div>
                    <table>
                        <thead>
                            <tr>
                                <th>No</th>
                                <th>Nama</th>
                                <th>NIK</th>
                                <th>Kelompok</th>
                                <th>Jabatan</th>
                                <th>Tahun</th>
                                <th>Jenis</th>
                                <th>Desa</th>
                                <th>Jumlah</th>
                                <th>Tanggal</th>
                            </tr>
                        </thead>
                        <tbody>
            `);
            
            // Isi data
            filteredData.forEach((item, index) => {
                printWindow.document.write(`
                    <tr>
                        <td>${index + 1}</td>
                        <td>${item.nama}</td>
                        <td>${item.nik}</td>
                        <td>${item.namaKelompok || '-'}</td>
                        <td>${item.jabatan || '-'}</td>
                        <td>${item.tahunAnggaran}</td>
                        <td>${item.jenisBantuan}</td>
                        <td>${item.desa}</td>
                        <td>${item.jumlah.toLocaleString()}</td>
                        <td>${formatDate(item.tanggal)}</td>
                    </tr>
                `);
            });
            
            printWindow.document.write(`
                        </tbody>
                    </table>
                    <div class="print-footer">
                        Total Data: ${filteredData.length}
                    </div>
                </body>
                </html>
            `);
            
            printWindow.document.close();
            printWindow.focus();
            
            // Tunggu sebentar sebelum mencetak
            setTimeout(() => {
                printWindow.print();
                // printWindow.close(); // Opsional: tutup window setelah mencetak
            }, 500);
        }
        
        // Fungsi untuk backup data
        function backupData() {
            if (dataBantuan.length === 0) {
                showNotification('Info', 'Tidak ada data untuk dibackup', 'info');
                return;
            }
            
            const dataStr = JSON.stringify(dataBantuan);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = `backup_data_bantuan_${new Date().toISOString().split('T')[0]}.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
            
            showNotification('Sukses', 'Backup data berhasil', 'success');
        }
        
        // Fungsi untuk restore data
        function restoreData() {
            const fileInput = document.getElementById('restoreFile');
            const file = fileInput.files[0];
            
            if (!file) {
                showNotification('Error', 'Pilih file backup terlebih dahulu', 'danger');
                return;
            }
            
            if (!confirm('Restore data akan mengganti semua data yang ada. Lanjutkan?')) {
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const restoredData = JSON.parse(e.target.result);
                    
                    // Validasi data
                    if (!Array.isArray(restoredData)) {
                        throw new Error('Format data tidak valid');
                    }
                    
                    // Cek struktur data
                    if (restoredData.length > 0) {
                        const firstItem = restoredData[0];
                        if (!firstItem.nama || !firstItem.nik || !firstItem.jenisBantuan || !firstItem.desa || !firstItem.jumlah || !firstItem.tanggal) {
                            throw new Error('Struktur data tidak valid');
                        }
                    }
                    
                    dataBantuan = restoredData;
                    saveToLocalStorage();
                    
                    // Update UI
                    displayDataTable();
                    updateDashboardStats();
                    displayRecentData();
                    
                    showNotification('Sukses', 'Restore data berhasil', 'success');
                    fileInput.value = '';
                } catch (error) {
                    showNotification('Error', 'Gagal memproses file: ' + error.message, 'danger');
                }
            };
            reader.readAsText(file);
        }
        
        // Fungsi untuk scroll ke atas
        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }
        
        // Fungsi untuk toggle mobile menu
        function toggleMobileMenu() {
            document.getElementById('sidebar').classList.toggle('mobile-show');
            document.getElementById('sidebarOverlay').classList.toggle('mobile-show');
        }
        
        // Fungsi untuk logout
        function logout() {
            if (confirm('Apakah Anda yakin ingin keluar dari aplikasi?')) {
                // Reset state login
                localStorage.removeItem('barjas_authenticated');
                loginAttempts = 0;
                isBlocked = false;
                
                // Sembunyikan konten aplikasi
                document.getElementById('appContent').classList.add('app-content-unauthenticated');
                
                // Tampilkan login modal
                const loginModal = new bootstrap.Modal(document.getElementById('loginModal'));
                loginModal.show();
            }
        }
        
        // Fungsi untuk memformat tanggal
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('id-ID', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric'
            });
        }
        
        // Fungsi untuk menampilkan notifikasi
        function showNotification(title, message, type = 'info') {
            const toast = document.getElementById('notificationToast');
            const toastTitle = document.getElementById('toastTitle');
            const toastMessage = document.getElementById('toastMessage');
            const toastTime = document.getElementById('toastTime');
            
            // Set warna berdasarkan type
            switch (type) {
                case 'success':
                    toast.style.borderLeft = '4px solid #28a745';
                    break;
                case 'danger':
                    toast.style.borderLeft = '4px solid #dc3545';
                    break;
                case 'warning':
                    toast.style.borderLeft = '4px solid #ffc107';
                    break;
                default:
                    toast.style.borderLeft = '4px solid #17a2b8';
            }
            
            // Set konten
            toastTitle.textContent = title;
            toastMessage.textContent = message;
            toastTime.textContent = new Date().toLocaleTimeString('id-ID');
            
            // Tampilkan toast
            const bsToast = new bootstrap.Toast(toast);
            bsToast.show();
        }
        
        // Fungsi untuk load data dari localStorage
        function loadData() {
            const savedData = localStorage.getItem(appDataKey);
            if (savedData) {
                try {
                    dataBantuan = JSON.parse(savedData);
                } catch (e) {
                    console.error('Error parsing saved data:', e);
                    dataBantuan = [];
                }
            }
        }
        
        // Fungsi untuk save data ke localStorage
        function saveToLocalStorage() {
            localStorage.setItem(appDataKey, JSON.stringify(dataBantuan));
        }
        
        // Fungsi untuk filter data table
        function filterDataTable() {
            displayDataTable(1);
        }
        
        // ===== FUNGSI LOGIN & AUTHENTICATION =====
        
        // Fungsi untuk inisialisasi login
        function initLogin() {
            // Cek apakah sudah login
            const isAuthenticated = localStorage.getItem('barjas_authenticated') === 'true';
            
            if (isAuthenticated) {
                // Langsung tampilkan aplikasi
                document.getElementById('appContent').classList.remove('app-content-unauthenticated');
                initApp();
            } else {
                // Tampilkan modal login
                const loginModal = new bootstrap.Modal(document.getElementById('loginModal'), {
                    backdrop: 'static',
                    keyboard: false
                });
                loginModal.show();
                
                // Setup event listeners untuk login
                document.getElementById('loginForm').addEventListener('submit', function(e) {
                    e.preventDefault();
                    attemptLogin();
                });
                
                // Toggle show/hide password
                document.querySelector('.toggle-password').addEventListener('click', function() {
                    const passwordInput = document.getElementById('securityCode');
                    const icon = this.querySelector('i');
                    
                    if (passwordInput.type === 'password') {
                        passwordInput.type = 'text';
                        icon.classList.remove('fa-eye');
                        icon.classList.add('fa-eye-slash');
                    } else {
                        passwordInput.type = 'password';
                        icon.classList.remove('fa-eye-slash');
                        icon.classList.add('fa-eye');
                    }
                });
            }
        }
        
        // Fungsi untuk attempt login
        function attemptLogin() {
            if (isBlocked) {
                showLoginNotification('Anda telah diblokir sementara. Silakan coba lagi nanti.', 'danger');
                return;
            }
            
            const enteredCode = document.getElementById('securityCode').value;
            const loginButton = document.getElementById('loginButton');
            const loginSpinner = document.getElementById('loginSpinner');
            const loginButtonText = document.querySelector('.login-button-text');
            
            // Tampilkan loading state
            loginButton.disabled = true;
            loginSpinner.classList.remove('d-none');
            loginButtonText.textContent = 'Memproses...';
            
            // Simulasi proses login (dalam aplikasi nyata, ini akan request ke server)
            setTimeout(() => {
                if (enteredCode === securityCode) {
                    // Login berhasil
                    loginAttempts = 0;
                    localStorage.setItem('barjas_authenticated', 'true');
                    
                    // Sembunyikan modal login
                    const loginModal = bootstrap.Modal.getInstance(document.getElementById('loginModal'));
                    loginModal.hide();
                    
                    // Tampilkan aplikasi
                    document.getElementById('appContent').classList.remove('app-content-unauthenticated');
                    initApp();
                    
                    // Tampilkan welcome splash
                    showWelcomeSplash();
                } else {
                    // Login gagal
                    loginAttempts++;
                    
                    // Update UI
                    loginButton.disabled = false;
                    loginSpinner.classList.add('d-none');
                    loginButtonText.textContent = 'Masuk ke Aplikasi';
                    
                    // Tampilkan pesan error
                    const attemptsLeft = 5 - loginAttempts;
                    
                    if (attemptsLeft > 0) {
                        showLoginNotification(`Kode salah. Percobaan ${loginAttempts} dari 5. ${attemptsLeft} percobaan tersisa.`, 'danger');
                        document.getElementById('attemptsCount').textContent = `Percobaan ${loginAttempts} dari 5`;
                    } else {
                        // Blokir akses sementara
                        isBlocked = true;
                        blockTime = 30; // 30 detik
                        
                        document.getElementById('blockedMessage').classList.remove('d-none');
                        document.getElementById('attemptsCount').classList.add('d-none');
                        startBlockCountdown();
                        
                        showLoginNotification('Terlalu banyak percobaan gagal. Akses diblokir sementara.', 'danger');
                    }
                    
                    // Animasi shake untuk form
                    document.getElementById('loginForm').classList.add('login-shake');
                    setTimeout(() => {
                        document.getElementById('loginForm').classList.remove('login-shake');
                    }, 600);
                }
            }, 1000);
        }
        
        // Fungsi untuk menampilkan notifikasi di login form
        function showLoginNotification(message, type) {
            const notification = document.createElement('div');
            notification.className = `alert alert-${type} mt-3`;
            notification.textContent = message;
            notification.setAttribute('role', 'alert');
            
            // Hapus notifikasi sebelumnya jika ada
            const existingAlert = document.querySelector('#loginForm .alert');
            if (existingAlert) {
                existingAlert.remove();
            }
            
            document.getElementById('loginForm').appendChild(notification);
            
            // Auto-hide setelah 5 detik
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 5000);
        }
        
        // Fungsi untuk countdown blokir
        function startBlockCountdown() {
            const countdownElement = document.getElementById('countdown');
            const blockedText = document.getElementById('blockedText');
            
            countdownElement.textContent = blockTime;
            
            const countdownInterval = setInterval(() => {
                blockTime--;
                countdownElement.textContent = blockTime;
                
                if (blockTime <= 0) {
                    clearInterval(countdownInterval);
                    isBlocked = false;
                    loginAttempts = 0;
                    
                    document.getElementById('blockedMessage').classList.add('d-none');
                    document.getElementById('attemptsCount').classList.remove('d-none');
                    document.getElementById('attemptsCount').textContent = '';
                }
            }, 1000);
        }
        
        // Fungsi untuk menampilkan welcome splash screen
        function showWelcomeSplash() {
            const splashScreen = document.getElementById('welcomeSplash');
            splashScreen.style.display = 'flex';
            
            let countdown = 5;
            const countdownElement = document.getElementById('countdownTimer');
            
            const countdownInterval = setInterval(() => {
                countdown--;
                countdownElement.textContent = countdown;
                
                if (countdown <= 0) {
                    clearInterval(countdownInterval);
                    splashScreen.style.opacity = '0';
                    setTimeout(() => {
                        splashScreen.style.display = 'none';
                    }, 500);
                }
            }, 1000);
            
            // Close button
            document.getElementById('closeSplash').addEventListener('click', function() {
                clearInterval(countdownInterval);
                splashScreen.style.opacity = '0';
                setTimeout(() => {
                    splashScreen.style.display = 'none';
                }, 500);
            });
        }
        
        // Inisialisasi aplikasi saat halaman dimuat
        document.addEventListener('DOMContentLoaded', function() {
            initLogin();
        });
    </script>
</body>
</html>
