<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SISTEM MANAJEMEN SURAT - Dinas Peternakan dan Perikanan Situbondo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <style>
        :root {
            --primary-color: #1a4f8e;
            --secondary-color: #2c6e6d;
            --accent-color: #e6b325;
            --light-blue: #e8f1fc;
            --dark-blue: #0a2a57;
            --gradient-primary: linear-gradient(135deg, var(--primary-color), var(--dark-blue));
            --gradient-secondary: linear-gradient(135deg, var(--secondary-color), #205151);
            --gradient-accent: linear-gradient(135deg, var(--accent-color), #d89c1f);
            --gradient-login: linear-gradient(135deg, #1a4f8e, #2c6e6d, #e6b325);
            --shadow-sm: 0 2px 8px rgba(0,0,0,0.08);
            --shadow-md: 0 4px 16px rgba(0,0,0,0.12);
            --shadow-lg: 0 8px 28px rgba(0,0,0,0.15);
            --border-radius: 12px;
            --transition: all 0.3s ease;
        }
        
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect fill="%23f8f9fa" width="100" height="100"/><path d="M0,0 L100,100 M100,0 L0,100" stroke="%23e9ecef" stroke-width="0.5"/></svg>');
        }
        
        .login-container {
            width: 100%;
            max-width: 450px;
            margin: 20px;
        }
        
        .login-card {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-lg);
            overflow: hidden;
            transition: var(--transition);
        }
        
        .login-header {
            background: var(--gradient-login);
            color: white;
            padding: 25px 20px;
            text-align: center;
            position: relative;
        }
        
        .shield-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            display: block;
            text-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        .login-title {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .login-subtitle {
            font-size: 1rem;
            opacity: 0.9;
        }
        
        .login-body {
            padding: 25px;
        }
        
        .form-control {
            border-radius: 8px;
            padding: 12px 15px;
            border: 1px solid #ddd;
            transition: var(--transition);
        }
        
        .form-control:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(26, 79, 142, 0.2);
        }
        
        .input-group-text {
            background: white;
            border-radius: 8px 0 0 8px;
        }
        
        .login-btn {
            background: var(--gradient-login);
            border: none;
            padding: 12px 20px;
            font-weight: 600;
            border-radius: 8px;
            width: 100%;
            color: white;
            transition: var(--transition);
        }
        
        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        
        .login-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none;
        }
        
        .attempts-counter {
            text-align: center;
            font-size: 0.9rem;
            color: #6c757d;
            margin-top: 10px;
        }
        
        .countdown {
            color: #dc3545;
            font-weight: 600;
        }
        
        .copyright {
            text-align: center;
            margin-top: 20px;
            color: #6c757d;
            font-size: 0.9rem;
        }
        
        .app-container {
            display: none;
            max-width: 1800px;
            margin: 20px auto;
            background: white;
            box-shadow: var(--shadow-lg);
            border-radius: var(--border-radius);
            overflow: hidden;
            width: 100%;
            min-height: 100vh;
            height: auto;
        }
        
        .app-header {
            background: var(--gradient-primary);
            color: white;
            padding: 20px 15px;
            text-align: center;
            position: relative;
        }
        
        .app-title {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .app-subtitle {
            font-size: 1rem;
            opacity: 0.9;
        }
        
        .app-content {
            display: flex;
            min-height: calc(100vh - 120px);
            height: auto;
        }
        
        .sidebar {
            width: 250px;
            background-color: #f8f9fa;
            padding: 20px;
            overflow-y: auto;
            border-right: 1px solid #dee2e6;
        }
        
        .main-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }
        
        .nav-pills .nav-link {
            border-radius: 8px;
            margin-bottom: 8px;
            padding: 12px 15px;
            font-weight: 500;
            color: #444;
            transition: var(--transition);
            display: flex;
            align-items: center;
        }
        
        .nav-pills .nav-link:hover {
            background-color: #f0f7ff;
            transform: translateX(3px);
        }
        
        .nav-pills .nav-link.active {
            background: var(--gradient-primary);
            font-weight: 600;
            box-shadow: var(--shadow-md);
            transform: translateX(3px);
            color: white;
        }
        
        .section-title {
            border-left: 4px solid var(--primary-color);
            padding-left: 12px;
            margin: 20px 0;
            font-weight: 700;
            color: var(--dark-blue);
            font-size: 1.4rem;
        }
        
        .stats-box {
            text-align: center;
            padding: 20px 15px;
            border-radius: 10px;
            background: white;
            box-shadow: var(--shadow-md);
            transition: var(--transition);
            margin-bottom: 15px;
        }
        
        .stats-box:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }
        
        .stats-number {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--primary-color);
            margin: 10px 0;
        }
        
        .stats-label {
            font-size: 0.9rem;
            color: #666;
            font-weight: 500;
        }
        
        .card {
            border-radius: 10px;
            border: none;
            box-shadow: var(--shadow-md);
            transition: var(--transition);
            margin-bottom: 20px;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        
        .card-header {
            border-radius: 10px 10px 0 0 !important;
            font-weight: 600;
            padding: 15px 20px;
            background: var(--gradient-primary);
            color: white;
        }
        
        .form-select {
            border-radius: 8px;
            padding: 12px 15px;
            border: 1px solid #ddd;
            transition: var(--transition);
        }
        
        .form-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(26, 79, 142, 0.2);
        }
        
        .btn-primary {
            background: var(--gradient-primary);
            border: none;
            padding: 10px 20px;
            font-weight: 600;
            border-radius: 8px;
        }
        
        .btn-success {
            background: var(--gradient-secondary);
            border: none;
            padding: 10px 20px;
            font-weight: 600;
            border-radius: 8px;
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 0.9rem;
            box-shadow: var(--shadow-sm);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .data-table th {
            background: var(--gradient-primary);
            color: white;
            padding: 12px 15px;
            text-align: left;
            font-weight: 600;
        }
        
        .data-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
        }
        
        .data-table tr:nth-child(even) {
            background-color: #f9fbff;
        }
        
        .data-table tr:hover {
            background-color: #edf5ff;
        }
        
        .badge {
            padding: 6px 10px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.75rem;
        }
        
        .badge-primary {
            background: var(--gradient-primary);
        }
        
        .badge-success {
            background: var(--gradient-secondary);
        }
        
        .badge-warning {
            background: var(--gradient-accent);
        }
        
        .badge-danger {
            background: linear-gradient(135deg, #dc3545, #a71e2a);
        }
        
        .badge-secondary {
            background: linear-gradient(135deg, #6c757d, #495057);
        }
        
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            background: white;
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            display: flex;
            align-items: center;
            transform: translateX(100%);
            transition: transform 0.3s ease;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification.success {
            border-left: 4px solid #28a745;
        }
        
        .notification.error {
            border-left: 4px solid #dc3545;
        }
        
        .notification.info {
            border-left: 4px solid #17a2b8;
        }
        
        .floating-action-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--gradient-primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow-lg);
            z-index: 100;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .floating-action-btn:hover {
            transform: scale(1.1);
        }
        
        .btn-drive {
            background: linear-gradient(135deg, #4285F4, #34A853);
            color: white;
            border: none;
        }
        
        .btn-drive:hover {
            background: linear-gradient(135deg, #3367D6, #2E8B57);
            color: white;
        }
        
        .btn-undo {
            background: linear-gradient(135deg, #6c757d, #495057);
            color: white;
            border: none;
        }
        
        .btn-undo:hover {
            background: linear-gradient(135deg, #5a6268, #3d4449);
            color: white;
        }
        
        .action-buttons {
            display: flex;
            gap: 5px;
        }
        
        .action-buttons .btn {
            padding: 5px 10px;
            font-size: 0.875rem;
        }
        
        .modal-content {
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-lg);
        }
        
        .validation-code {
            font-family: monospace;
            font-size: 1.2rem;
            letter-spacing: 2px;
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            margin-top: 10px;
        }
        
        .help-button {
            position: fixed;
            bottom: 20px;
            left: 20px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #25D366, #128C7E);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow-lg);
            z-index: 100;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .help-button:hover {
            transform: scale(1.1);
        }
        
        .developer-info {
            background-color: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-top: 30px;
            border-left: 4px solid var(--primary-color);
        }
        
        .developer-logo {
            max-width: 200px;
            margin-bottom: 15px;
        }
        
        .developer-contact a {
            color: var(--primary-color);
            text-decoration: none;
            transition: var(--transition);
        }
        
        .developer-contact a:hover {
            color: var(--secondary-color);
            text-decoration: underline;
        }
        
        .character-count {
            font-size: 0.8rem;
            color: #6c757d;
            text-align: right;
        }
        
        .character-count.warning {
            color: #dc3545;
        }
        
        .pagination-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
        }
        
        .pagination-info {
            font-size: 0.9rem;
            color: #6c757d;
        }
        
        .password-strength {
            height: 5px;
            margin-top: 5px;
            border-radius: 3px;
            transition: all 0.3s ease;
        }
        
        .password-strength.weak {
            background-color: #dc3545;
            width: 33%;
        }
        
        .password-strength.medium {
            background-color: #ffc107;
            width: 66%;
        }
        
        .password-strength.strong {
            background-color: #28a745;
            width: 100%;
        }
        
        @media print {
            body * {
                visibility: hidden;
            }
            .print-section, .print-section * {
                visibility: visible;
            }
            .print-section {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
            }
            @page {
                size: landscape;
            }
        }
        
        @media (max-width: 992px) {
            .app-title {
                font-size: 1.4rem;
            }
            
            .app-subtitle {
                font-size: 0.9rem;
            }
            
            .stats-number {
                font-size: 1.4rem;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .sidebar {
                width: 200px;
            }
        }
        
        @media (max-width: 768px) {
            .app-content {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                border-right: none;
                border-bottom: 1px solid #dee2e6;
                height: auto;
            }
            
            .app-title {
                font-size: 1.3rem;
            }
            
            .section-title {
                font-size: 1.1rem;
            }
            
            .stats-box {
                padding: 15px;
            }
            
            .action-buttons .btn {
                padding: 3px 6px;
                font-size: 0.75rem;
            }
            
            .login-title {
                font-size: 1.5rem;
            }
            
            .help-button {
                bottom: 90px;
                left: 15px;
                width: 50px;
                height: 50px;
            }
            
            .card-header .d-flex {
                flex-direction: column;
                gap: 10px;
            }
            
            .card-header .btn {
                width: 100%;
            }
            
            .pagination-container {
                flex-direction: column;
                gap: 10px;
            }
        }
        
        @media (max-width: 576px) {
            .login-container {
                margin: 10px;
            }
            
            .login-header {
                padding: 15px 10px;
            }
            
            .login-body {
                padding: 15px;
            }
            
            .app-header {
                padding: 15px 10px;
            }
            
            .main-content {
                padding: 15px;
            }
            
            .stats-box {
                margin-bottom: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- Login Form -->
    <div class="login-container" id="loginContainer">
        <div class="login-card">
            <div class="login-header">
                <i class="fas fa-shield-alt shield-icon"></i>
                <h1 class="login-title">SISTEM MANAJEMEN SURAT</h1>
                <p class="login-subtitle">Dinas Peternakan dan Perikanan Kabupaten Situbondo</p>
            </div>
            <div class="login-body">
                <div class="mb-4">
                    <label class="form-label">Username</label>
                    <div class="input-group">
                        <span class="input-group-text"><i class="fas fa-user"></i></span>
                        <input type="text" class="form-control" id="username" value="Lentera Karya Situbondo" readonly>
                    </div>
                </div>
                
                <div class="mb-4">
                    <label class="form-label">Password</label>
                    <div class="input-group">
                        <span class="input-group-text"><i class="fas fa-lock"></i></span>
                        <input type="password" class="form-control" id="password" placeholder="Masukkan password" required autocomplete="off">
                        <button class="btn btn-outline-secondary" type="button" id="togglePassword">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
                
                <div class="mb-3">
                    <button class="login-btn" id="loginBtn">
                        <i class="fas fa-sign-in-alt me-2"></i>Login
                    </button>
                </div>
                
                <div class="attempts-counter">
                    Percobaan login: <span id="attemptsCount">0</span>/5
                </div>
                
                <div class="countdown d-none" id="countdown">
                    Login dibekukan selama: <span id="countdownTimer">05:00</span>
                </div>
                
                <div class="text-center mt-3">
                    <a href="#" id="forgotPasswordLink" class="text-decoration-none">Lupa Password?</a>
                </div>
            </div>
        </div>
        
        <div class="copyright">
            &copy; 2025 Lentera Karya Situbondo. All rights reserved.
        </div>
    </div>
    
    <!-- Forgot Password Modal -->
    <div class="modal fade" id="forgotPasswordModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Reset Password</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>Untuk reset password, silakan hubungi administrator sistem di:</p>
                    <p><i class="fas fa-envelope me-2"></i> Email: <a href="mailto:admin@lenterakarya.id">admin@lenterakarya.id</a></p>
                    <p><i class="fas fa-phone me-2"></i> Telepon: <a href="tel:+623813456789">+62 381 345 6789</a></p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Tutup</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Main Application -->
    <div class="app-container" id="appContainer">
        <div class="app-header">
            <h1 class="app-title">SISTEM MANAJEMEN SURAT</h1>
            <p class="app-subtitle">Dinas Peternakan dan Perikanan Kabupaten Situbondo</p>
            <div class="position-absolute top-0 end-0 m-3">
                <span class="badge bg-light text-dark"><i class="fas fa-user me-1"></i> <span id="userDisplayName">Lentera Karya Situbondo</span></span>
            </div>
        </div>
        
        <div class="app-content">
            <!-- Sidebar -->
            <div class="sidebar">
                <ul class="nav nav-pills flex-column mb-auto">
                    <li class="nav-item">
                        <a href="#" class="nav-link active" data-section="dashboard">
                            <i class="fas fa-tachometer-alt me-2"></i> Dashboard
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-section="input">
                            <i class="fas fa-plus-circle me-2"></i> Input Surat
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-section="settings">
                            <i class="fas fa-cog me-2"></i> Pengaturan
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-section="about">
                            <i class="fas fa-info-circle me-2"></i> Tentang
                        </a>
                    </li>
                    <li class="nav-item mt-4">
                        <a href="#" class="nav-link text-danger" id="logoutBtn">
                            <i class="fas fa-sign-out-alt me-2"></i> Logout
                        </a>
                    </li>
                </ul>
            </div>
            
            <!-- Main Content -->
            <div class="main-content">
                <!-- Dashboard Section -->
                <div class="content-section" id="dashboardSection">
                    <h2 class="section-title">Dashboard</h2>
                    
                    <div class="row">
                        <div class="col-md-3">
                            <div class="stats-box">
                                <i class="fas fa-envelope-open text-primary mb-2" style="font-size: 2rem;"></i>
                                <div class="stats-number" id="totalIncoming">0</div>
                                <div class="stats-label">Total Surat Masuk</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stats-box">
                                <i class="fas fa-paper-plane text-success mb-2" style="font-size: 2rem;"></i>
                                <div class="stats-number" id="totalOutgoing">0</div>
                                <div class="stats-label">Total Surat Keluar</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stats-box">
                                <i class="fas fa-clock text-warning mb-2" style="font-size: 2rem;"></i>
                                <div class="stats-number" id="totalPending">0</div>
                                <div class="stats-label">Menunggu Tindakan</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stats-box">
                                <i class="fas fa-check-circle text-info mb-2" style="font-size: 2rem;"></i>
                                <div class="stats-number" id="totalProcessed">0</div>
                                <div class="stats-label">Telah Diproses</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row mt-4">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <div>
                                        <i class="fas fa-history me-2"></i>Aktivitas Terbaru
                                    </div>
                                    <button class="btn btn-sm btn-outline-primary" id="refreshActivitiesBtn">
                                        <i class="fas fa-sync-alt"></i> Refresh
                                    </button>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-hover">
                                            <thead>
                                                <tr>
                                                    <th>Tanggal</th>
                                                    <th>Jenis</th>
                                                    <th>Nomor</th>
                                                    <th>Perihal</th>
                                                    <th>Status</th>
                                                </tr>
                                            </thead>
                                            <tbody id="recentActivities">
                                                <tr>
                                                    <td colspan="5" class="text-center">Tidak ada aktivitas terbaru</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Input Surat Section -->
                <div class="content-section d-none" id="inputSection">
                    <h2 class="section-title">Input Surat Baru</h2>
                    
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <div>
                                <i class="fas fa-edit me-2"></i>Form Input Surat
                            </div>
                            <div>
                                <button type="button" class="btn btn-undo me-2" id="undoBtn" title="Kembalikan nilai sebelumnya">
                                    <i class="fas fa-undo me-1"></i>Undo
                                </button>
                                <button type="button" class="btn btn-secondary" id="resetBtn">
                                    <i class="fas fa-times me-1"></i>Reset
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <form id="mailForm">
                                <input type="hidden" id="editId" value="">
                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <label class="form-label">Jenis Surat *</label>
                                        <select class="form-select" id="mailType" required>
                                            <option value="">Pilih Jenis Surat</option>
                                            <option value="masuk">Surat Masuk</option>
                                            <option value="keluar">Surat Keluar</option>
                                        </select>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Nomor Surat *</label>
                                        <input type="text" class="form-control" id="mailNumber" placeholder="Nomor surat" required>
                                    </div>
                                </div>
                                
                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <label class="form-label" id="senderLabel">Nama Pengirim *</label>
                                        <input type="text" class="form-control" id="mailSender" placeholder="Nama pengirim" required>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label" id="receiverLabel">Tujuan *</label>
                                        <input type="text" class="form-control" id="mailReceiver" placeholder="Tujuan surat" required>
                                    </div>
                                </div>
                                
                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <label class="form-label">Tanggal Surat *</label>
                                        <input type="date" class="form-control" id="mailDate" required>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label" id="actionDateLabel">Tanggal Diterima/Dikirim *</label>
                                        <input type="date" class="form-control" id="mailActionDate" required>
                                    </div>
                                </div>
                                
                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <label class="form-label">Status Surat *</label>
                                        <select class="form-select" id="mailStatus" required>
                                            <option value="">Pilih Status</option>
                                            <option value="biasa">Biasa</option>
                                            <option value="penting">Penting</option>
                                            <option value="rahasia">Rahasia</option>
                                        </select>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Nama Petugas Validasi *</label>
                                        <input type="text" class="form-control" id="mailValidator" placeholder="Nama petugas validasi" required>
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Perihal * (Maksimal 500 karakter)</label>
                                    <textarea class="form-control" id="mailSubject" rows="2" placeholder="Perihal surat" required maxlength="500"></textarea>
                                    <div class="character-count" id="subjectCharCount">0/500 karakter</div>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Keterangan (Maksimal 500 karakter)</label>
                                    <textarea class="form-control" id="mailDescription" rows="3" placeholder="Keterangan tambahan" maxlength="500"></textarea>
                                    <div class="character-count" id="descriptionCharCount">0/500 karakter</div>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Tautan Dokumen (Google Drive)</label>
                                    <div class="input-group">
                                        <input type="url" class="form-control" id="mailLink" placeholder="https://drive.google.com/...">
                                        <button class="btn btn-outline-secondary" type="button" id="testLinkBtn" title="Test tautan">
                                            <i class="fas fa-external-link-alt"></i>
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Kode Validasi</label>
                                    <div class="d-flex align-items-center">
                                        <input type="text" class="form-control me-2" id="validationCode" placeholder="Kode validasi" readonly>
                                        <button type="button" class="btn btn-primary" id="generateCodeBtn">
                                            <i class="fas fa-sync-alt me-1"></i>Generate
                                        </button>
                                    </div>
                                    <div class="form-text">Klik tombol Generate untuk membuat kode validasi</div>
                                </div>
                                
                                <div class="d-flex justify-content-end">
                                    <button type="submit" class="btn btn-success">
                                        <i class="fas fa-save me-1"></i>Simpan Surat
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                    
                    <!-- Data Surat Table -->
                    <h2 class="section-title mt-5">Data Surat</h2>
                    
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center flex-wrap">
                            <div>
                                <i class="fas fa-table me-2"></i>Daftar Surat
                            </div>
                            <div class="d-flex flex-wrap gap-2 mt-2 mt-md-0">
                                <select class="form-select form-select-sm" id="filterType" style="width: auto;">
                                    <option value="">Semua Jenis</option>
                                    <option value="masuk">Surat Masuk</option>
                                    <option value="keluar">Surat Keluar</option>
                                </select>
                                <select class="form-select form-select-sm" id="filterStatus" style="width: auto;">
                                    <option value="">Semua Status</option>
                                    <option value="biasa">Biasa</option>
                                    <option value="penting">Penting</option>
                                    <option value="rahasia">Rahasia</option>
                                </select>
                                <input type="text" class="form-control form-control-sm" id="searchInput" placeholder="Cari..." style="width: 150px;">
                                <button class="btn btn-sm btn-outline-primary" id="exportBtn">
                                    <i class="fas fa-download me-1"></i>Ekspor
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover" id="mailTable">
                                    <thead>
                                        <tr>
                                            <th>No</th>
                                            <th>Jenis</th>
                                            <th>Nomor</th>
                                            <th>Tanggal</th>
                                            <th>Perihal</th>
                                            <th>Status</th>
                                            <th>Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody id="mailTableBody">
                                        <tr>
                                            <td colspan="7" class="text-center">Tidak ada data surat</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <div class="pagination-container">
                                <div class="pagination-info" id="paginationInfo">
                                    Menampilkan 0 dari 0 data
                                </div>
                                <nav>
                                    <ul class="pagination pagination-sm" id="pagination">
                                        <li class="page-item disabled">
                                            <a class="page-link" href="#" tabindex="-1">Sebelumnya</a>
                                        </li>
                                        <li class="page-item active">
                                            <a class="page-link" href="#">1</a>
                                        </li>
                                        <li class="page-item disabled">
                                            <a class="page-link" href="#">Selanjutnya</a>
                                        </li>
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Settings Section -->
                <div class="content-section d-none" id="settingsSection">
                    <h2 class="section-title">Pengaturan Sistem</h2>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <i class="fas fa-user-cog me-2"></i>Pengaturan Akun
                                </div>
                                <div class="card-body">
                                    <form id="accountForm">
                                        <div class="mb-3">
                                            <label class="form-label">Nama Instansi *</label>
                                            <input type="text" class="form-control" id="institutionName" value="Dinas Peternakan dan Perikanan Kabupaten Situbondo" required>
                                        </div>
                                        
                                        <div class="mb-3">
                                            <label class="form-label">Username</label>
                                            <input type="text" class="form-control" value="Lentera Karya Situbondo" readonly>
                                        </div>
                                        
                                        <div class="mb-3">
                                            <label class="form-label">Password Baru</label>
                                            <input type="password" class="form-control" id="newPassword" placeholder="Kosongkan jika tidak ingin mengubah">
                                            <div class="password-strength" id="passwordStrength"></div>
                                            <div class="form-text">Minimal 8 karakter, kombinasi huruf dan angka</div>
                                        </div>
                                        
                                        <div class="mb-3">
                                            <label class="form-label">Konfirmasi Password Baru</label>
                                            <input type="password" class="form-control" id="confirmPassword" placeholder="Konfirmasi password baru">
                                        </div>
                                        
                                        <div class="mb-3">
                                            <label class="form-label">Password Saat Ini *</label>
                                            <input type="password" class="form-control" id="currentPassword" placeholder="Masukkan password saat ini" required>
                                        </div>
                                        
                                        <div class="d-flex justify-content-end">
                                            <button type="submit" class="btn btn-primary">
                                                <i class="fas fa-save me-1"></i>Simpan Perubahan
                                            </button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <i class="fas fa-database me-2"></i>Manajemen Data
                                </div>
                                <div class="card-body">
                                    <div class="mb-4">
                                        <h5 class="mb-3">Backup Data</h5>
                                        <p>Buat cadangan data surat untuk mencegah kehilangan data.</p>
                                        <div class="d-flex gap-2">
                                            <button class="btn btn-primary" id="backupBtn">
                                                <i class="fas fa-download me-1"></i>Backup Data
                                            </button>
                                            <button class="btn btn-outline-primary" id="backupSettingsBtn">
                                                <i class="fas fa-cog me-1"></i>Pengaturan
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <h5 class="mb-3">Restore Data</h5>
                                        <p>Pulihkan data dari file backup sebelumnya.</p>
                                        <div class="d-flex gap-2">
                                            <input type="file" class="d-none" id="restoreFileInput" accept=".json">
                                            <button class="btn btn-success" id="restoreBtn">
                                                <i class="fas fa-upload me-1"></i>Restore Data
                                            </button>
                                            <button class="btn btn-outline-success" id="restoreSettingsBtn">
                                                <i class="fas fa-cog me-1"></i>Pengaturan
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <h5 class="mb-3">Reset Data</h5>
                                        <p>Hapus semua data surat dan reset ke kondisi awal.</p>
                                        <div class="alert alert-warning">
                                            <i class="fas fa-exclamation-triangle me-1"></i>
                                            <strong>Peringatan:</strong> Tindakan ini akan menghapus semua data surat dan tidak dapat dibatalkan!
                                        </div>
                                        <div class="d-flex gap-2">
                                            <button class="btn btn-danger" id="resetDataBtn" data-bs-toggle="modal" data-bs-target="#resetDataModal">
                                                <i class="fas fa-trash-alt me-1"></i>Reset Data
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- About Section -->
                <div class="content-section d-none" id="aboutSection">
                    <h2 class="section-title">Tentang Aplikasi</h2>
                    
                    <div class="card">
                        <div class="card-header">
                            <i class="fas fa-info-circle me-2"></i>Informasi Aplikasi
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <h5>SISTEM MANAJEMEN SURAT</h5>
                                    <p>Aplikasi ini dirancang khusus untuk Dinas Peternakan dan Perikanan Kabupaten Situbondo untuk mengelola surat masuk dan surat keluar secara digital.</p>
                                    
                                    <h5 class="mt-4">Fitur Utama</h5>
                                    <ul>
                                        <li>Input dan manajemen surat masuk dan keluar</li>
                                        <li>Pencarian dan filter data surat</li>
                                        <li>Ekspor data ke format Excel dan PDF</li>
                                        <li>Backup dan restore data</li>
                                        <li>Pengaturan akun yang fleksibel</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <h5>Informasi Versi</h5>
                                    <table class="table table-sm">
                                        <tr>
                                            <td width="120">Versi</td>
                                            <td><strong>2.1.0</strong></td>
                                        </tr>
                                        <tr>
                                            <td>Tanggal Rilis</td>
                                            <td>28 Agustus 2025</td>
                                        </tr>
                                        <tr>
                                            <td>Browser Minimal</td>
                                            <td>Chrome 70, Firefox 65, Safari 12</td>
                                        </tr>
                                    </table>
                                    
                                    <h5 class="mt-4">Dukungan Teknis</h5>
                                    <p>Untuk bantuan teknis dan pertanyaan, hubungi:</p>
                                    <p>
                                        <i class="fas fa-envelope me-2"></i> Email: <a href="mailto:support@lenterakarya.id">support@lenterakarya.id</a><br>
                                        <i class="fas fa-phone me-2"></i> Telepon: <a href="tel:+623813456789">+62 381 345 6789</a>
                                    </p>
                                </div>
                            </div>
                            
                            <hr>
                            
                            <div class="developer-info">
                                <h5>Dikembangkan oleh:</h5>
                                <div class="d-flex align-items-center mb-3">
                                    <div class="bg-primary text-white rounded p-2 me-3">
                                        <i class="fas fa-laptop-code" style="font-size: 2rem;"></i>
                                    </div>
                                    <div>
                                        <h5 class="mb-0">Lentera Karya Situbondo</h5>
                                        <p class="mb-0">Software Development Team</p>
                                    </div>
                                </div>
                                
                                <div class="developer-contact">
                                    <p>
                                        <i class="fas fa-map-marker-alt me-2"></i> Jl. Raya Situbondo No. 123, Jawa Timur<br>
                                        <i class="fas fa-globe me-2"></i> Website: <a href="https://www.lenterakarya.id" target="_blank">www.lenterakarya.id</a>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Reset Data Modal -->
        <div class="modal fade" id="resetDataModal" tabindex="-1" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Konfirmasi Reset Data</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="alert alert-danger">
                            <i class="fas fa-exclamation-triangle me-2"></i>
                            <strong>PERINGATAN TINGGI!</strong> Tindakan ini akan menghapus SEMUA data surat dan tidak dapat dibatalkan!
                        </div>
                        
                        <p>Untuk mengonfirmasi reset data, ketik <strong>"RESET SEMUA DATA"</strong> pada kolom di bawah ini:</p>
                        
                        <input type="text" class="form-control mb-3" id="resetConfirmationInput" placeholder='Ketik "RESET SEMUA DATA"'>
                        
                        <div class="mb-3">
                            <label class="form-label">Masukkan Password Anda:</label>
                            <input type="password" class="form-control" id="resetPassword" placeholder="Password saat ini">
                        </div>
                        
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="resetBackupCheck">
                            <label class="form-check-label" for="resetBackupCheck">
                                Buat backup otomatis sebelum reset
                            </label>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                        <button type="button" class="btn btn-danger" id="confirmResetBtn" disabled>Reset Semua Data</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Delete Confirmation Modal -->
        <div class="modal fade" id="deleteConfirmModal" tabindex="-1" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Konfirmasi Penghapusan</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <p>Apakah Anda yakin ingin menghapus surat ini?</p>
                        <div class="alert alert-warning">
                            <i class="fas fa-exclamation-triangle me-1"></i>
                            Data yang dihapus tidak dapat dikembalikan.
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Masukkan Password untuk Konfirmasi:</label>
                            <input type="password" class="form-control" id="deletePassword" placeholder="Password saat ini">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                        <button type="button" class="btn btn-danger" id="confirmDeleteBtn">Hapus</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Floating Action Button -->
    <div class="floating-action-btn d-none" id="fabBtn">
        <i class="fas fa-plus"></i>
    </div>
    
    <!-- Help Button -->
    <div class="help-button" id="helpBtn">
        <i class="fas fa-question"></i>
    </div>
    
    <!-- Notification -->
    <div class="notification d-none" id="notification">
        <i class="fas fa-check-circle me-2 text-success"></i>
        <span id="notificationText">Operasi berhasil dilakukan</span>
    </div>
    
    <!-- Bootstrap & jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Inisialisasi variabel global
        let mailData = [];
        let loginAttempts = 0;
        let isLoginLocked = false;
        let currentPage = 1;
        const itemsPerPage = 10;
        let currentEditId = null;
        let originalFormValues = {};
        
        // Fungsi untuk menampilkan notifikasi
        function showNotification(message, type = 'success') {
            const notification = $('#notification');
            const notificationText = $('#notificationText');
            const notificationIcon = notification.find('i');
            
            notification.removeClass('success error info');
            notificationIcon.removeClass().addClass('fas me-2');
            
            if (type === 'success') {
                notification.addClass('success');
                notificationIcon.addClass('fa-check-circle text-success');
            } else if (type === 'error') {
                notification.addClass('error');
                notificationIcon.addClass('fa-exclamation-circle text-danger');
            } else if (type === 'info') {
                notification.addClass('info');
                notificationIcon.addClass('fa-info-circle text-info');
            }
            
            notificationText.text(message);
            notification.removeClass('d-none').addClass('show');
            
            setTimeout(() => {
                notification.removeClass('show');
                setTimeout(() => notification.addClass('d-none'), 300);
            }, 3000);
        }
        
        // Fungsi untuk memuat data dari localStorage
        function loadData() {
            const savedData = localStorage.getItem('mailData');
            if (savedData) {
                mailData = JSON.parse(savedData);
            }
            
            updateDashboardStats();
            renderMailTable();
            updateRecentActivities();
        }
        
        // Fungsi untuk menyimpan data ke localStorage
        function saveData() {
            localStorage.setItem('mailData', JSON.stringify(mailData));
            localStorage.setItem('institutionName', $('#institutionName').val());
        }
        
        // Fungsi untuk memperbarui statistik dashboard
        function updateDashboardStats() {
            const totalIncoming = mailData.filter(mail => mail.type === 'masuk').length;
            const totalOutgoing = mailData.filter(mail => mail.type === 'keluar').length;
            const totalPending = mailData.filter(mail => mail.status === 'pending').length;
            const totalProcessed = mailData.length - totalPending;
            
            $('#totalIncoming').text(totalIncoming);
            $('#totalOutgoing').text(totalOutgoing);
            $('#totalPending').text(totalPending);
            $('#totalProcessed').text(totalProcessed);
        }
        
        // Fungsi untuk memperbarui aktivitas terbaru
        function updateRecentActivities() {
            const recentActivities = $('#recentActivities');
            recentActivities.empty();
            
            if (mailData.length === 0) {
                recentActivities.append('<tr><td colspan="5" class="text-center">Tidak ada aktivitas terbaru</td></tr>');
                return;
            }
            
            // Ambil 5 data terbaru
            const recentData = [...mailData]
                .sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp))
                .slice(0, 5);
            
            recentData.forEach(mail => {
                const date = new Date(mail.date).toLocaleDateString('id-ID');
                const badgeClass = mail.status === 'biasa' ? 'badge-primary' : 
                                  mail.status === 'penting' ? 'badge-warning' : 'badge-danger';
                
                const row = `
                    <tr>
                        <td>${date}</td>
                        <td>${mail.type === 'masuk' ? 'Masuk' : 'Keluar'}</td>
                        <td>${mail.number}</td>
                        <td>${mail.subject.substring(0, 30)}${mail.subject.length > 30 ? '...' : ''}</td>
                        <td><span class="badge ${badgeClass}">${mail.status}</span></td>
                    </tr>
                `;
                
                recentActivities.append(row);
            });
        }
        
        // Fungsi untuk merender tabel surat
        function renderMailTable() {
            const tableBody = $('#mailTableBody');
            tableBody.empty();
            
            if (mailData.length === 0) {
                tableBody.append('<tr><td colspan="7" class="text-center">Tidak ada data surat</td></tr>');
                updatePagination();
                return;
            }
            
            // Filter data
            const filterType = $('#filterType').val();
            const filterStatus = $('#filterStatus').val();
            const searchText = $('#searchInput').val().toLowerCase();
            
            let filteredData = mailData.filter(mail => {
                const matchesType = !filterType || mail.type === filterType;
                const matchesStatus = !filterStatus || mail.status === filterStatus;
                const matchesSearch = !searchText || 
                                    mail.number.toLowerCase().includes(searchText) ||
                                    mail.subject.toLowerCase().includes(searchText) ||
                                    mail.sender.toLowerCase().includes(searchText) ||
                                    mail.receiver.toLowerCase().includes(searchText);
                
                return matchesType && matchesStatus && matchesSearch;
            });
            
            // Hitung total halaman
            const totalPages = Math.ceil(filteredData.length / itemsPerPage);
            if (currentPage > totalPages) currentPage = totalPages;
            if (currentPage < 1) currentPage = 1;
            
            // Ambil data untuk halaman saat ini
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = Math.min(startIndex + itemsPerPage, filteredData.length);
            const currentData = filteredData.slice(startIndex, endIndex);
            
            // Render data
            currentData.forEach((mail, index) => {
                const rowNumber = startIndex + index + 1;
                const date = new Date(mail.date).toLocaleDateString('id-ID');
                const badgeClass = mail.status === 'biasa' ? 'badge-primary' : 
                                  mail.status === 'penting' ? 'badge-warning' : 'badge-danger';
                
                const row = `
                    <tr>
                        <td>${rowNumber}</td>
                        <td>${mail.type === 'masuk' ? 'Masuk' : 'Keluar'}</td>
                        <td>${mail.number}</td>
                        <td>${date}</td>
                        <td>${mail.subject.substring(0, 30)}${mail.subject.length > 30 ? '...' : ''}</td>
                        <td><span class="badge ${badgeClass}">${mail.status}</span></td>
                        <td class="action-buttons">
                            <button class="btn btn-sm btn-info view-btn" data-id="${mail.id}" title="Lihat Detail">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn btn-sm btn-warning edit-btn" data-id="${mail.id}" title="Edit">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-sm btn-danger delete-btn" data-id="${mail.id}" title="Hapus">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `;
                
                tableBody.append(row);
            });
            
            updatePagination(filteredData.length);
            
            // Tambahkan event listener untuk tombol aksi
            $('.view-btn').on('click', function() {
                const id = $(this).data('id');
                viewMail(id);
            });
            
            $('.edit-btn').on('click', function() {
                const id = $(this).data('id');
                editMail(id);
            });
            
            $('.delete-btn').on('click', function() {
                const id = $(this).data('id');
                showDeleteModal(id);
            });
        }
        
        // Fungsi untuk memperbarui tampilan pagination
        function updatePagination(totalItems = 0) {
            const totalPages = Math.ceil(totalItems / itemsPerPage);
            const pagination = $('#pagination');
            const paginationInfo = $('#paginationInfo');
            
            // Update info pagination
            const startItem = totalItems === 0 ? 0 : (currentPage - 1) * itemsPerPage + 1;
            const endItem = Math.min(currentPage * itemsPerPage, totalItems);
            paginationInfo.text(`Menampilkan ${startItem} sampai ${endItem} dari ${totalItems} data`);
            
            // Update tombol pagination
            pagination.empty();
            
            // Tombol Previous
            const prevClass = currentPage === 1 ? 'disabled' : '';
            pagination.append(`
                <li class="page-item ${prevClass}">
                    <a class="page-link" href="#" data-page="${currentPage - 1}">Sebelumnya</a>
                </li>
            `);
            
            // Tampilkan maksimal 5 halaman
            let startPage = Math.max(1, currentPage - 2);
            let endPage = Math.min(totalPages, startPage + 4);
            
            if (endPage - startPage < 4) {
                startPage = Math.max(1, endPage - 4);
            }
            
            for (let i = startPage; i <= endPage; i++) {
                const activeClass = i === currentPage ? 'active' : '';
                pagination.append(`
                    <li class="page-item ${activeClass}">
                        <a class="page-link" href="#" data-page="${i}">${i}</a>
                    </li>
                `);
            }
            
            // Tombol Next
            const nextClass = currentPage === totalPages ? 'disabled' : '';
            pagination.append(`
                <li class="page-item ${nextClass}">
                    <a class="page-link" href="#" data-page="${currentPage + 1}">Selanjutnya</a>
                </li>
            `);
            
            // Event listener untuk tombol pagination
            $('.page-link').on('click', function(e) {
                e.preventDefault();
                const page = $(this).data('page');
                if (page && page !== currentPage) {
                    currentPage = page;
                    renderMailTable();
                }
            });
        }
        
        // Fungsi untuk melihat detail surat
        function viewMail(id) {
            const mail = mailData.find(m => m.id === id);
            if (!mail) return;
            
            const modalContent = `
                <div class="modal-header">
                    <h5 class="modal-title">Detail Surat</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <strong>Jenis Surat:</strong><br>
                            ${mail.type === 'masuk' ? 'Surat Masuk' : 'Surat Keluar'}
                        </div>
                        <div class="col-md-6">
                            <strong>Nomor Surat:</strong><br>
                            ${mail.number}
                        </div>
                    </div>
                    
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <strong>${mail.type === 'masuk' ? 'Pengirim' : 'Penerima'}:</strong><br>
                            ${mail.type === 'masuk' ? mail.sender : mail.receiver}
                        </div>
                        <div class="col-md-6">
                            <strong>Tanggal Surat:</strong><br>
                            ${new Date(mail.date).toLocaleDateString('id-ID')}
                        </div>
                    </div>
                    
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <strong>Status:</strong><br>
                            <span class="badge ${mail.status === 'biasa' ? 'badge-primary' : mail.status === 'penting' ? 'badge-warning' : 'badge-danger'}">
                                ${mail.status}
                            </span>
                        </div>
                        <div class="col-md-6">
                            <strong>Petugas Validasi:</strong><br>
                            ${mail.validator}
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <strong>Perihal:</strong><br>
                        ${mail.subject}
                    </div>
                    
                    ${mail.description ? `
                    <div class="mb-3">
                        <strong>Keterangan:</strong><br>
                        ${mail.description}
                    </div>
                    ` : ''}
                    
                    ${mail.link ? `
                    <div class="mb-3">
                        <strong>Tautan Dokumen:</strong><br>
                        <a href="${mail.link}" target="_blank">${mail.link}</a>
                    </div>
                    ` : ''}
                    
                    <div class="mb-3">
                        <strong>Kode Validasi:</strong><br>
                        <code>${mail.validationCode}</code>
                    </div>
                    
                    <div class="mb-3">
                        <strong>Tanggal Input:</strong><br>
                        ${new Date(mail.timestamp).toLocaleString('id-ID')}
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Tutup</button>
                </div>
            `;
            
            // Buat modal dinamis
            const modalId = 'viewMailModal';
            let modal = document.getElementById(modalId);
            if (!modal) {
                modal = document.createElement('div');
                modal.className = 'modal fade';
                modal.id = modalId;
                modal.tabIndex = -1;
                modal.innerHTML = `
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            ${modalContent}
                        </div>
                    </div>
                `;
                document.body.appendChild(modal);
            } else {
                modal.querySelector('.modal-content').innerHTML = modalContent;
            }
            
            // Tampilkan modal
            $(modal).modal('show');
        }
        
        // Fungsi untuk mengedit surat
        function editMail(id) {
            const mail = mailData.find(m => m.id === id);
            if (!mail) return;
            
            // Isi form dengan data yang ada
            $('#editId').val(mail.id);
            $('#mailType').val(mail.type);
            $('#mailNumber').val(mail.number);
            $('#mailSender').val(mail.sender);
            $('#mailReceiver').val(mail.receiver);
            $('#mailDate').val(mail.date);
            $('#mailActionDate').val(mail.actionDate);
            $('#mailStatus').val(mail.status);
            $('#mailValidator').val(mail.validator);
            $('#mailSubject').val(mail.subject);
            $('#mailDescription').val(mail.description || '');
            $('#mailLink').val(mail.link || '');
            $('#validationCode').val(mail.validationCode);
            
            // Update label form berdasarkan jenis surat
            updateFormLabels();
            
            // Scroll ke form
            $('html, body').animate({
                scrollTop: $('#mailForm').offset().top - 20
            }, 500);
            
            // Simpan nilai asli untuk undo
            originalFormValues = {...mail};
        }
        
        // Fungsi untuk menampilkan modal konfirmasi hapus
        function showDeleteModal(id) {
            $('#deleteConfirmModal').data('id', id).modal('show');
            $('#deletePassword').val('');
        }
        
        // Fungsi untuk menghapus surat
        function deleteMail(id) {
            mailData = mailData.filter(mail => mail.id !== id);
            saveData();
            renderMailTable();
            updateDashboardStats();
            updateRecentActivities();
            showNotification('Surat berhasil dihapus', 'success');
        }
        
        // Fungsi untuk memperbarui label form berdasarkan jenis surat
        function updateFormLabels() {
            const type = $('#mailType').val();
            if (type === 'masuk') {
                $('#senderLabel').text('Nama Pengirim *');
                $('#receiverLabel').text('Tujuan *');
                $('#mailSender').attr('placeholder', 'Nama pengirim');
                $('#mailReceiver').attr('placeholder', 'Tujuan surat');
                $('#actionDateLabel').text('Tanggal Diterima *');
            } else if (type === 'keluar') {
                $('#senderLabel').text('Nama Penerima *');
                $('#receiverLabel').text('Tujuan *');
                $('#mailSender').attr('placeholder', 'Nama penerima');
                $('#mailReceiver').attr('placeholder', 'Tujuan surat');
                $('#actionDateLabel').text('Tanggal Dikirim *');
            }
        }
        
        // Fungsi untuk menghasilkan kode validasi acak
        function generateValidationCode() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let code = '';
            for (let i = 0; i < 8; i++) {
                code += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return code;
        }
        
        // Fungsi untuk mengekspor data
        function exportData(format) {
            if (mailData.length === 0) {
                showNotification('Tidak ada data untuk diekspor', 'info');
                return;
            }
            
            try {
                if (format === 'excel') {
                    // Ekspor ke Excel
                    const worksheet = XLSX.utils.json_to_sheet(mailData.map(mail => ({
                        'Jenis Surat': mail.type === 'masuk' ? 'Surat Masuk' : 'Surat Keluar',
                        'Nomor Surat': mail.number,
                        'Pengirim/Penerima': mail.sender,
                        'Tujuan': mail.receiver,
                        'Tanggal Surat': new Date(mail.date).toLocaleDateString('id-ID'),
                        'Tanggal Diterima/Dikirim': new Date(mail.actionDate).toLocaleDateString('id-ID'),
                        'Status': mail.status,
                        'Petugas Validasi': mail.validator,
                        'Perihal': mail.subject,
                        'Keterangan': mail.description || '',
                        'Tautan Dokumen': mail.link || '',
                        'Kode Validasi': mail.validationCode,
                        'Tanggal Input': new Date(mail.timestamp).toLocaleString('id-ID')
                    })));
                    
                    const workbook = XLSX.utils.book_new();
                    XLSX.utils.book_append_sheet(workbook, worksheet, 'Data Surat');
                    XLSX.writeFile(workbook, `data_surat_${new Date().toISOString().slice(0,10)}.xlsx`);
                    
                    showNotification('Data berhasil diekspor ke Excel', 'success');
                } else if (format === 'pdf') {
                    // Ekspor ke PDF
                    const { jsPDF } = window.jspdf;
                    const doc = new jsPDF();
                    
                    // Judul
                    doc.setFontSize(16);
                    doc.text('DATA SURAT', 105, 15, { align: 'center' });
                    doc.setFontSize(12);
                    doc.text(`Dinas Peternakan dan Perikanan Kabupaten Situbondo`, 105, 22, { align: 'center' });
                    doc.text(`Tanggal Ekspor: ${new Date().toLocaleDateString('id-ID')}`, 105, 29, { align: 'center' });
                    
                    // Data
                    const tableData = mailData.map(mail => [
                        mail.type === 'masuk' ? 'Masuk' : 'Keluar',
                        mail.number,
                        new Date(mail.date).toLocaleDateString('id-ID'),
                        mail.subject.substring(0, 30) + (mail.subject.length > 30 ? '...' : ''),
                        mail.status
                    ]);
                    
                    doc.autoTable({
                        head: [['Jenis', 'Nomor', 'Tanggal', 'Perihal', 'Status']],
                        body: tableData,
                        startY: 35,
                        theme: 'grid',
                        styles: { fontSize: 8 },
                        headStyles: { fillColor: [26, 79, 142] }
                    });
                    
                    doc.save(`data_surat_${new Date().toISOString().slice(0,10)}.pdf`);
                    
                    showNotification('Data berhasil diekspor ke PDF', 'success');
                }
            } catch (error) {
                console.error('Error exporting data:', error);
                showNotification('Gagal mengekspor data', 'error');
            }
        }
        
        // Fungsi untuk backup data
        function backupData() {
            if (mailData.length === 0) {
                showNotification('Tidak ada data untuk dibackup', 'info');
                return;
            }
            
            try {
                const backup = {
                    version: '2.1.0',
                    timestamp: new Date().toISOString(),
                    data: mailData
                };
                
                const dataStr = JSON.stringify(backup);
                const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
                
                const exportFileDefaultName = `backup_surat_${new Date().toISOString().slice(0,10)}.json`;
                
                const linkElement = document.createElement('a');
                linkElement.setAttribute('href', dataUri);
                linkElement.setAttribute('download', exportFileDefaultName);
                linkElement.click();
                
                showNotification('Backup data berhasil', 'success');
            } catch (error) {
                console.error('Error backing up data:', error);
                showNotification('Gagal melakukan backup data', 'error');
            }
        }
        
        // Fungsi untuk restore data
        function restoreData(file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const backup = JSON.parse(e.target.result);
                    
                    // Validasi data backup
                    if (!backup.data || !Array.isArray(backup.data)) {
                        throw new Error('Format file backup tidak valid');
                    }
                    
                    // Konfirmasi sebelum restore
                    if (confirm('Restore data akan menggantikan semua data saat ini. Lanjutkan?')) {
                        mailData = backup.data;
                        saveData();
                        renderMailTable();
                        updateDashboardStats();
                        updateRecentActivities();
                        showNotification('Data berhasil direstore', 'success');
                    }
                } catch (error) {
                    console.error('Error restoring data:', error);
                    showNotification('Gagal merestore data: Format file tidak valid', 'error');
                }
            };
            reader.readAsText(file);
        }
        
        // Fungsi untuk reset data
        function resetData() {
            // Konfirmasi tambahan
            if (!confirm('Yakin ingin menghapus SEMUA data? Tindakan ini tidak dapat dibatalkan!')) {
                return;
            }
            
            mailData = [];
            saveData();
            renderMailTable();
            updateDashboardStats();
            updateRecentActivities();
            showNotification('Semua data berhasil direset', 'success');
        }
        
        // Fungsi untuk validasi password
        function validatePassword(password) {
            // Password default adalah "situbondo123"
            return password === 'situbondo123';
        }
        
        // Event listener saat dokumen siap
        $(document).ready(function() {
            // Inisialisasi tooltip Bootstrap
            $('[data-bs-toggle="tooltip"]').tooltip();
            
            // Muat data dari localStorage
            loadData();
            
            // Atur tanggal hari ini sebagai default
            const today = new Date().toISOString().split('T')[0];
            $('#mailDate').val(today);
            $('#mailActionDate').val(today);
            
            // Event listener untuk toggle password visibility
            $('#togglePassword').on('click', function() {
                const passwordField = $('#password');
                const type = passwordField.attr('type') === 'password' ? 'text' : 'password';
                passwordField.attr('type', type);
                $(this).find('i').toggleClass('fa-eye fa-eye-slash');
            });
            
            // Event listener untuk login
            $('#loginBtn').on('click', function() {
                if (isLoginLocked) {
                    showNotification('Login dibekukan. Silakan coba lagi nanti.', 'error');
                    return;
                }
                
                const password = $('#password').val();
                
                if (validatePassword(password)) {
                    // Login berhasil
                    $('#loginContainer').addClass('d-none');
                    $('#appContainer').removeClass('d-none');
                    $('#fabBtn').removeClass('d-none');
                    
                    // Reset percobaan login
                    loginAttempts = 0;
                    $('#attemptsCount').text(loginAttempts);
                    $('#countdown').addClass('d-none');
                    
                    showNotification('Login berhasil. Selamat datang!', 'success');
                } else {
                    // Login gagal
                    loginAttempts++;
                    $('#attemptsCount').text(loginAttempts);
                    
                    if (loginAttempts >= 5) {
                        // Kunci login setelah 5 percobaan gagal
                        isLoginLocked = true;
                        $('#countdown').removeClass('d-none');
                        
                        let timeLeft = 300; // 5 menit dalam detik
                        const countdownInterval = setInterval(() => {
                            timeLeft--;
                            
                            const minutes = Math.floor(timeLeft / 60);
                            const seconds = timeLeft % 60;
                            $('#countdownTimer').text(`${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`);
                            
                            if (timeLeft <= 0) {
                                clearInterval(countdownInterval);
                                isLoginLocked = false;
                                loginAttempts = 0;
                                $('#attemptsCount').text(loginAttempts);
                                $('#countdown').addClass('d-none');
                                showNotification('Login telah dibuka kembali. Silakan coba lagi.', 'info');
                            }
                        }, 1000);
                    }
                    
                    showNotification('Password salah. Silakan coba lagi.', 'error');
                }
            });
            
            // Event listener untuk logout
            $('#logoutBtn').on('click', function() {
                $('#appContainer').addClass('d-none');
                $('#fabBtn').addClass('d-none');
                $('#loginContainer').removeClass('d-none');
                $('#password').val('');
                showNotification('Anda telah logout', 'info');
            });
            
            // Event listener untuk menu navigasi
            $('.nav-link[data-section]').on('click', function() {
                const targetSection = $(this).data('section');
                
                // Update active menu
                $('.nav-link').removeClass('active');
                $(this).addClass('active');
                
                // Tampilkan section yang sesuai
                $('.content-section').addClass('d-none');
                $(`#${targetSection}Section`).removeClass('d-none');
                
                // Scroll ke atas
                window.scrollTo(0, 0);
            });
            
            // Event listener untuk form input surat
            $('#mailForm').on('submit', function(e) {
                e.preventDefault();
                
                // Validasi form
                if (!this.checkValidity()) {
                    this.reportValidity();
                    return;
                }
                
                const id = $('#editId').val() || Date.now().toString();
                const mail = {
                    id: id,
                    type: $('#mailType').val(),
                    number: $('#mailNumber').val(),
                    sender: $('#mailSender').val(),
                    receiver: $('#mailReceiver').val(),
                    date: $('#mailDate').val(),
                    actionDate: $('#mailActionDate').val(),
                    status: $('#mailStatus').val(),
                    validator: $('#mailValidator').val(),
                    subject: $('#mailSubject').val(),
                    description: $('#mailDescription').val(),
                    link: $('#mailLink').val(),
                    validationCode: $('#validationCode').val(),
                    timestamp: new Date().toISOString()
                };
                
                if ($('#editId').val()) {
                    // Edit surat yang sudah ada
                    const index = mailData.findIndex(m => m.id === id);
                    if (index !== -1) {
                        mailData[index] = mail;
                        showNotification('Surat berhasil diperbarui', 'success');
                    }
                } else {
                    // Tambah surat baru
                    mailData.unshift(mail);
                    showNotification('Surat berhasil ditambahkan', 'success');
                }
                
                // Simpan dan perbarui UI
                saveData();
                renderMailTable();
                updateDashboardStats();
                updateRecentActivities();
                
                // Reset form
                $('#mailForm')[0].reset();
                $('#editId').val('');
                $('#validationCode').val('');
                
                // Set tanggal default
                const today = new Date().toISOString().split('T')[0];
                $('#mailDate').val(today);
                $('#mailActionDate').val(today);
            });
            
            // Event listener untuk reset form
            $('#resetBtn').on('click', function() {
                $('#mailForm')[0].reset();
                $('#editId').val('');
                $('#validationCode').val('');
                
                // Set tanggal default
                const today = new Date().toISOString().split('T')[0];
                $('#mailDate').val(today);
                $('#mailActionDate').val(today);
                
                showNotification('Form telah direset', 'info');
            });
            
            // Event listener untuk generate kode validasi
            $('#generateCodeBtn').on('click', function() {
                $('#validationCode').val(generateValidationCode());
            });
            
            // Event listener untuk perubahan jenis surat
            $('#mailType').on('change', function() {
                updateFormLabels();
            });
            
            // Event listener untuk filter dan pencarian
            $('#filterType, #filterStatus, #searchInput').on('change keyup', function() {
                currentPage = 1;
                renderMailTable();
            });
            
            // Event listener untuk tombol ekspor
            $('#exportBtn').on('click', function() {
                // Tampilkan pilihan format ekspor
                const exportModal = `
                    <div class="modal fade" id="exportModal" tabindex="-1">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title">Ekspor Data</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                </div>
                                <div class="modal-body">
                                    <p>Pilih format ekspor:</p>
                                    <div class="d-grid gap-2">
                                        <button class="btn btn-success export-format-btn" data-format="excel">
                                            <i class="fas fa-file-excel me-2"></i>Excel (.xlsx)
                                        </button>
                                        <button class="btn btn-danger export-format-btn" data-format="pdf">
                                            <i class="fas fa-file-pdf me-2"></i>PDF (.pdf)
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                // Tambahkan modal ke DOM jika belum ada
                if (!$('#exportModal').length) {
                    $('body').append(exportModal);
                }
                
                // Tampilkan modal
                $('#exportModal').modal('show');
                
                // Event listener untuk tombol format ekspor
                $('.export-format-btn').off('click').on('click', function() {
                    const format = $(this).data('format');
                    exportData(format);
                    $('#exportModal').modal('hide');
                });
            });
            
            // Event listener untuk tombol backup
            $('#backupBtn').on('click', function() {
                backupData();
            });
            
            // Event listener untuk tombol restore
            $('#restoreBtn').on('click', function() {
                $('#restoreFileInput').click();
            });
            
            $('#restoreFileInput').on('change', function(e) {
                if (e.target.files.length > 0) {
                    restoreData(e.target.files[0]);
                }
            });
            
            // Event listener untuk tombol reset data
            $('#resetDataBtn').on('click', function() {
                // Modal akan ditampilkan otomatis melalui data-bs-target dan data-bs-toggle
            });
            
            // Event listener untuk konfirmasi reset data
            $('#confirmResetBtn').on('click', function() {
                const confirmationText = $('#resetConfirmationInput').val();
                const password = $('#resetPassword').val();
                
                if (confirmationText !== 'RESET SEMUA DATA') {
                    showNotification('Teks konfirmasi tidak sesuai', 'error');
                    return;
                }
                
                if (!validatePassword(password)) {
                    showNotification('Password salah', 'error');
                    return;
                }
                
                // Buat backup otomatis jika dicentang
                if ($('#resetBackupCheck').is(':checked')) {
                    backupData();
                }
                
                // Reset data
                resetData();
                
                // Tutup modal
                $('#resetDataModal').modal('hide');
                
                // Reset form konfirmasi
                $('#resetConfirmationInput').val('');
                $('#resetPassword').val('');
                $('#resetBackupCheck').prop('checked', false);
            });
            
            // Event listener untuk validasi input reset data
            $('#resetConfirmationInput, #resetPassword').on('input', function() {
                const confirmationText = $('#resetConfirmationInput').val();
                const password = $('#resetPassword').val();
                
                $('#confirmResetBtn').prop('disabled', 
                    confirmationText !== 'RESET SEMUA DATA' || !password
                );
            });
            
            // Event listener untuk konfirmasi hapus
            $('#confirmDeleteBtn').on('click', function() {
                const id = $('#deleteConfirmModal').data('id');
                const password = $('#deletePassword').val();
                
                if (!validatePassword(password)) {
                    showNotification('Password salah', 'error');
                    return;
                }
                
                deleteMail(id);
                $('#deleteConfirmModal').modal('hide');
            });
            
            // Event listener untuk tombol refresh aktivitas
            $('#refreshActivitiesBtn').on('click', function() {
                updateRecentActivities();
                showNotification('Aktivitas terbaru telah diperbarui', 'success');
            });
            
            // Event listener untuk FAB (Floating Action Button)
            $('#fabBtn').on('click', function() {
                // Scroll ke form input surat
                $('html, body').animate({
                    scrollTop: $('#mailForm').offset().top - 20
                }, 500);
                
                // Buka section input jika belum terbuka
                if ($('#inputSection').hasClass('d-none')) {
                    $('.nav-link').removeClass('active');
                    $('.nav-link[data-section="input"]').addClass('active');
                    
                    $('.content-section').addClass('d-none');
                    $('#inputSection').removeClass('d-none');
                }
            });
            
            // Event listener untuk karakter counter
            $('#mailSubject, #mailDescription').on('input', function() {
                const length = $(this).val().length;
                const maxLength = $(this).attr('maxlength');
                const counter = $(this).attr('id') === 'mailSubject' ? 
                    $('#subjectCharCount') : $('#descriptionCharCount');
                
                counter.text(`${length}/${maxLength} karakter`);
                
                if (length > maxLength * 0.8) {
                    counter.addClass('warning');
                } else {
                    counter.removeClass('warning');
                }
            });
            
            // Event listener untuk test tautan
            $('#testLinkBtn').on('click', function() {
                const link = $('#mailLink').val();
                if (link) {
                    window.open(link, '_blank');
                } else {
                    showNotification('Masukkan tautan terlebih dahulu', 'info');
                }
            });
            
            // Event listener untuk lupa password
            $('#forgotPasswordLink').on('click', function(e) {
                e.preventDefault();
                $('#forgotPasswordModal').modal('show');
            });
            
            // Event listener untuk form pengaturan akun
            $('#accountForm').on('submit', function(e) {
                e.preventDefault();
                
                // Validasi form
                if (!this.checkValidity()) {
                    this.reportValidity();
                    return;
                }
                
                const newPassword = $('#newPassword').val();
                const confirmPassword = $('#confirmPassword').val();
                const currentPassword = $('#currentPassword').val();
                
                // Validasi password saat ini
                if (!validatePassword(currentPassword)) {
                    showNotification('Password saat ini salah', 'error');
                    return;
                }
                
                // Validasi konfirmasi password baru
                if (newPassword && newPassword !== confirmPassword) {
                    showNotification('Konfirmasi password baru tidak sesuai', 'error');
                    return;
                }
                
                // Validasi kekuatan password baru (jika diisi)
                if (newPassword && newPassword.length < 8) {
                    showNotification('Password baru minimal 8 karakter', 'error');
                    return;
                }
                
                // Simpan nama instansi
                const institutionName = $('#institutionName').val();
                localStorage.setItem('institutionName', institutionName);
                
                // Update tampilan nama instansi
                $('.app-subtitle').text(institutionName);
                $('#userDisplayName').text(institutionName);
                
                // Reset form password
                $('#newPassword').val('');
                $('#confirmPassword').val('');
                $('#currentPassword').val('');
                
                showNotification('Pengaturan akun berhasil diperbarui', 'success');
            });
            
            // Event listener untuk strength password
            $('#newPassword').on('input', function() {
                const password = $(this).val();
                const strengthBar = $('#passwordStrength');
                
                if (password.length === 0) {
                    strengthBar.removeClass('weak medium strong').width('0%');
                    return;
                }
                
                // Hitung kekuatan password (sederhana)
                let strength = 0;
                if (password.length >= 8) strength++;
                if (/[A-Z]/.test(password)) strength++;
                if (/[0-9]/.test(password)) strength++;
                if (/[^A-Za-z0-9]/.test(password)) strength++;
                
                if (strength < 2) {
                    strengthBar.removeClass('medium strong').addClass('weak').width('33%');
                } else if (strength < 4) {
                    strengthBar.removeClass('weak strong').addClass('medium').width('66%');
                } else {
                    strengthBar.removeClass('weak medium').addClass('strong').width('100%');
                }
            });
            
            // Event listener untuk tombol bantuan
            $('#helpBtn').on('click', function() {
                // Buka section tentang
                $('.nav-link').removeClass('active');
                $('.nav-link[data-section="about"]').addClass('active');
                
                $('.content-section').addClass('d-none');
                $('#aboutSection').removeClass('d-none');
                
                // Scroll ke atas
                window.scrollTo(0, 0);
            });
            
            // Event listener untuk tombol undo
            $('#undoBtn').on('click', function() {
                if (Object.keys(originalFormValues).length === 0) {
                    showNotification('Tidak ada perubahan untuk dikembalikan', 'info');
                    return;
                }
                
                // Kembalikan nilai asli
                $('#editId').val(originalFormValues.id || '');
                $('#mailType').val(originalFormValues.type || '');
                $('#mailNumber').val(originalFormValues.number || '');
                $('#mailSender').val(originalFormValues.sender || '');
                $('#mailReceiver').val(originalFormValues.receiver || '');
                $('#mailDate').val(originalFormValues.date || '');
                $('#mailActionDate').val(originalFormValues.actionDate || '');
                $('#mailStatus').val(originalFormValues.status || '');
                $('#mailValidator').val(originalFormValues.validator || '');
                $('#mailSubject').val(originalFormValues.subject || '');
                $('#mailDescription').val(originalFormValues.description || '');
                $('#mailLink').val(originalFormValues.link || '');
                $('#validationCode').val(originalFormValues.validationCode || '');
                
                showNotification('Perubahan telah dikembalikan ke nilai sebelumnya', 'info');
            });
            
            // Muat nama instansi dari localStorage jika ada
            const savedInstitutionName = localStorage.getItem('institutionName');
            if (savedInstitutionName) {
                $('#institutionName').val(savedInstitutionName);
                $('.app-subtitle').text(savedInstitutionName);
                $('#userDisplayName').text(savedInstitutionName);
            }
        });
    </script>
</body>
</html>
