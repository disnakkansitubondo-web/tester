<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APLIKASI BARJAS - SISTEM BANTUAN</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary-color: #0d47a1;
            --secondary-color: #00695c;
            --accent-color: #ff8f00;
            --light-blue: #e3f2fd;
            --dark-blue: #082e5c;
            --gradient-primary: linear-gradient(135deg, var(--primary-color), var(--dark-blue));
            --gradient-secondary: linear-gradient(135deg, var(--secondary-color), #004d40);
            --gradient-accent: linear-gradient(135deg, var(--accent-color), #e65100);
            --shadow-sm: 0 2px 8px rgba(0,0,0,0.08);
            --shadow-md: 0 4px 16px rgba(0,0,0,0.12);
            --shadow-lg: 0 8px 28px rgba(0,0,0,0.15);
            --login-gradient: linear-gradient(135deg, #0d47a1, #00695c, #ff8f00);
        }
        
        body {
            background: linear-gradient(135deg, #f5f9ff 0%, #e8f5e9 100%);
            font-family: 'Poppins', 'Segoe UI', sans-serif;
            min-height: 100vh;
            padding: 10px 0;
            overflow-x: hidden;
        }
        
        .app-container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            box-shadow: var(--shadow-lg);
            border-radius: 12px;
            overflow: hidden;
            position: relative;
            z-index: 10;
        }
        
        .app-header {
            background: var(--gradient-primary);
            color: white;
            padding: 20px 15px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .app-header::before {
            content: "";
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.15) 0%, transparent 70%);
            pointer-events: none;
        }
        
        .app-logo {
            font-size: 2.5rem;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }
        
        .app-title {
            font-size: 1.8rem;
            font-weight: 800;
            margin: 0;
            position: relative;
            z-index: 1;
            text-shadow: 1px 1px 4px rgba(0,0,0,0.3);
        }
        
        .app-subtitle {
            font-size: 1rem;
            opacity: 0.95;
            position: relative;
            z-index: 1;
            font-weight: 300;
            letter-spacing: 0.5px;
            margin-bottom: 5px;
        }
        
        .nav-pills .nav-link {
            border-radius: 8px;
            margin-bottom: 8px;
            padding: 12px 15px;
            font-weight: 500;
            color: #444;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            font-size: 0.9rem;
        }
        
        .nav-pills .nav-link:hover {
            background-color: #f0f7ff;
            transform: translateX(3px);
        }
        
        .nav-pills .nav-link.active {
            background: var(--gradient-primary);
            font-weight: 600;
            box-shadow: var(--shadow-md);
            transform: translateX(3px);
            color: white;
        }
        
        .section-title {
            border-left: 4px solid var(--primary-color);
            padding-left: 12px;
            margin: 20px 0;
            font-weight: 700;
            color: var(--dark-blue);
            font-size: 1.4rem;
            position: relative;
        }
        
        .section-title::after {
            content: "";
            position: absolute;
            bottom: -5px;
            left: 12px;
            width: 40px;
            height: 2px;
            background: var(--gradient-primary);
            border-radius: 2px;
        }
        
        .btn-primary {
            background: var(--gradient-primary);
            border: none;
            padding: 10px 20px;
            font-weight: 600;
            box-shadow: var(--shadow-md);
            border-radius: 8px;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .btn-success {
            background: var(--gradient-secondary);
            border: none;
            padding: 10px 20px;
            font-weight: 600;
            box-shadow: var(--shadow-md);
            border-radius: 8px;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .btn-warning {
            background: var(--gradient-accent);
            border: none;
            padding: 10px 20px;
            font-weight: 600;
            box-shadow: var(--shadow-md);
            border-radius: 8px;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .btn-warning:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .form-label {
            font-weight: 600;
            color: #444;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            font-size: 0.9rem;
        }
        
        .form-label i {
            margin-right: 6px;
            color: var(--primary-color);
        }
        
        .form-control, .form-select {
            border-radius: 8px;
            padding: 12px 15px;
            border: 1px solid #ddd;
            transition: all 0.3s;
            box-shadow: var(--shadow-sm);
            font-size: 0.9rem;
        }
        
        .form-control:focus, .form-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(13, 71, 161, 0.2);
            transform: translateY(-2px);
        }
        
        .copyright {
            text-align: center;
            padding: 20px;
            background-color: var(--light-blue);
            color: var(--dark-blue);
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .data-table {
            font-size: 0.85rem;
            border-collapse: separate;
            border-spacing: 0;
            box-shadow: var(--shadow-sm);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .data-table th {
            background: var(--gradient-primary);
            color: white;
            font-weight: 600;
            padding: 12px 10px;
            text-align: center;
            position: relative;
            font-size: 0.85rem;
        }
        
        .data-table th::after {
            content: "";
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 1px;
            background: rgba(255,255,255,0.3);
        }
        
        .data-table td {
            padding: 10px 8px;
            vertical-align: middle;
            border-bottom: 1px solid #eee;
            font-size: 0.85rem;
        }
        
        .data-table tr:nth-child(even) {
            background-color: #f9fbff;
        }
        
        .data-table tr:hover {
            background-color: #edf5ff;
        }
        
        .feature-icon {
            font-size: 1.1rem;
            margin-right: 8px;
            width: 24px;
            text-align: center;
        }
        
        .card {
            border-radius: 10px;
            border: none;
            box-shadow: var(--shadow-md);
            transition: all 0.3s ease;
            overflow: hidden;
            margin-bottom: 15px;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        
        .card-header {
            border-radius: 10px 10px 0 0 !important;
            font-weight: 600;
            padding: 15px 20px;
            background: var(--gradient-primary);
            color: white;
            font-size: 0.95rem;
        }
        
        .stats-box {
            text-align: center;
            padding: 20px 15px;
            border-radius: 10px;
            background: white;
            box-shadow: var(--shadow-md);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
            margin-bottom: 15px;
        }
        
        .stats-box::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--gradient-primary);
            border-radius: 2px;
        }
        
        .stats-box:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }
        
        .stats-number {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--primary-color);
            margin: 10px 0;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        
        .stats-label {
            font-size: 0.9rem;
            color: #666;
            font-weight: 500;
        }
        
        .notification-toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1050;
            min-width: 280px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: var(--shadow-lg);
            max-width: calc(100vw - 40px);
        }
        
        .input-error {
            border-color: #dc3545;
            box-shadow: 0 0 0 3px rgba(220, 53, 69, 0.2);
        }
        
        .error-message {
            color: #dc3545;
            font-size: 0.8rem;
            margin-top: 5px;
            display: none;
            font-weight: 500;
        }
        
        .watermark {
            position: absolute;
            bottom: 10px;
            right: 15px;
            opacity: 0.8;
            font-size: 0.8rem;
            color: white;
            font-weight: 300;
        }
        
        .control-panel {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            box-shadow: var(--shadow-sm);
        }
        
        .control-title {
            font-size: 1rem;
            color: var(--primary-color);
            font-weight: 600;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--light-blue);
        }
        
        .floating-action-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--gradient-primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .floating-action-btn:hover {
            transform: scale(1.1) rotate(90deg);
        }
        
        .filter-section {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-sm);
        }
        
        .badge-custom {
            background: var(--gradient-primary);
            color: white;
            padding: 6px 12px;
            border-radius: 16px;
            font-weight: 600;
            font-size: 0.8rem;
        }
        
        .mobile-menu-btn {
            display: none;
            position: fixed;
            top: 15px;
            left: 15px;
            z-index: 1050;
            background: var(--gradient-primary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            box-shadow: var(--shadow-lg);
        }
        
        .sidebar-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1040;
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-fadeIn {
            animation: fadeIn 0.5s ease forwards;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 8px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 8px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--dark-blue);
        }
        
        /* Responsive styles */
        @media (max-width: 991.98px) {
            .col-md-3.col-lg-2 {
                position: fixed;
                left: -300px;
                top: 0;
                bottom: 0;
                z-index: 1050;
                width: 280px;
                transition: left 0.3s ease;
                overflow-y: auto;
                padding-top: 60px;
            }
            
            .col-md-3.col-lg-2.mobile-show {
                left: 0;
            }
            
            .col-md-9.col-lg-10 {
                width: 100%;
                flex: 0 0 100%;
                max-width: 100%;
            }
            
            .mobile-menu-btn {
                display: flex;
                align-items: center;
                justify-content: center;
            }
            
            .sidebar-overlay.mobile-show {
                display: block;
            }
        }
        
        /* Print Styles - IMPROVED FOR LANDSCAPE */
        @media print {
            @page {
                size: landscape;
                margin: 0.5cm;
            }
            
            body * {
                visibility: hidden;
            }
            
            .app-container, .app-container * {
                visibility: visible;
            }
            
            .app-container {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                box-shadow: none;
            }
            
            .nav-pills, .mobile-menu-btn, .sidebar-overlay, .floating-action-btn,
            .btn-group, .filter-section, .toast {
                display: none !important;
            }
            
            .col-md-3.col-lg-2.p-4.bg-light {
                display: none !important;
            }
            
            .col-md-9.col-lg-10.p-5 {
                width: 100%;
                flex: 0 0 100%;
                max-width: 100%;
                padding: 0 !important;
            }
            
            .copyright {
                display: none;
            }
            
            .data-table {
                font-size: 10px;
                width: 100% !important;
            }
            
            .data-table th, .data-table td {
                padding: 4px 2px;
            }
            
            /* Sembunyikan kolom aksi dan link Google Drive saat mencetak */
            .data-table th:last-child,
            .data-table td:last-child {
                display: none !important;
            }
            
            /* Judul untuk laporan cetak */
            .print-header {
                display: block !important;
                text-align: center;
                margin-bottom: 15px;
            }
            
            .print-title {
                font-size: 18px;
                font-weight: bold;
                margin-bottom: 5px;
            }
            
            .print-subtitle {
                font-size: 14px;
                margin-bottom: 10px;
            }
            
            .print-date {
                font-size: 12px;
                text-align: right;
                margin-bottom: 10px;
            }
        }

        /* WhatsApp link style */
        .whatsapp-link {
            color: #25D366;
            text-decoration: none;
        }
        
        .whatsapp-link:hover {
            text-decoration: underline;
        }
        
        /* View Link Button */
        .btn-view {
            background: linear-gradient(135deg, #17a2b8, #138496);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
        }
        
        .btn-view:hover {
            background: linear-gradient(135deg, #138496, #117a8b);
            color: white;
        }
        
        /* Undo Button */
        .btn-undo {
            background: linear-gradient(135deg, #6c757d, #5a6268);
            color: white;
            border: none;
        }
        
        .btn-undo:hover {
            background: linear-gradient(135deg, #5a6268, #4e555b);
            color: white;
        }
        
        /* WhatsApp number link in table */
        .whatsapp-number {
            color: #25D366;
            cursor: pointer;
            text-decoration: underline;
        }
        
        /* Welcome Modal Styles */
        .welcome-modal .modal-content {
            border-radius: 15px;
            overflow: hidden;
            border: none;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .welcome-header {
            background: var(--gradient-primary);
            color: white;
            text-align: center;
            padding: 25px;
        }
        
        .welcome-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            color: white;
        }
        
        .welcome-body {
            padding: 25px;
            text-align: center;
        }
        
        .welcome-footer {
            background: #f8f9fa;
            padding: 15px;
            text-align: center;
            border-top: 1px solid #eee;
        }
        
        .countdown-timer {
            font-size: 0.9rem;
            color: #6c757d;
            margin-top: 10px;
        }
        
        /* Button untuk cetak per data */
        .btn-print-individual {
            background: linear-gradient(135deg, #6f42c1, #5a2d95);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
        }
        
        .btn-print-individual:hover {
            background: linear-gradient(135deg, #5a2d95, #4a2479);
            color: white;
        }
        
        /* Developer Info Styles */
        .developer-info {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            box-shadow: var(--shadow-sm);
        }
        
        .developer-info h6 {
            color: var(--primary-color);
            font-weight: 600;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 1px solid #ddd;
        }
        
        .developer-contact p {
            margin-bottom: 8px;
            font-size: 0.85rem;
        }
        
        .developer-contact a {
            color: var(--primary-color);
            text-decoration: none;
            transition: all 0.3s;
        }
        
        .developer-contact a:hover {
            color: var(--dark-blue);
            text-decoration: underline;
        }
        
        /* Welcome Splash Screen */
        .welcome-splash {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient-primary);
            color: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }
        
        .welcome-splash-content {
            text-align: center;
            max-width: 600px;
            padding: 30px;
        }
        
        .welcome-splash-logo {
            font-size: 4rem;
            margin-bottom: 20px;
        }
        
        .welcome-splash-title {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 15px;
        }
        
        .welcome-splash-message {
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 25px;
        }
        
        .welcome-splash-countdown {
            font-size: 1rem;
            margin-top: 20px;
        }
        
        .welcome-splash-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .welcome-splash-close:hover {
            background: rgba(255,255,255,0.3);
            transform: rotate(90deg);
        }
        
        /* Loading spinner */
        .spinner-border-sm {
            width: 1rem;
            height: 1rem;
        }

        /* Login Modal Styles */
        .login-modal .modal-content {
            border-radius: 15px;
            overflow: hidden;
            border: none;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .login-header {
            background: var(--login-gradient);
            color: white;
            text-align: center;
            padding: 25px 20px;
            position: relative;
        }

        .login-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            color: white;
        }

        .login-title {
            font-size: 1.8rem;
            font-weight: 700;
            margin: 0;
        }

        .login-subtitle {
            font-size: 1rem;
            opacity: 0.9;
            margin: 5px 0 0;
        }

        .login-body {
            padding: 25px;
            position: relative;
            z-index: 1;
        }

        .login-form-group {
            margin-bottom: 20px;
        }

        .login-form-label {
            font-weight: 600;
            color: var(--dark-blue);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
        }

        .login-form-label i {
            margin-right: 10px;
            color: var(--dark-blue);
        }

        .login-form-control {
            border-radius: 8px;
            padding: 12px 15px;
            border: 2px solid #ddd;
            transition: all 0.3s;
        }

        .login-form-control:focus {
            border-color: var(--dark-blue);
            box-shadow: 0 0 0 3px rgba(13, 71, 161, 0.2);
        }

        .login-input-group-text {
            background: var(--light-blue);
            border: 2px solid #ddd;
            border-left: none;
        }

        .btn-login {
            background: var(--gradient-secondary);
            color: white;
            border: none;
            padding: 12px;
            font-weight: 600;
            border-radius: 8px;
            width: 100%;
            transition: all 0.3s;
            margin-top: 10px;
        }

        .btn-login:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 105, 92, 0.4);
        }

        .btn-login:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .login-security-notice {
            text-align: center;
            margin-top: 20px;
            font-size: 0.85rem;
            color: #666;
        }

        .login-attempts-count {
            text-align: center;
            font-size: 0.9rem;
            color: #ff8f00;
            font-weight: 500;
            margin-top: 5px;
        }

        .login-blocked-message {
            text-align: center;
            background: rgba(220, 53, 69, 0.1);
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            color: #dc3545;
            font-weight: 500;
        }

        .login-countdown {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--dark-blue);
        }

        .login-developer-info {
            background: var(--light-blue);
            border-radius: 10px;
            padding: 20px;
            margin-top: 25px;
            text-align: center;
        }

        .login-developer-logo {
            max-width: 180px;
            margin-bottom: 15px;
            border-radius: 8px;
        }

        .login-developer-contact a {
            color: var(--dark-blue);
            text-decoration: none;
            transition: all 0.3s;
            display: inline-block;
            margin: 5px 0;
        }

        .login-developer-contact a:hover {
            color: var(--primary-color);
            text-decoration: underline;
            transform: translateY(-2px);
        }

        .login-copyright {
            text-align: center;
            margin-top: 20px;
            color: #666;
            font-size: 0.9rem;
            opacity: 0.9;
        }

        /* Animations */
        @keyframes login-shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-10px); }
            20%, 40%, 60%, 80% { transform: translateX(10px); }
        }

        .login-shake {
            animation: login-shake 0.6s cubic-bezier(.36,.07,.19,.97) both;
        }

        /* Login particle background */
        #login-particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1040; /* Higher than modal backdrop */
            display: none;
        }

        /* Link Google Drive dalam tabel */
        .drive-link {
            color: #0d47a1;
            text-decoration: none;
            cursor: pointer;
        }

        .drive-link:hover {
            text-decoration: underline;
        }

        /* Modal untuk menambah link */
        .link-modal .modal-dialog {
            max-width: 600px;
        }
        
        /* App content when not authenticated */
        .app-content-unauthenticated {
            display: none;
        }

        /* Search box for desa dropdown */
        .dropdown-search-container {
            position: relative;
        }

        .dropdown-search {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 1000;
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 8px;
            display: none;
        }

        .dropdown-search input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        /* Kode Validasi Styles */
        .kode-validasi-container {
            display: flex;
            align-items: center;
        }
        
        .kode-validasi-input {
            flex: 1;
            margin-right: 10px;
        }
        
        .btn-generate-kode {
            white-space: nowrap;
        }
    </style>
</head>
<body>
    <!-- Login Modal -->
    <div class="modal fade login-modal" id="loginModal" tabindex="-1" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="login-header">
                    <div class="login-icon">
                        <i class="fas fa-lock"></i>
                    </div>
                    <h2 class="login-title">AUTHENTICATION REQUIRED</h2>
                    <p class="login-subtitle">Masukkan Kode Keamanan untuk Mengakses Aplikasi</p>
                </div>
                <div class="login-body">
                    <form id="loginForm">
                        <div class="mb-3 login-form-group">
                            <label class="form-label login-form-label">
                                <i class="fas fa-key"></i> Kode Keamanan
                            </label>
                            <div class="input-group">
                                <input type="password" class="form-control login-form-control" id="securityCode" placeholder="Masukkan kode akses aplikasi">
                                <button class="btn btn-outline-secondary toggle-password" type="button">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                            <div class="form-text text-danger login-attempts-count" id="attemptsCount"></div>
                        </div>
                        <button type="submit" class="btn btn-login" id="loginButton">
                            <span class="login-button-text">Masuk ke Aplikasi</span>
                            <span class="spinner-border spinner-border-sm d-none" id="loginSpinner"></span>
                        </button>
                    </form>
                    
                    <div class="login-blocked-message d-none" id="blockedMessage">
                        <i class="fas fa-ban me-2"></i>
                        <span id="blockedText">Terlalu banyak percobaan gagal. Silakan coba lagi dalam </span>
                        <span class="login-countdown" id="countdown">30</span> detik.
                    </div>
                    
                    <div class="login-security-notice">
                        <i class="fas fa-info-circle me-2"></i>
                        Hubungi Administrator untuk mendapatkan kode akses
                    </div>
                    
                    <div class="login-developer-info">
                        <h5 class="mb-3">Developer Information</h5>
                        <div class="login-developer-contact">
                            <p><i class="fab fa-whatsapp me-2"></i> <a href="https://wa.me/6285647709114" target="_blank">+62 856-4770-9114</a></p>
                            <p><i class="fas fa-envelope me-2"></i> <a href="mailto:admin@anekamarket.my.id">admin@anekamarket.my.id</a></p>
                        </div>
                    </div>
                    
                    <div class="login-copyright">
                        &copy; 2025 Lentera karya Situbondo
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Login particle background -->
    <div id="login-particles"></div>
    
    <!-- Welcome Splash Screen -->
    <div class="welcome-splash" id="welcomeSplash">
        <button class="welcome-splash-close" id="closeSplash">
            <i class="fas fa-times"></i>
        </button>
        <div class="welcome-splash-content">
            <div class="welcome-splash-logo">
                <i class="fas fa-hands-helping"></i>
            </div>
            <h1 class="welcome-splash-title">SISTEM BANTUAN BARJAS</h1>
            <p class="welcome-splash-message">
                Aplikasi Sistem Bantuan BARJAS merupakan platform terpadu yang dirancang untuk mentransformasi pendataan, penyaluran, 
                dan monitoring program bantuan pemerintah. Aplikasi ini kami ciptakan untuk mendorong efisiensi, akurasi, 
                dan transparansi dalam pengelolaan bantuan, guna mempercepat penyerapan dan meningkatkan akuntabilitas.
            </p>
            <div class="welcome-splash-countdown" id="splashCountdown">
                Membuka aplikasi dalam <span id="countdownTimer">5</span> detik...
            </div>
        </div>
    </div>
    
    <!-- Main Application Content (initially hidden) -->
    <div class="app-content-unauthenticated" id="appContent">
        <!-- Mobile Menu Button -->
        <button class="mobile-menu-btn" id="mobileMenuBtn">
            <i class="fas fa-bars"></i>
        </button>
        
        <!-- Sidebar Overlay -->
        <div class="sidebar-overlay" id="sidebarOverlay"></div>
        
        <div class="app-container animate-fadeIn">
            <div class="app-header">
                <div class="app-logo">
                    <i class="fas fa-hands-helping"></i>
                </div>
                <h1 class="app-title">BARJAS</h1>
                <p class="app-subtitle">Sistem Bantuan Terpadu</p>
                <p class="app-subtitle" id="institutionName">Dinas Peternakan dan Perikanan Kabupaten Situbondo</p>
                <div class="watermark">v2.5.0</div>
            </div>
            
            <div class="row g-0">
                <!-- Sidebar Navigation -->
                <div class="col-md-3 col-lg-2 p-4 bg-light" id="sidebarMenu">
                    <ul class="nav nav-pills flex-column">
                        <li class="nav-item">
                            <a class="nav-link active" href="#" data-bs-target="dashboard">
                                <i class="fas fa-tachometer-alt feature-icon"></i> Dashboard
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-bs-target="inputData">
                                <i class="fas fa-pencil-alt feature-icon"></i> Input Data
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-bs-target="viewData">
                                <i class="fas fa-table feature-icon"></i> Lihat Data
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-bs-target="statistics">
                                <i class="fas fa-chart-pie feature-icon"></i> Statistik
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-bs-target="settings">
                                <i class="fas fa-cog feature-icon"></i> Pengaturan
                            </a>
                        </li>
                        <li class="nav-item mt-4">
                            <a class="nav-link text-danger" href="#" id="logoutBtn">
                                <i class="fas fa-sign-out-alt feature-icon"></i> Keluar
                            </a>
                        </li>
                    </ul>
                    
                    <div class="developer-info">
                        <h6>Developer</h6>
                        <div class="developer-contact">
                            <p><i class="fab fa-whatsapp"></i> <a href="https://wa.me/6285647709114" target="_blank">+62 856-4770-9114</a></p>
                            <p><i class="fas fa-envelope"></i> <a href="mailto:admin@anekamarket.my.id">admin@anekamarket.my.id</a></p>
                        </div>
                    </div>
                </div>
                
                <!-- Main Content Area -->
                <div class="col-md-9 col-lg-10 p-5">
                    <!-- Dashboard Section -->
                    <div class="content-section" id="dashboard">
                        <h3 class="section-title">Dashboard</h3>
                        
                        <div class="row">
                            <div class="col-md-4">
                                <div class="stats-box">
                                    <i class="fas fa-users feature-icon text-primary"></i>
                                    <div class="stats-number" id="totalData">0</div>
                                    <div class="stats-label">Total Penerima Bantuan</div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="stats-box">
                                    <i class="fas fa-check-circle feature-icon text-success"></i>
                                    <div class="stats-number" id="verifiedData">0</div>
                                    <div class="stats-label">Data Tervalidasi</div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="stats-box">
                                    <i class="fas fa-clock feature-icon text-warning"></i>
                                    <div class="stats-number" id="pendingData">0</div>
                                    <div class="stats-label">Data Pending</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mt-4">
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-header">
                                        <i class="fas fa-chart-bar me-2"></i> Statistik Bantuan per Kecamatan
                                    </div>
                                    <div class="card-body">
                                        <canvas id="kecamatanChart" height="250"></canvas>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-header">
                                        <i class="fas fa-chart-pie me-2"></i> Distribusi Jenis Bantuan
                                    </div>
                                    <div class="card-body">
                                        <canvas id="jenisBantuanChart" height="250"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mt-4">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-header">
                                        <i class="fas fa-history me-2"></i> Data Terbaru
                                    </div>
                                    <div class="card-body">
                                        <div class="table-responsive">
                                            <table class="table table-hover data-table" id="recentDataTable">
                                                <thead>
                                                    <tr>
                                                        <th>No</th>
                                                        <th>Nama Penerima</th>
                                                        <th>Alamat</th>
                                                        <th>Jenis Bantuan</th>
                                                        <th>Tanggal</th>
                                                        <th>Status</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <!-- Data akan diisi oleh JavaScript -->
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Input Data Section -->
                    <div class="content-section d-none" id="inputData">
                        <h3 class="section-title">Input Data Bantuan</h3>
                        
                        <form id="bantuanForm">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label"><i class="fas fa-user"></i> Nama Penerima</label>
                                        <input type="text" class="form-control" id="namaPenerima" required>
                                        <div class="error-message" id="namaPenerimaError">Nama penerima harus diisi</div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label"><i class="fas fa-phone"></i> Nomor WhatsApp</label>
                                        <input type="tel" class="form-control" id="whatsapp" placeholder="Contoh: 628123456789">
                                        <div class="error-message" id="whatsappError">Format nomor WhatsApp tidak valid</div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label"><i class="fas fa-id-card"></i> NIK</label>
                                        <input type="text" class="form-control" id="nik" maxlength="16">
                                        <div class="error-message" id="nikError">NIK harus 16 digit angka</div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label"><i class="fas fa-map-marker-alt"></i> Kecamatan</label>
                                        <select class="form-select" id="kecamatan" required>
                                            <option value="">Pilih Kecamatan</option>
                                            <option value="Arjasa">Arjasa</option>
                                            <option value="Asembagus">Asembagus</option>
                                            <option value="Banyuglugur">Banyuglugur</option>
                                            <option value="Banyuputih">Banyuputih</option>
                                            <option value="Besuki">Besuki</option>
                                            <option value="Bungatan">Bungatan</option>
                                            <option value="Jangkar">Jangkar</option>
                                            <option value="Jatibanteng">Jatibanteng</option>
                                            <option value="Kapongan">Kapongan</option>
                                            <option value="Kendit">Kendit</option>
                                            <option value="Mangaran">Mangaran</option>
                                            <option value="Mlandingan">Mlandingan</option>
                                            <option value="Panarukan">Panarukan</option>
                                            <option value="Panji">Panji</option>
                                            <option value="Situbondo">Situbondo</option>
                                            <option value="Suboh">Suboh</option>
                                            <option value="Sumbermalang">Sumbermalang</option>
                                        </select>
                                        <div class="error-message" id="kecamatanError">Kecamatan harus dipilih</div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label"><i class="fas fa-map-marked-alt"></i> Desa/Kelurahan</label>
                                        <select class="form-select" id="desa" required>
                                            <option value="">Pilih Desa/Kelurahan</option>
                                            <option value="Agel">Agel</option>
                                            <option value="Alas Bayur">Alas Bayur</option>
                                            <option value="Alasmalang">Alasmalang</option>
                                            <option value="Alastengah">Alastengah</option>
                                            <option value="Arjasa">Arjasa</option>
                                            <option value="Ardirejo">Ardirejo</option>
                                            <option value="Asembagus">Asembagus</option>
                                            <option value="Awar-awar">Awar-awar</option>
                                            <option value="Awang-awang">Awang-awang</option>
                                            <option value="Baderan">Baderan</option>
                                            <option value="Balung">Balung</option>
                                            <option value="Bantal">Bantal</option>
                                            <option value="Battal">Battal</option>
                                            <option value="Bayeman">Bayeman</option>
                                            <option value="Besuki">Besuki</option>
                                            <option value="Bletok">Bletok</option>
                                            <option value="Blimbing">Blimbing</option>
                                            <option value="Bloro">Bloro</option>
                                            <option value="Buduan">Buduan</option>
                                            <option value="Bugeman">Bugeman</option>
                                            <option value="Bungatan">Bungatan</option>
                                            <option value="Campoan">Campoan</option>
                                            <option value="Cemara">Cemara</option>
                                            <option value="Curah Cottok">Curah Cottok</option>
                                            <option value="Curah Jeru">Curah Jeru</option>
                                            <option value="Curah Kalak">Curah Kalak</option>
                                            <option value="Curah Suri">Curah Suri</option>
                                            <option value="Curah Tatal">Curah Tatal</option>
                                            <option value="Dawuhan">Dawuhan</option>
                                            <option value="Demung">Demung</option>
                                            <option value="Duwet">Duwet</option>
                                            <option value="Gadingan">Gadingan</option>
                                            <option value="Gebangan">Gebangan</option>
                                            <option value="Gelung">Gelung</option>
                                            <option value="Gudang">Gudang</option>
                                            <option value="Gunung Malang">Gunung Malang</option>
                                            <option value="Gunung Putri">Gunung Putri</option>
                                            <option value="Jangkar">Jangkar</option>
                                            <option value="Jatisari">Jatisari</option>
                                            <option value="Jatibanteng">Jatibanteng</option>
                                            <option value="Jetis">Jetis</option>
                                            <option value="Juglangan">Juglangan</option>
                                            <option value="Kalianget">Kalianget</option>
                                            <option value="Kalibagor">Kalibagor</option>
                                            <option value="Kalimas">Kalimas</option>
                                            <option value="Kalirejo">Kalirejo</option>
                                            <option value="Kalisari">Kalisari</option>
                                            <option value="Kandang">Kandang</option>
                                            <option value="Kayu Putih">Kayu Putih</option>
                                            <option value="Kayumas">Kayumas</option>
                                            <option value="Kedungdowo">Kedungdowo</option>
                                            <option value="Kedunglo">Kedunglo</option>
                                            <option value="Kembangsari">Kembangsari</option>
                                            <option value="Ketah">Ketah</option>
                                            <option value="Ketowan">Ketowan</option>
                                            <option value="Kilensari">Kilensari</option>
                                            <option value="Klampokan">Klampokan</option>
                                            <option value="Klatakan">Klatakan</option>
                                            <option value="Kotakan">Kotakan</option>
                                            <option value="Kumbangsari">Kumbangsari</option>
                                            <option value="Kukusan">Kukusan</option>
                                            <option value="Lamongan">Lamongan</option>
                                            <option value="Landangan">Landangan</option>
                                            <option value="Langkap">Langkap</option>
                                            <option value="Lebeng">Lebeng</option>
                                            <option value="Lubawang">Lubawang</option>
                                            <option value="Mangaran">Mangaran</option>
                                            <option value="Mimbaan">Mimbaan</option>
                                            <option value="Mlandingan Kulon">Mlandingan Kulon</option>
                                            <option value="Mlandingan Wetan">Mlandingan Wetan</option>
                                            <option value="Mojodungkol">Mojodungkol</option>
                                            <option value="Mojosari">Mojosari</option>
                                            <option value="Olean">Olean</option>
                                            <option value="Palangan">Palangan</option>
                                            <option value="Panarukan">Panarukan</option>
                                            <option value="Panji Kidul">Panji Kidul</option>
                                            <option value="Panji Lor">Panji Lor</option>
                                            <option value="Parante">Parante</option>
                                            <option value="Pasir Putih">Pasir Putih</option>
                                            <option value="Patemon">Patemon</option>
                                            <option value="Patokan">Patokan</option>
                                            <option value="Paowan">Paowan</option>
                                            <option value="Peleyan">Peleyan</option>
                                            <option value="Pesisir">Pesisir</option>
                                            <option value="Pesanggrahan">Pesanggrahan</option>
                                            <option value="Pategalan">Pategalan</option>
                                            <option value="Patemon">Patemon</option>
                                            <option value="Plalangan">Plalangan</option>
                                            <option value="Pokaan">Pokaan</option>
                                            <option value="Rajekwesi">Rajekwesi</option>
                                            <option value="Seletreng">Seletreng</option>
                                            <option value="Selobanteng">Selobanteng</option>
                                            <option value="Selomukti">Selomukti</option>
                                            <option value="Selowogo">Selowogo</option>
                                            <option value="Semambung">Semambung</option>
                                            <option value="Semiring">Semiring</option>
                                            <option value="Sliwung">Sliwung</option>
                                            <option value="Sopet">Sopet</option>
                                            <option value="Sumber Pinang">Sumber Pinang</option>
                                            <option value="Sumberanyar">Sumberanyar</option>
                                            <option value="Sumberargo">Sumberargo</option>
                                            <option value="Sumberkolak">Sumberkolak</option>
                                            <option value="Sumberejo">Sumberejo</option>
                                            <option value="Sumbertengah">Sumbertengah</option>
                                            <option value="Sumberwaru">Sumberwaru</option>
                                            <option value="Tamankursi">Tamankursi</option>
                                            <option value="Tamansari">Tamansari</option>
                                            <option value="Taman">Taman</option>
                                            <option value="Talkandang">Talkandang</option>
                                            <option value="Tanjung Glugur">Tanjung Glugur</option>
                                            <option value="Tanjung Kamal">Tanjung Kamal</option>
                                            <option value="Tanjung Pecinan">Tanjung Pecinan</option>
                                            <option value="Tambak Ukir">Tambak Ukir</option>
                                            <option value="Telempong">Telempong</option>
                                            <option value="Tenggir">Tenggir</option>
                                            <option value="Tepos">Tepos</option>
                                            <option value="Tokelan">Tokelan</option>
                                            <option value="Tlogosari">Tlogosari</option>
                                            <option value="Trigonco">Trigonco</option>
                                            <option value="Trebungan">Trebungan</option>
                                            <option value="Widoropayung">Widoropayung</option>
                                            <option value="Wonokoyo">Wonokoyo</option>
                                            <option value="Wonorejo">Wonorejo</option>
                                            <option value="Wringinanom">Wringinanom</option>
                                        </select>
                                        <div class="error-message" id="desaError">Desa/Kelurahan harus dipilih</div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label"><i class="fas fa-home"></i> Alamat Lengkap</label>
                                        <textarea class="form-control" id="alamat" rows="2"></textarea>
                                    </div>
                                </div>
                                
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label"><i class="fas fa-gift"></i> Jenis Bantuan</label>
                                        <select class="form-select" id="jenisBantuan" required>
                                            <option value="">Pilih Jenis Bantuan</option>
                                            <option value="Bantuan Pangan">Bantuan Pangan</option>
                                            <option value="Bantuan Sandang">Bantuan Sandang</option>
                                            <option value="Bantuan Pendidikan">Bantuan Pendidikan</option>
                                            <option value="Bantuan Kesehatan">Bantuan Kesehatan</option>
                                            <option value="Bantuan UMKM">Bantuan UMKM</option>
                                            <option value="Bantuan Sosial Tunai">Bantuan Sosial Tunai</option>
                                            <option value="Bantuan Pertanian">Bantuan Pertanian</option>
                                            <option value="Bantuan Peternakan">Bantuan Peternakan</option>
                                            <option value="Bantuan Perikanan">Bantuan Perikanan</option>
                                            <option value="Bantuan Perumahan">Bantuan Perumahan</option>
                                        </select>
                                        <div class="error-message" id="jenisBantuanError">Jenis bantuan harus dipilih</div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label"><i class="fas fa-box"></i> Jumlah Bantuan</label>
                                        <input type="number" class="form-control" id="jumlahBantuan" min="1" value="1" required>
                                        <div class="error-message" id="jumlahBantuanError">Jumlah bantuan harus diisi</div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label"><i class="fas fa-calendar-alt"></i> Tanggal Penyaluran</label>
                                        <input type="date" class="form-control" id="tanggalPenyaluran" required>
                                        <div class="error-message" id="tanggalPenyaluranError">Tanggal penyaluran harus diisi</div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label"><i class="fas fa-calendar"></i> Tahun Anggaran</label>
                                        <select class="form-select" id="tahunAnggaran" required>
                                            <option value="">Pilih Tahun Anggaran</option>
                                            <!-- Opsi tahun dari 2020 sampai 2090 -->
                                            <script>
                                                for (let year = 2020; year <= 2090; year++) {
                                                    document.write(`<option value="${year}">${year}</option>`);
                                                }
                                            </script>
                                        </select>
                                        <div class="error-message" id="tahunAnggaranError">Tahun anggaran harus dipilih</div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label"><i class="fas fa-link"></i> Link Google Drive</label>
                                        <input type="url" class="form-control" id="linkDrive" placeholder="Contoh: https://drive.google.com/...">
                                        <div class="error-message" id="linkDriveError">Format URL tidak valid</div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label"><i class="fas fa-qrcode"></i> Kode Validasi</label>
                                        <div class="kode-validasi-container">
                                            <input type="text" class="form-control kode-validasi-input" id="kodeValidasi" placeholder="Kode validasi otomatis" readonly>
                                            <button type="button" class="btn btn-warning btn-generate-kode" id="generateKodeBtn">
                                                <i class="fas fa-sync-alt"></i> Generate
                                            </button>
                                        </div>
                                        <div class="form-text">Kode validasi akan digenerate otomatis</div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label"><i class="fas fa-sticky-note"></i> Keterangan</label>
                                        <textarea class="form-control" id="keterangan" rows="2"></textarea>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="row mt-3">
                                <div class="col-12">
                                    <button type="submit" class="btn btn-primary me-2">
                                        <i class="fas fa-save"></i> Simpan Data
                                    </button>
                                    <button type="reset" class="btn btn-secondary">
                                        <i class="fas fa-undo"></i> Reset Form
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>
                    
                    <!-- View Data Section -->
                    <div class="content-section d-none" id="viewData">
                        <h3 class="section-title">Lihat Data Bantuan</h3>
                        
                        <div class="filter-section">
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="mb-3">
                                        <label class="form-label"><i class="fas fa-filter"></i> Filter Kecamatan</label>
                                        <select class="form-select" id="filterKecamatan">
                                            <option value="">Semua Kecamatan</option>
                                            <!-- Opsi kecamatan akan diisi oleh JavaScript -->
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="mb-3">
                                        <label class="form-label"><i class="fas fa-filter"></i> Filter Desa</label>
                                        <select class="form-select" id="filterDesa">
                                            <option value="">Semua Desa</option>
                                            <!-- Opsi desa akan diisi oleh JavaScript -->
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="mb-3">
                                        <label class="form-label"><i class="fas fa-filter"></i> Filter Jenis Bantuan</label>
                                        <select class="form-select" id="filterJenisBantuan">
                                            <option value="">Semua Jenis</option>
                                            <!-- Opsi jenis bantuan akan diisi oleh JavaScript -->
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="mb-3">
                                        <label class="form-label"><i class="fas fa-filter"></i> Filter Tahun</label>
                                        <select class="form-select" id="filterTahun">
                                            <option value="">Semua Tahun</option>
                                            <!-- Opsi tahun akan diisi oleh JavaScript -->
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label"><i class="fas fa-search"></i> Pencarian</label>
                                        <input type="text" class="form-control" id="searchInput" placeholder="Cari nama, alamat, atau lainnya...">
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="mb-3">
                                        <label class="form-label"><i class="fas fa-calendar"></i> Tanggal Awal</label>
                                        <input type="date" class="form-control" id="filterTanggalAwal">
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="mb-3">
                                        <label class="form-label"><i class="fas fa-calendar"></i> Tanggal Akhir</label>
                                        <input type="date" class="form-control" id="filterTanggalAkhir">
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-12">
                                    <button class="btn btn-primary me-2" id="applyFilterBtn">
                                        <i class="fas fa-check"></i> Terapkan Filter
                                    </button>
                                    <button class="btn btn-secondary" id="resetFilterBtn">
                                        <i class="fas fa-redo"></i> Reset Filter
                                    </button>
                                    <div class="btn-group ms-2">
                                        <button class="btn btn-success" id="exportExcelBtn">
                                            <i class="fas fa-file-excel"></i> Export Excel
                                        </button>
                                        <button class="btn btn-danger" id="exportPdfBtn">
                                            <i class="fas fa-file-pdf"></i> Export PDF
                                        </button>
                                    </div>
                                    <button class="btn btn-warning ms-2" id="printTableBtn">
                                        <i class="fas fa-print"></i> Cetak Tabel
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="table-responsive">
                            <table class="table table-hover data-table" id="dataTable">
                                <thead>
                                    <tr>
                                        <th>No</th>
                                        <th>Nama Penerima</th>
                                        <th>WhatsApp</th>
                                        <th>NIK</th>
                                        <th>Kecamatan</th>
                                        <th>Desa</th>
                                        <th>Jenis Bantuan</th>
                                        <th>Jumlah</th>
                                        <th>Tanggal</th>
                                        <th>Tahun</th>
                                        <th>Kode Validasi</th>
                                        <th>Link Drive</th>
                                        <th>Aksi</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Data akan diisi oleh JavaScript -->
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="d-flex justify-content-between align-items-center mt-3">
                            <div class="dataTables_info" id="tableInfo">Menampilkan 0 dari 0 data</div>
                            <nav>
                                <ul class="pagination" id="pagination">
                                    <!-- Pagination akan diisi oleh JavaScript -->
                                </ul>
                            </nav>
                        </div>
                    </div>
                    
                    <!-- Statistics Section -->
                    <div class="content-section d-none" id="statistics">
                        <h3 class="section-title">Statistik Bantuan</h3>
                        
                        <div class="row">
                            <div class="col-md-8">
                                <div class="card">
                                    <div class="card-header">
                                        <i class="fas fa-chart-line me-2"></i> Trend Penyaluran Bantuan per Bulan
                                    </div>
                                    <div class="card-body">
                                        <canvas id="trendChart" height="300"></canvas>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card">
                                    <div class="card-header">
                                        <i class="fas fa-chart-bar me-2"></i> Top 5 Desa Penerima Bantuan
                                    </div>
                                    <div class="card-body">
                                        <canvas id="topDesaChart" height="300"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mt-4">
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-header">
                                        <i class="fas fa-calendar me-2"></i> Distribusi per Tahun Anggaran
                                    </div>
                                    <div class="card-body">
                                        <canvas id="tahunChart" height="250"></canvas>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-header">
                                        <i class="fas fa-map me-2"></i> Sebaran per Kecamatan
                                    </div>
                                    <div class="card-body">
                                        <canvas id="sebaranKecamatanChart" height="250"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Settings Section -->
                    <div class="content-section d-none" id="settings">
                        <h3 class="section-title">Pengaturan Aplikasi</h3>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-header">
                                        <i class="fas fa-database me-2"></i> Manajemen Data
                                    </div>
                                    <div class="card-body">
                                        <div class="control-panel">
                                            <h6 class="control-title">Backup dan Restore Data</h6>
                                            <button class="btn btn-primary mb-2 w-100" id="backupDataBtn">
                                                <i class="fas fa-download"></i> Backup Data ke JSON
                                            </button>
                                            <button class="btn btn-success mb-2 w-100" id="restoreDataBtn">
                                                <i class="fas fa-upload"></i> Restore Data dari JSON
                                            </button>
                                            <input type="file" id="restoreFileInput" class="d-none" accept=".json">
                                            
                                            <h6 class="control-title mt-4">Reset Data</h6>
                                            <button class="btn btn-danger w-100" id="resetDataBtn">
                                                <i class="fas fa-trash"></i> Hapus Semua Data
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="card mt-4">
                                    <div class="card-header">
                                        <i class="fas fa-lock me-2"></i> Keamanan
                                    </div>
                                    <div class="card-body">
                                        <div class="control-panel">
                                            <h6 class="control-title">Ubah Kode Keamanan</h6>
                                            <div class="mb-3">
                                                <label class="form-label">Kode Keamanan Saat Ini</label>
                                                <input type="password" class="form-control" id="currentSecurityCode" placeholder="Masukkan kode saat ini">
                                            </div>
                                            <div class="mb-3">
                                                <label class="form-label">Kode Keamanan Baru</label>
                                                <input type="password" class="form-control" id="newSecurityCode" placeholder="Masukkan kode baru">
                                            </div>
                                            <div class="mb-3">
                                                <label class="form-label">Konfirmasi Kode Baru</label>
                                                <input type="password" class="form-control" id="confirmSecurityCode" placeholder="Konfirmasi kode baru">
                                            </div>
                                            <button class="btn btn-primary w-100" id="changeSecurityCodeBtn">
                                                <i class="fas fa-key"></i> Ubah Kode Keamanan
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-header">
                                        <i class="fas fa-info-circle me-2"></i> Informasi Aplikasi
                                    </div>
                                    <div class="card-body">
                                        <div class="control-panel">
                                            <h6 class="control-title">Tentang BARJAS</h6>
                                            <p>Aplikasi Sistem Bantuan BARJAS v2.5.0</p>
                                            <p>Dikembangkan oleh Lentera Karya Situbondo</p>
                                            <p>© 2025 - All Rights Reserved</p>
                                            
                                            <h6 class="control-title mt-4">Fitur Aplikasi</h6>
                                            <ul class="list-group list-group-flush">
                                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                                    Input Data Bantuan
                                                    <span class="badge bg-primary rounded-pill">Lengkap</span>
                                                </li>
                                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                                    Manajemen Data
                                                    <span class="badge bg-primary rounded-pill">Lengkap</span>
                                                </li>
                                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                                    Statistik dan Grafik
                                                    <span class="badge bg-primary rounded-pill">Lengkap</span>
                                                </li>
                                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                                    Export Data (Excel/PDF)
                                                    <span class="badge bg-primary rounded-pill">Lengkap</span>
                                                </li>
                                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                                    Sistem Keamanan
                                                    <span class="badge bg-primary rounded-pill">Aktif</span>
                                                </li>
                                            </ul>
                                            
                                            <h6 class="control-title mt-4">Status Aplikasi</h6>
                                            <div class="d-flex justify-content-between mb-2">
                                                <span>Jumlah Data:</span>
                                                <span id="settingsDataCount">0</span>
                                            </div>
                                            <div class="d-flex justify-content-between mb-2">
                                                <span>Versi:</span>
                                                <span>v2.5.0</span>
                                            </div>
                                            <div class="d-flex justify-content-between">
                                                <span>Update Terakhir:</span>
                                                <span id="lastUpdate">-</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="card mt-4">
                                    <div class="card-header">
                                        <i class="fas fa-paint-brush me-2"></i> Tema Tampilan
                                    </div>
                                    <div class="card-body">
                                        <div class="control-panel">
                                            <h6 class="control-title">Pilih Tema</h6>
                                            <div class="d-grid gap-2">
                                                <button class="btn btn-outline-primary theme-btn active" data-theme="default">
                                                    <i class="fas fa-sun"></i> Tema Default
                                                </button>
                                                <button class="btn btn-outline-dark theme-btn" data-theme="dark">
                                                    <i class="fas fa-moon"></i> Tema Gelap
                                                </button>
                                                <button class="btn btn-outline-success theme-btn" data-theme="green">
                                                    <i class="fas fa-leaf"></i> Tema Hijau
                                                </button>
                                            </div>
                                            
                                            <h6 class="control-title mt-4">Pengaturan Lainnya</h6>
                                            <div class="form-check form-switch mb-3">
                                                <input class="form-check-input" type="checkbox" id="notifSwitch" checked>
                                                <label class="form-check-label" for="notifSwitch">Notifikasi Suara</label>
                                            </div>
                                            <div class="form-check form-switch">
                                                <input class="form-check-input" type="checkbox" id="animSwitch" checked>
                                                <label class="form-check-label" for="animSwitch">Animasi Tampilan</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="copyright">
                &copy; 2025 BARJAS - Sistem Bantuan Terpadu. Dikembangkan oleh <strong>Lentera Karya Situbondo</strong>
            </div>
        </div>
        
        <!-- Floating Action Button -->
        <div class="floating-action-btn" id="fab">
            <i class="fas fa-plus"></i>
        </div>
        
        <!-- Notification Toast -->
        <div class="toast notification-toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-autohide="true" data-bs-delay="5000">
            <div class="toast-header">
                <i class="fas fa-bell text-primary me-2"></i>
                <strong class="me-auto">BARJAS Notification</strong>
                <small>Just now</small>
                <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
            <div class="toast-body">
                <!-- Notification message will be inserted here -->
            </div>
        </div>
    </div>
    
    <!-- Modal untuk Edit Data -->
    <div class="modal fade" id="editModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Edit Data Bantuan</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="editForm">
                        <input type="hidden" id="editId">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Nama Penerima</label>
                                    <input type="text" class="form-control" id="editNamaPenerima" required>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Nomor WhatsApp</label>
                                    <input type="tel" class="form-control" id="editWhatsapp">
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">NIK</label>
                                    <input type="text" class="form-control" id="editNik" maxlength="16">
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Kecamatan</label>
                                    <select class="form-select" id="editKecamatan" required>
                                        <!-- Opsi kecamatan akan diisi oleh JavaScript -->
                                    </select>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Desa/Kelurahan</label>
                                    <select class="form-select" id="editDesa" required>
                                        <!-- Opsi desa akan diisi oleh JavaScript -->
                                    </select>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Alamat Lengkap</label>
                                    <textarea class="form-control" id="editAlamat" rows="2"></textarea>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Jenis Bantuan</label>
                                    <select class="form-select" id="editJenisBantuan" required>
                                        <!-- Opsi jenis bantuan akan diisi oleh JavaScript -->
                                    </select>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Jumlah Bantuan</label>
                                    <input type="number" class="form-control" id="editJumlahBantuan" min="1" required>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Tanggal Penyaluran</label>
                                    <input type="date" class="form-control" id="editTanggalPenyaluran" required>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Tahun Anggaran</label>
                                    <select class="form-select" id="editTahunAnggaran" required>
                                        <!-- Opsi tahun akan diisi oleh JavaScript -->
                                    </select>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Link Google Drive</label>
                                    <input type="url" class="form-control" id="editLinkDrive">
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Kode Validasi</label>
                                    <input type="text" class="form-control" id="editKodeValidasi" readonly>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Keterangan</label>
                                    <textarea class="form-control" id="editKeterangan" rows="2"></textarea>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                    <button type="button" class="btn btn-primary" id="saveEditBtn">Simpan Perubahan</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal untuk Konfirmasi Hapus -->
    <div class="modal fade" id="deleteModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Konfirmasi Hapus Data</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>Apakah Anda yakin ingin menghapus data bantuan untuk <strong id="deleteNamaPenerima"></strong>?</p>
                    <p class="text-danger">Data yang dihapus tidak dapat dikembalikan!</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                    <button type="button" class="btn btn-danger" id="confirmDeleteBtn">Hapus Data</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal untuk Preview Data -->
    <div class="modal fade" id="previewModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Preview Data Bantuan</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label fw-bold">Nama Penerima</label>
                                <p id="previewNamaPenerima">-</p>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label fw-bold">Nomor WhatsApp</label>
                                <p id="previewWhatsapp">-</p>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label fw-bold">NIK</label>
                                <p id="previewNik">-</p>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label fw-bold">Kecamatan</label>
                                <p id="previewKecamatan">-</p>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label fw-bold">Desa/Kelurahan</label>
                                <p id="previewDesa">-</p>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label fw-bold">Alamat Lengkap</label>
                                <p id="previewAlamat">-</p>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label fw-bold">Jenis Bantuan</label>
                                <p id="previewJenisBantuan">-</p>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label fw-bold">Jumlah Bantuan</label>
                                <p id="previewJumlahBantuan">-</p>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label fw-bold">Tanggal Penyaluran</label>
                                <p id="previewTanggalPenyaluran">-</p>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label fw-bold">Tahun Anggaran</label>
                                <p id="previewTahunAnggaran">-</p>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label fw-bold">Link Google Drive</label>
                                <p id="previewLinkDrive">-</p>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label fw-bold">Kode Validasi</label>
                                <p id="previewKodeValidasi">-</p>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label fw-bold">Keterangan</label>
                                <p id="previewKeterangan">-</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Tutup</button>
                    <button type="button" class="btn btn-primary" id="printPreviewBtn">Cetak Data</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal untuk Menambah Link Google Drive -->
    <div class="modal fade link-modal" id="linkModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Tambah Link Google Drive</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="linkForm">
                        <input type="hidden" id="linkId">
                        <div class="mb-3">
                            <label class="form-label">Link Google Drive</label>
                            <input type="url" class="form-control" id="modalLinkDrive" placeholder="Contoh: https://drive.google.com/..." required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                    <button type="button" class="btn btn-primary" id="saveLinkBtn">Simpan Link</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Script untuk Bootstrap, Chart.js, dan lainnya -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/locale/id.min.js"></script>
    
    <script>
        // Inisialisasi variabel global
        let bantuanData = [];
        let currentPage = 1;
        const itemsPerPage = 10;
        let filteredData = [];
        let loginAttempts = 0;
        let isBlocked = false;
        let blockTimeout;
        let securityCode = "BARJAS2025"; // Kode default, bisa diubah melalui pengaturan
        
        // DOM Ready
        document.addEventListener('DOMContentLoaded', function() {
            // Inisialisasi aplikasi
            initializeApp();
            
            // Setup event listeners
            setupEventListeners();
            
            // Tampilkan splash screen pertama kali
            showWelcomeSplash();
        });
        
        // Fungsi inisialisasi aplikasi
        function initializeApp() {
            // Load data dari localStorage
            loadData();
            
            // Setup form tanggal dengan nilai hari ini
            document.getElementById('tanggalPenyaluran').valueAsDate = new Date();
            
            // Generate kode validasi pertama kali
            generateKodeValidasi();
            
            // Setup filter dropdowns
            setupFilterDropdowns();
            
            // Update dashboard stats
            updateDashboardStats();
            
            // Render data table
            renderDataTable();
            
            // Setup charts
            setupCharts();
            
            // Update settings info
            updateSettingsInfo();
        }
        
        // Fungsi untuk setup event listeners
        function setupEventListeners() {
            // Navigation
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const target = this.getAttribute('data-bs-target');
                    showSection(target);
                    
                    // Jika mobile, tutup sidebar setelah memilih menu
                    if (window.innerWidth < 992) {
                        document.getElementById('sidebarMenu').classList.remove('mobile-show');
                        document.getElementById('sidebarOverlay').classList.remove('mobile-show');
                    }
                });
            });
            
            // Mobile menu
            document.getElementById('mobileMenuBtn').addEventListener('click', function() {
                document.getElementById('sidebarMenu').classList.add('mobile-show');
                document.getElementById('sidebarOverlay').classList.add('mobile-show');
            });
            
            document.getElementById('sidebarOverlay').addEventListener('click', function() {
                document.getElementById('sidebarMenu').classList.remove('mobile-show');
                this.classList.remove('mobile-show');
            });
            
            // Form submission
            document.getElementById('bantuanForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveBantuanData();
            });
            
            // Generate kode validasi
            document.getElementById('generateKodeBtn').addEventListener('click', generateKodeValidasi);
            
            // Filter buttons
            document.getElementById('applyFilterBtn').addEventListener('click', applyFilters);
            document.getElementById('resetFilterBtn').addEventListener('click', resetFilters);
            
            // Export buttons
            document.getElementById('exportExcelBtn').addEventListener('click', exportToExcel);
            document.getElementById('exportPdfBtn').addEventListener('click', exportToPDF);
            document.getElementById('printTableBtn').addEventListener('click', printTable);
            
            // Search input
            document.getElementById('searchInput').addEventListener('input', applyFilters);
            
            // Backup and restore
            document.getElementById('backupDataBtn').addEventListener('click', backupData);
            document.getElementById('restoreDataBtn').addEventListener('click', triggerRestore);
            document.getElementById('restoreFileInput').addEventListener('change', restoreData);
            document.getElementById('resetDataBtn').addEventListener('click', resetData);
            
            // Security code change
            document.getElementById('changeSecurityCodeBtn').addEventListener('click', changeSecurityCode);
            
            // Theme switcher
            document.querySelectorAll('.theme-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.theme-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    changeTheme(this.getAttribute('data-theme'));
                });
            });
            
            // Floating action button
            document.getElementById('fab').addEventListener('click', function() {
                showSection('inputData');
                document.getElementById('namaPenerima').focus();
            });
            
            // Toggle password visibility
            document.querySelector('.toggle-password').addEventListener('click', function() {
                const passwordInput = document.getElementById('securityCode');
                const icon = this.querySelector('i');
                
                if (passwordInput.type === 'password') {
                    passwordInput.type = 'text';
                    icon.classList.remove('fa-eye');
                    icon.classList.add('fa-eye-slash');
                } else {
                    passwordInput.type = 'password';
                    icon.classList.remove('fa-eye-slash');
                    icon.classList.add('fa-eye');
                }
            });
            
            // Login form submission
            document.getElementById('loginForm').addEventListener('submit', function(e) {
                e.preventDefault();
                attemptLogin();
            });
            
            // Close splash screen
            document.getElementById('closeSplash').addEventListener('click', function() {
                document.getElementById('welcomeSplash').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('welcomeSplash').style.display = 'none';
                    showLoginModal();
                }, 500);
            });
            
            // Logout
            document.getElementById('logoutBtn').addEventListener('click', function(e) {
                e.preventDefault();
                logout();
            });
            
            // Kecamatan change event untuk filter desa
            document.getElementById('kecamatan').addEventListener('change', filterDesaOptions);
            document.getElementById('editKecamatan').addEventListener('change', filterEditDesaOptions);
        }
        
        // Fungsi untuk menampilkan section tertentu
        function showSection(sectionId) {
            // Sembunyikan semua section
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.add('d-none');
            });
            
            // Tampilkan section yang dipilih
            document.getElementById(sectionId).classList.remove('d-none');
            
            // Update nav link active state
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('data-bs-target') === sectionId) {
                    link.classList.add('active');
                }
            });
            
            // Jika section adalah viewData, refresh table
            if (sectionId === 'viewData') {
                renderDataTable();
            }
            
            // Jika section adalah statistics, refresh charts
            if (sectionId === 'statistics') {
                updateCharts();
            }
            
            // Jika section adalah settings, update info
            if (sectionId === 'settings') {
                updateSettingsInfo();
            }
        }
        
        // Fungsi untuk generate kode validasi (5 karakter alfanumerik kapital)
        function generateKodeValidasi() {
            const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let result = '';
            for (let i = 0; i < 5; i++) {
                result += characters.charAt(Math.floor(Math.random() * characters.length));
            }
            document.getElementById('kodeValidasi').value = result;
        }
        
        // Fungsi untuk menyimpan data bantuan
        function saveBantuanData() {
            // Validasi form
            if (!validateForm()) {
                showNotification('Harap periksa kembali form input!', 'error');
                return;
            }
            
            // Ambil nilai dari form
            const newData = {
                id: Date.now(), // ID unik berdasarkan timestamp
                namaPenerima: document.getElementById('namaPenerima').value,
                whatsapp: document.getElementById('whatsapp').value,
                nik: document.getElementById('nik').value,
                kecamatan: document.getElementById('kecamatan').value,
                desa: document.getElementById('desa').value,
                alamat: document.getElementById('alamat').value,
                jenisBantuan: document.getElementById('jenisBantuan').value,
                jumlahBantuan: parseInt(document.getElementById('jumlahBantuan').value),
                tanggalPenyaluran: document.getElementById('tanggalPenyaluran').value,
                tahunAnggaran: document.getElementById('tahunAnggaran').value,
                linkDrive: document.getElementById('linkDrive').value,
                kodeValidasi: document.getElementById('kodeValidasi').value,
                keterangan: document.getElementById('keterangan').value,
                timestamp: new Date().toISOString()
            };
            
            // Tambahkan ke array data
            bantuanData.unshift(newData);
            
            // Simpan ke localStorage
            saveData();
            
            // Reset form
            document.getElementById('bantuanForm').reset();
            document.getElementById('tanggalPenyaluran').valueAsDate = new Date();
            generateKodeValidasi();
            
            // Update UI
            updateDashboardStats();
            renderDataTable();
            updateCharts();
            
            // Tampilkan notifikasi
            showNotification('Data bantuan berhasil disimpan!', 'success');
        }
        
        // Fungsi untuk validasi form
        function validateForm() {
            let isValid = true;
            
            // Validasi nama penerima
            const namaPenerima = document.getElementById('namaPenerima');
            const namaPenerimaError = document.getElementById('namaPenerimaError');
            if (!namaPenerima.value.trim()) {
                namaPenerima.classList.add('input-error');
                namaPenerimaError.style.display = 'block';
                isValid = false;
            } else {
                namaPenerima.classList.remove('input-error');
                namaPenerimaError.style.display = 'none';
            }
            
            // Validasi kecamatan
            const kecamatan = document.getElementById('kecamatan');
            const kecamatanError = document.getElementById('kecamatanError');
            if (!kecamatan.value) {
                kecamatan.classList.add('input-error');
                kecamatanError.style.display = 'block';
                isValid = false;
            } else {
                kecamatan.classList.remove('input-error');
                kecamatanError.style.display = 'none';
            }
            
            // Validasi desa
            const desa = document.getElementById('desa');
            const desaError = document.getElementById('desaError');
            if (!desa.value) {
                desa.classList.add('input-error');
                desaError.style.display = 'block';
                isValid = false;
            } else {
                desa.classList.remove('input-error');
                desaError.style.display = 'none';
            }
            
            // Validasi jenis bantuan
            const jenisBantuan = document.getElementById('jenisBantuan');
            const jenisBantuanError = document.getElementById('jenisBantuanError');
            if (!jenisBantuan.value) {
                jenisBantuan.classList.add('input-error');
                jenisBantuanError.style.display = 'block';
                isValid = false;
            } else {
                jenisBantuan.classList.remove('input-error');
                jenisBantuanError.style.display = 'none';
            }
            
            // Validasi jumlah bantuan
            const jumlahBantuan = document.getElementById('jumlahBantuan');
            const jumlahBantuanError = document.getElementById('jumlahBantuanError');
            if (!jumlahBantuan.value || parseInt(jumlahBantuan.value) < 1) {
                jumlahBantuan.classList.add('input-error');
                jumlahBantuanError.style.display = 'block';
                isValid = false;
            } else {
                jumlahBantuan.classList.remove('input-error');
                jumlahBantuanError.style.display = 'none';
            }
            
            // Validasi tanggal penyaluran
            const tanggalPenyaluran = document.getElementById('tanggalPenyaluran');
            const tanggalPenyaluranError = document.getElementById('tanggalPenyaluranError');
            if (!tanggalPenyaluran.value) {
                tanggalPenyaluran.classList.add('input-error');
                tanggalPenyaluranError.style.display = 'block';
                isValid = false;
            } else {
                tanggalPenyaluran.classList.remove('input-error');
                tanggalPenyaluranError.style.display = 'none';
            }
            
            // Validasi tahun anggaran
            const tahunAnggaran = document.getElementById('tahunAnggaran');
            const tahunAnggaranError = document.getElementById('tahunAnggaranError');
            if (!tahunAnggaran.value) {
                tahunAnggaran.classList.add('input-error');
                tahunAnggaranError.style.display = 'block';
                isValid = false;
            } else {
                tahunAnggaran.classList.remove('input-error');
                tahunAnggaranError.style.display = 'none';
            }
            
            // Validasi WhatsApp (jika diisi)
            const whatsapp = document.getElementById('whatsapp');
            const whatsappError = document.getElementById('whatsappError');
            if (whatsapp.value && !isValidWhatsApp(whatsapp.value)) {
                whatsapp.classList.add('input-error');
                whatsappError.style.display = 'block';
                isValid = false;
            } else {
                whatsapp.classList.remove('input-error');
                whatsappError.style.display = 'none';
            }
            
            // Validasi NIK (jika diisi)
            const nik = document.getElementById('nik');
            const nikError = document.getElementById('nikError');
            if (nik.value && !isValidNIK(nik.value)) {
                nik.classList.add('input-error');
                nikError.style.display = 'block';
                isValid = false;
            } else {
                nik.classList.remove('input-error');
                nikError.style.display = 'none';
            }
            
            // Validasi link Google Drive (jika diisi)
            const linkDrive = document.getElementById('linkDrive');
            const linkDriveError = document.getElementById('linkDriveError');
            if (linkDrive.value && !isValidURL(linkDrive.value)) {
                linkDrive.classList.add('input-error');
                linkDriveError.style.display = 'block';
                isValid = false;
            } else {
                linkDrive.classList.remove('input-error');
                linkDriveError.style.display = 'none';
            }
            
            return isValid;
        }
        
        // Fungsi untuk validasi WhatsApp
        function isValidWhatsApp(number) {
            const regex = /^(\+62|62|0)8[1-9][0-9]{6,9}$/;
            return regex.test(number);
        }
        
        // Fungsi untuk validasi NIK
        function isValidNIK(nik) {
            const regex = /^\d{16}$/;
            return regex.test(nik);
        }
        
        // Fungsi untuk validasi URL
        function isValidURL(url) {
            try {
                new URL(url);
                return true;
            } catch (e) {
                return false;
            }
        }
        
        // Fungsi untuk memuat data dari localStorage
        function loadData() {
            const savedData = localStorage.getItem('bantuanData');
            if (savedData) {
                bantuanData = JSON.parse(savedData);
            }
            
            const savedSecurityCode = localStorage.getItem('securityCode');
            if (savedSecurityCode) {
                securityCode = savedSecurityCode;
            }
        }
        
        // Fungsi untuk menyimpan data ke localStorage
        function saveData() {
            localStorage.setItem('bantuanData', JSON.stringify(bantuanData));
            localStorage.setItem('lastUpdate', new Date().toISOString());
        }
        
        // Fungsi untuk menampilkan notifikasi
        function showNotification(message, type = 'info') {
            const toast = document.querySelector('.notification-toast');
            const toastBody = toast.querySelector('.toast-body');
            
            // Set message dan kelas berdasarkan type
            toastBody.textContent = message;
            toast.className = `toast notification-toast ${type}`;
            
            // Tampilkan toast
            const bsToast = new bootstrap.Toast(toast);
            bsToast.show();
        }
        
        // Fungsi untuk merender tabel data
        function renderDataTable() {
            const tableBody = document.getElementById('dataTable').querySelector('tbody');
            tableBody.innerHTML = '';
            
            // Gunakan filteredData jika ada, jika tidak gunakan semua data
            const dataToRender = filteredData.length > 0 ? filteredData : bantuanData;
            
            // Hitung pagination
            const totalPages = Math.ceil(dataToRender.length / itemsPerPage);
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = Math.min(startIndex + itemsPerPage, dataToRender.length);
            
            // Update info tabel
            document.getElementById('tableInfo').textContent = `Menampilkan ${startIndex + 1} sampai ${endIndex} dari ${dataToRender.length} data`;
            
            // Render data
            for (let i = startIndex; i < endIndex; i++) {
                const data = dataToRender[i];
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${i + 1}</td>
                    <td>${data.namaPenerima}</td>
                    <td>${data.whatsapp ? `<span class="whatsapp-number" onclick="openWhatsApp('${data.whatsapp}')">${data.whatsapp}</span>` : '-'}</td>
                    <td>${data.nik || '-'}</td>
                    <td>${data.kecamatan}</td>
                    <td>${data.desa}</td>
                    <td>${data.jenisBantuan}</td>
                    <td>${data.jumlahBantuan}</td>
                    <td>${formatDate(data.tanggalPenyaluran)}</td>
                    <td>${data.tahunAnggaran}</td>
                    <td>${data.kodeValidasi}</td>
                    <td>${data.linkDrive ? `<a href="${data.linkDrive}" target="_blank" class="drive-link">Lihat</a>` : '<button class="btn btn-sm btn-outline-primary add-link-btn" data-id="${data.id}">Tambah</button>'}</td>
                    <td>
                        <div class="btn-group btn-group-sm">
                            <button class="btn btn-info preview-btn" data-id="${data.id}">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn btn-warning edit-btn" data-id="${data.id}">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-danger delete-btn" data-id="${data.id}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                `;
                
                tableBody.appendChild(row);
            }
            
            // Setup event listeners untuk tombol aksi
            setupActionButtons();
            
            // Render pagination
            renderPagination(totalPages);
        }
        
        // Fungsi untuk merender pagination
        function renderPagination(totalPages) {
            const pagination = document.getElementById('pagination');
            pagination.innerHTML = '';
            
            if (totalPages <= 1) return;
            
            // Tombol Previous
            const prevLi = document.createElement('li');
            prevLi.className = `page-item ${currentPage === 1 ? 'disabled' : ''}`;
            prevLi.innerHTML = `<a class="page-link" href="#">Previous</a>`;
            prevLi.addEventListener('click', function(e) {
                e.preventDefault();
                if (currentPage > 1) {
                    currentPage--;
                    renderDataTable();
                }
            });
            pagination.appendChild(prevLi);
            
            // Numbered pages
            const startPage = Math.max(1, currentPage - 2);
            const endPage = Math.min(totalPages, startPage + 4);
            
            for (let i = startPage; i <= endPage; i++) {
                const pageLi = document.createElement('li');
                pageLi.className = `page-item ${i === currentPage ? 'active' : ''}`;
                pageLi.innerHTML = `<a class="page-link" href="#">${i}</a>`;
                pageLi.addEventListener('click', function(e) {
                    e.preventDefault();
                    currentPage = i;
                    renderDataTable();
                });
                pagination.appendChild(pageLi);
            }
            
            // Tombol Next
            const nextLi = document.createElement('li');
            nextLi.className = `page-item ${currentPage === totalPages ? 'disabled' : ''}`;
            nextLi.innerHTML = `<a class="page-link" href="#">Next</a>`;
            nextLi.addEventListener('click', function(e) {
                e.preventDefault();
                if (currentPage < totalPages) {
                    currentPage++;
                    renderDataTable();
                }
            });
            pagination.appendChild(nextLi);
        }
        
        // Fungsi untuk setup tombol aksi (preview, edit, delete)
        function setupActionButtons() {
            // Preview buttons
            document.querySelectorAll('.preview-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    previewData(id);
                });
            });
            
            // Edit buttons
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    editData(id);
                });
            });
            
            // Delete buttons
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    confirmDelete(id);
                });
            });
            
            // Add link buttons
            document.querySelectorAll('.add-link-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    addLink(id);
                });
            });
        }
        
        // Fungsi untuk preview data
        function previewData(id) {
            const data = bantuanData.find(item => item.id === id);
            if (!data) return;
            
            // Isi modal preview dengan data
            document.getElementById('previewNamaPenerima').textContent = data.namaPenerima;
            document.getElementById('previewWhatsapp').textContent = data.whatsapp || '-';
            document.getElementById('previewNik').textContent = data.nik || '-';
            document.getElementById('previewKecamatan').textContent = data.kecamatan;
            document.getElementById('previewDesa').textContent = data.desa;
            document.getElementById('previewAlamat').textContent = data.alamat || '-';
            document.getElementById('previewJenisBantuan').textContent = data.jenisBantuan;
            document.getElementById('previewJumlahBantuan').textContent = data.jumlahBantuan;
            document.getElementById('previewTanggalPenyaluran').textContent = formatDate(data.tanggalPenyaluran);
            document.getElementById('previewTahunAnggaran').textContent = data.tahunAnggaran;
            document.getElementById('previewLinkDrive').innerHTML = data.linkDrive ? `<a href="${data.linkDrive}" target="_blank">${data.linkDrive}</a>` : '-';
            document.getElementById('previewKodeValidasi').textContent = data.kodeValidasi;
            document.getElementById('previewKeterangan').textContent = data.keterangan || '-';
            
            // Setup print button
            document.getElementById('printPreviewBtn').onclick = function() {
                printIndividualData(data);
            };
            
            // Tampilkan modal
            const modal = new bootstrap.Modal(document.getElementById('previewModal'));
            modal.show();
        }
        
        // Fungsi untuk edit data
        function editData(id) {
            const data = bantuanData.find(item => item.id === id);
            if (!data) return;
            
            // Isi form edit dengan data
            document.getElementById('editId').value = data.id;
            document.getElementById('editNamaPenerima').value = data.namaPenerima;
            document.getElementById('editWhatsapp').value = data.whatsapp || '';
            document.getElementById('editNik').value = data.nik || '';
            
            // Setup kecamatan dropdown
            const kecamatanSelect = document.getElementById('editKecamatan');
            kecamatanSelect.innerHTML = document.getElementById('kecamatan').innerHTML;
            kecamatanSelect.value = data.kecamatan;
            
            // Setup desa dropdown berdasarkan kecamatan
            filterEditDesaOptions();
            document.getElementById('editDesa').value = data.desa;
            
            document.getElementById('editAlamat').value = data.alamat || '';
            
            // Setup jenis bantuan dropdown
            const jenisBantuanSelect = document.getElementById('editJenisBantuan');
            jenisBantuanSelect.innerHTML = document.getElementById('jenisBantuan').innerHTML;
            jenisBantuanSelect.value = data.jenisBantuan;
            
            document.getElementById('editJumlahBantuan').value = data.jumlahBantuan;
            document.getElementById('editTanggalPenyaluran').value = data.tanggalPenyaluran;
            
            // Setup tahun anggaran dropdown
            const tahunSelect = document.getElementById('editTahunAnggaran');
            tahunSelect.innerHTML = document.getElementById('tahunAnggaran').innerHTML;
            tahunSelect.value = data.tahunAnggaran;
            
            document.getElementById('editLinkDrive').value = data.linkDrive || '';
            document.getElementById('editKodeValidasi').value = data.kodeValidasi;
            document.getElementById('editKeterangan').value = data.keterangan || '';
            
            // Setup save button
            document.getElementById('saveEditBtn').onclick = function() {
                saveEditedData();
            };
            
            // Tampilkan modal
            const modal = new bootstrap.Modal(document.getElementById('editModal'));
            modal.show();
        }
        
        // Fungsi untuk filter desa options di form edit berdasarkan kecamatan
        function filterEditDesaOptions() {
            const kecamatan = document.getElementById('editKecamatan').value;
            const desaSelect = document.getElementById('editDesa');
            
            // Reset options
            desaSelect.innerHTML = '<option value="">Pilih Desa/Kelurahan</option>';
            
            // Jika kecamatan dipilih, filter desa
            if (kecamatan) {
                const allDesaOptions = document.getElementById('desa').querySelectorAll('option');
                allDesaOptions.forEach(option => {
                    if (option.value && option.value !== "") {
                        desaSelect.appendChild(option.cloneNode(true));
                    }
                });
            }
        }
        
        // Fungsi untuk menyimpan data yang diedit
        function saveEditedData() {
            const id = parseInt(document.getElementById('editId').value);
            const index = bantuanData.findIndex(item => item.id === id);
            
            if (index === -1) return;
            
            // Update data
            bantuanData[index] = {
                ...bantuanData[index],
                namaPenerima: document.getElementById('editNamaPenerima').value,
                whatsapp: document.getElementById('editWhatsapp').value,
                nik: document.getElementById('editNik').value,
                kecamatan: document.getElementById('editKecamatan').value,
                desa: document.getElementById('editDesa').value,
                alamat: document.getElementById('editAlamat').value,
                jenisBantuan: document.getElementById('editJenisBantuan').value,
                jumlahBantuan: parseInt(document.getElementById('editJumlahBantuan').value),
                tanggalPenyaluran: document.getElementById('editTanggalPenyaluran').value,
                tahunAnggaran: document.getElementById('editTahunAnggaran').value,
                linkDrive: document.getElementById('editLinkDrive').value,
                keterangan: document.getElementById('editKeterangan').value
            };
            
            // Simpan ke localStorage
            saveData();
            
            // Update UI
            renderDataTable();
            updateDashboardStats();
            updateCharts();
            
            // Tutup modal
            const modal = bootstrap.Modal.getInstance(document.getElementById('editModal'));
            modal.hide();
            
            // Tampilkan notifikasi
            showNotification('Data berhasil diperbarui!', 'success');
        }
        
        // Fungsi untuk konfirmasi hapus data
        function confirmDelete(id) {
            const data = bantuanData.find(item => item.id === id);
            if (!data) return;
            
            // Tampilkan nama penerima di modal konfirmasi
            document.getElementById('deleteNamaPenerima').textContent = data.namaPenerima;
            
            // Setup confirm button
            document.getElementById('confirmDeleteBtn').onclick = function() {
                deleteData(id);
            };
            
            // Tampilkan modal
            const modal = new bootstrap.Modal(document.getElementById('deleteModal'));
            modal.show();
        }
        
        // Fungsi untuk menghapus data
        function deleteData(id) {
            const index = bantuanData.findIndex(item => item.id === id);
            
            if (index === -1) return;
            
            // Hapus data dari array
            bantuanData.splice(index, 1);
            
            // Simpan ke localStorage
            saveData();
            
            // Update UI
            renderDataTable();
            updateDashboardStats();
            updateCharts();
            
            // Tutup modal
            const modal = bootstrap.Modal.getInstance(document.getElementById('deleteModal'));
            modal.hide();
            
            // Tampilkan notifikasi
            showNotification('Data berhasil dihapus!', 'success');
        }
        
        // Fungsi untuk menambah link Google Drive
        function addLink(id) {
            const data = bantuanData.find(item => item.id === id);
            if (!data) return;
            
            // Set ID di form
            document.getElementById('linkId').value = id;
            
            // Isi form dengan link yang ada (jika ada)
            document.getElementById('modalLinkDrive').value = data.linkDrive || '';
            
            // Setup save button
            document.getElementById('saveLinkBtn').onclick = function() {
                saveLink();
            };
            
            // Tampilkan modal
            const modal = new bootstrap.Modal(document.getElementById('linkModal'));
            modal.show();
        }
        
        // Fungsi untuk menyimpan link
        function saveLink() {
            const id = parseInt(document.getElementById('linkId').value);
            const link = document.getElementById('modalLinkDrive').value;
            
            const index = bantuanData.findIndex(item => item.id === id);
            
            if (index === -1) return;
            
            // Update data
            bantuanData[index].linkDrive = link;
            
            // Simpan ke localStorage
            saveData();
            
            // Update UI
            renderDataTable();
            
            // Tutup modal
            const modal = bootstrap.Modal.getInstance(document.getElementById('linkModal'));
            modal.hide();
            
            // Tampilkan notifikasi
            showNotification('Link Google Drive berhasil disimpan!', 'success');
        }
        
        // Fungsi untuk membuka WhatsApp
        function openWhatsApp(number) {
            if (!number) return;
            
            // Format nomor (hapus awalan 0 atau +62 atau 62)
            let formattedNumber = number.replace(/^0|\+62|62/, '');
            if (formattedNumber.startsWith('0')) {
                formattedNumber = formattedNumber.substring(1);
            }
            
            // Buka WhatsApp
            window.open(`https://wa.me/62${formattedNumber}`, '_blank');
        }
        
        // Fungsi untuk memformat tanggal
        function formatDate(dateString) {
            return new Date(dateString).toLocaleDateString('id-ID', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric'
            });
        }
        
        // Fungsi untuk update dashboard stats
        function updateDashboardStats() {
            document.getElementById('totalData').textContent = bantuanData.length;
            
            // Hitung data terverifikasi (dengan kode validasi)
            const verifiedCount = bantuanData.filter(item => item.kodeValidasi).length;
            document.getElementById('verifiedData').textContent = verifiedCount;
            
            // Hitung data pending (tanpa kode validasi)
            const pendingCount = bantuanData.length - verifiedCount;
            document.getElementById('pendingData').textContent = pendingCount;
            
            // Update recent data table
            updateRecentDataTable();
        }
        
        // Fungsi untuk update recent data table di dashboard
        function updateRecentDataTable() {
            const tableBody = document.getElementById('recentDataTable').querySelector('tbody');
            tableBody.innerHTML = '';
            
            // Ambil 5 data terbaru
            const recentData = [...bantuanData]
                .sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp))
                .slice(0, 5);
            
            recentData.forEach((data, index) => {
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${data.namaPenerima}</td>
                    <td>${data.desa}, ${data.kecamatan}</td>
                    <td>${data.jenisBantuan}</td>
                    <td>${formatDate(data.tanggalPenyaluran)}</td>
                    <td><span class="badge ${data.kodeValidasi ? 'bg-success' : 'bg-warning'}">${data.kodeValidasi ? 'Tervalidasi' : 'Pending'}</span></td>
                `;
                
                tableBody.appendChild(row);
            });
        }
        
        // Fungsi untuk setup filter dropdowns
        function setupFilterDropdowns() {
            // Kecamatan filter
            const kecamatanFilter = document.getElementById('filterKecamatan');
            const kecamatanOptions = [...new Set(bantuanData.map(item => item.kecamatan))].sort();
            
            kecamatanOptions.forEach(kecamatan => {
                const option = document.createElement('option');
                option.value = kecamatan;
                option.textContent = kecamatan;
                kecamatanFilter.appendChild(option);
            });
            
            // Desa filter
            const desaFilter = document.getElementById('filterDesa');
            const desaOptions = [...new Set(bantuanData.map(item => item.desa))].sort();
            
            desaOptions.forEach(desa => {
                const option = document.createElement('option');
                option.value = desa;
                option.textContent = desa;
                desaFilter.appendChild(option);
            });
            
            // Jenis bantuan filter
            const jenisBantuanFilter = document.getElementById('filterJenisBantuan');
            const jenisBantuanOptions = [...new Set(bantuanData.map(item => item.jenisBantuan))].sort();
            
            jenisBantuanOptions.forEach(jenis => {
                const option = document.createElement('option');
                option.value = jenis;
                option.textContent = jenis;
                jenisBantuanFilter.appendChild(option);
            });
            
            // Tahun filter
            const tahunFilter = document.getElementById('filterTahun');
            const tahunOptions = [...new Set(bantuanData.map(item => item.tahunAnggaran))].sort((a, b) => b - a);
            
            tahunOptions.forEach(tahun => {
                const option = document.createElement('option');
                option.value = tahun;
                option.textContent = tahun;
                tahunFilter.appendChild(option);
            });
        }
        
        // Fungsi untuk apply filters
        function applyFilters() {
            const kecamatan = document.getElementById('filterKecamatan').value;
            const desa = document.getElementById('filterDesa').value;
            const jenisBantuan = document.getElementById('filterJenisBantuan').value;
            const tahun = document.getElementById('filterTahun').value;
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const tanggalAwal = document.getElementById('filterTanggalAwal').value;
            const tanggalAkhir = document.getElementById('filterTanggalAkhir').value;
            
            // Filter data
            filteredData = bantuanData.filter(item => {
                // Filter by kecamatan
                if (kecamatan && item.kecamatan !== kecamatan) return false;
                
                // Filter by desa
                if (desa && item.desa !== desa) return false;
                
                // Filter by jenis bantuan
                if (jenisBantuan && item.jenisBantuan !== jenisBantuan) return false;
                
                // Filter by tahun
                if (tahun && item.tahunAnggaran !== tahun) return false;
                
                // Filter by search term
                if (searchTerm) {
                    const searchableFields = [
                        item.namaPenerima,
                        item.whatsapp,
                        item.nik,
                        item.kecamatan,
                        item.desa,
                        item.alamat,
                        item.jenisBantuan,
                        item.tahunAnggaran,
                        item.kodeValidasi,
                        item.keterangan
                    ].join(' ').toLowerCase();
                    
                    if (!searchableFields.includes(searchTerm)) return false;
                }
                
                // Filter by tanggal
                if (tanggalAwal && new Date(item.tanggalPenyaluran) < new Date(tanggalAwal)) return false;
                if (tanggalAkhir && new Date(item.tanggalPenyaluran) > new Date(tanggalAkhir)) return false;
                
                return true;
            });
            
            // Reset ke halaman pertama
            currentPage = 1;
            
            // Render tabel dengan data yang difilter
            renderDataTable();
        }
        
        // Fungsi untuk reset filters
        function resetFilters() {
            document.getElementById('filterKecamatan').value = '';
            document.getElementById('filterDesa').value = '';
            document.getElementById('filterJenisBantuan').value = '';
            document.getElementById('filterTahun').value = '';
            document.getElementById('searchInput').value = '';
            document.getElementById('filterTanggalAwal').value = '';
            document.getElementById('filterTanggalAkhir').value = '';
            
            // Reset filtered data
            filteredData = [];
            
            // Reset ke halaman pertama
            currentPage = 1;
            
            // Render tabel dengan semua data
            renderDataTable();
        }
        
        // Fungsi untuk export ke Excel
        function exportToExcel() {
            // Data yang akan diexport (gunakan filteredData jika ada)
            const dataToExport = filteredData.length > 0 ? filteredData : bantuanData;
            
            if (dataToExport.length === 0) {
                showNotification('Tidak ada data untuk diexport!', 'warning');
                return;
            }
            
            // Siapkan data untuk Excel
            const excelData = dataToExport.map(item => ({
                'Nama Penerima': item.namaPenerima,
                'WhatsApp': item.whatsapp || '',
                'NIK': item.nik || '',
                'Kecamatan': item.kecamatan,
                'Desa/Kelurahan': item.desa,
                'Alamat': item.alamat || '',
                'Jenis Bantuan': item.jenisBantuan,
                'Jumlah': item.jumlahBantuan,
                'Tanggal Penyaluran': formatDate(item.tanggalPenyaluran),
                'Tahun Anggaran': item.tahunAnggaran,
                'Kode Validasi': item.kodeValidasi,
                'Link Drive': item.linkDrive || '',
                'Keterangan': item.keterangan || ''
            }));
            
            // Bu worksheet
            const worksheet = XLSX.utils.json_to_sheet(excelData);
            
            // Bu workbook
            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, 'Data Bantuan');
            
            // Export ke file
            const date = new Date().toISOString().slice(0, 10);
            XLSX.writeFile(workbook, `data_bantuan_${date}.xlsx`);
            
            // Tampilkan notifikasi
            showNotification('Data berhasil diexport ke Excel!', 'success');
        }
        
        // Fungsi untuk export ke PDF
        function exportToPDF() {
            // Data yang akan diexport (gunakan filteredData jika ada)
            const dataToExport = filteredData.length > 0 ? filteredData : bantuanData;
            
            if (dataToExport.length === 0) {
                showNotification('Tidak ada data untuk diexport!', 'warning');
                return;
            }
            
            // Buat instance jsPDF
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Judul
            doc.setFontSize(18);
            doc.text('LAPORAN DATA BANTUAN', 105, 15, { align: 'center' });
            
            // Tanggal export
            doc.setFontSize(10);
            doc.text(`Tanggal Export: ${new Date().toLocaleDateString('id-ID')}`, 105, 22, { align: 'center' });
            
            // Siapkan data untuk tabel
            const tableData = dataToExport.map(item => [
                item.namaPenerima,
                item.whatsapp || '-',
                item.nik || '-',
                item.kecamatan,
                item.desa,
                item.jenisBantuan,
                item.jumlahBantuan,
                formatDate(item.tanggalPenyaluran),
                item.tahunAnggaran,
                item.kodeValidasi
            ]);
            
            // Buat tabel
            doc.autoTable({
                head: [['Nama', 'WhatsApp', 'NIK', 'Kecamatan', 'Desa', 'Jenis', 'Jumlah', 'Tanggal', 'Tahun', 'Kode']],
                body: tableData,
                startY: 30,
                theme: 'grid',
                styles: { fontSize: 8 },
                headStyles: { fillColor: [13, 71, 161] }
            });
            
            // Simpan PDF
            const date = new Date().toISOString().slice(0, 10);
            doc.save(`data_bantuan_${date}.pdf`);
            
            // Tampilkan notifikasi
            showNotification('Data berhasil diexport ke PDF!', 'success');
        }
        
        // Fungsi untuk mencetak tabel
        function printTable() {
            // Siapkan judul untuk laporan cetak
            const printHeader = document.createElement('div');
            printHeader.className = 'print-header';
            printHeader.innerHTML = `
                <h2 class="print-title">LAPORAN DATA BANTUAN</h2>
                <p class="print-subtitle">Dinas Peternakan dan Perikanan Kabupaten Situbondo</p>
                <p class="print-date">Dicetak pada: ${new Date().toLocaleDateString('id-ID')}</p>
            `;
            
            // Sembunyikan kolom aksi dan link Google Drive
            const table = document.getElementById('dataTable').cloneNode(true);
            const headerRow = table.rows[0];
            const actionIndex = headerRow.cells.length - 1;
            const linkIndex = headerRow.cells.length - 2;
            
            // Hapus kolom aksi dan link
            for (let i = 0; i < table.rows.length; i++) {
                table.rows[i].deleteCell(actionIndex);
                table.rows[i].deleteCell(linkIndex);
            }
            
            // Buat window cetak
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html>
                <head>
                    <title>Cetak Data Bantuan</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        table { width: 100%; border-collapse: collapse; font-size: 12px; }
                        th, td { border: 1px solid #ddd; padding: 6px; text-align: left; }
                        th { background-color: #0d47a1; color: white; }
                        tr:nth-child(even) { background-color: #f2f2f2; }
                        .print-header { text-align: center; margin-bottom: 20px; }
                        .print-title { font-size: 18px; font-weight: bold; margin-bottom: 5px; }
                        .print-subtitle { font-size: 14px; margin-bottom: 10px; }
                        .print-date { font-size: 12px; text-align: right; margin-bottom: 10px; }
                        @media print {
                            @page { size: landscape; margin: 0.5cm; }
                            body { margin: 0; }
                        }
                    </style>
                </head>
                <body>
                    ${printHeader.outerHTML}
                    ${table.outerHTML}
                </body>
                </html>
            `);
            printWindow.document.close();
            
            // Tunggu sebentar sebelum mencetak
            setTimeout(() => {
                printWindow.print();
                // printWindow.close();
            }, 250);
        }
        
        // Fungsi untuk mencetak data individual
        function printIndividualData(data) {
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html>
                <head>
                    <title>Cetak Data Bantuan - ${data.namaPenerima}</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        .print-container { max-width: 800px; margin: 0 auto; }
                        .print-header { text-align: center; margin-bottom: 20px; border-bottom: 2px solid #0d47a1; padding-bottom: 10px; }
                        .print-title { font-size: 18px; font-weight: bold; margin-bottom: 5px; }
                        .print-subtitle { font-size: 14px; margin-bottom: 10px; }
                        .print-date { font-size: 12px; text-align: right; }
                        .data-section { margin-bottom: 20px; }
                        .data-row { display: flex; margin-bottom: 8px; }
                        .data-label { flex: 0 0 200px; font-weight: bold; }
                        .data-value { flex: 1; }
                        .qrcode { text-align: center; margin-top: 20px; }
                        @media print {
                            @page { margin: 1cm; }
                            body { margin: 0; }
                        }
                    </style>
                </head>
                <body>
                    <div class="print-container">
                        <div class="print-header">
                            <h2 class="print-title">DATA BANTUAN</h2>
                            <p class="print-subtitle">Dinas Peternakan dan Perikanan Kabupaten Situbondo</p>
                        </div>
                        
                        <div class="data-section">
                            <h3>Data Penerima</h3>
                            <div class="data-row">
                                <div class="data-label">Nama Penerima:</div>
                                <div class="data-value">${data.namaPenerima}</div>
                            </div>
                            <div class="data-row">
                                <div class="data-label">WhatsApp:</div>
                                <div class="data-value">${data.whatsapp || '-'}</div>
                            </div>
                            <div class="data-row">
                                <div class="data-label">NIK:</div>
                                <div class="data-value">${data.nik || '-'}</div>
                            </div>
                            <div class="data-row">
                                <div class="data-label">Alamat:</div>
                                <div class="data-value">${data.alamat || '-'}</div>
                            </div>
                            <div class="data-row">
                                <div class="data-label">Kecamatan:</div>
                                <div class="data-value">${data.kecamatan}</div>
                            </div>
                            <div class="data-row">
                                <div class="data-label">Desa/Kelurahan:</div>
                                <div class="data-value">${data.desa}</div>
                            </div>
                        </div>
                        
                        <div class="data-section">
                            <h3>Data Bantuan</h3>
                            <div class="data-row">
                                <div class="data-label">Jenis Bantuan:</div>
                                <div class="data-value">${data.jenisBantuan}</div>
                            </div>
                            <div class="data-row">
                                <div class="data-label">Jumlah Bantuan:</div>
                                <div class="data-value">${data.jumlahBantuan}</div>
                            </div>
                            <div class="data-row">
                                <div class="data-label">Tanggal Penyaluran:</div>
                                <div class="data-value">${formatDate(data.tanggalPenyaluran)}</div>
                            </div>
                            <div class="data-row">
                                <div class="data-label">Tahun Anggaran:</div>
                                <div class="data-value">${data.tahunAnggaran}</div>
                            </div>
                            <div class="data-row">
                                <div class="data-label">Kode Validasi:</div>
                                <div class="data-value">${data.kodeValidasi}</div>
                            </div>
                            <div class="data-row">
                                <div class="data-label">Link Google Drive:</div>
                                <div class="data-value">${data.linkDrive || '-'}</div>
                            </div>
                            <div class="data-row">
                                <div class="data-label">Keterangan:</div>
                                <div class="data-value">${data.keterangan || '-'}</div>
                            </div>
                        </div>
                        
                        <div class="qrcode">
                            <p>Scan untuk verifikasi</p>
                            <!-- QR Code would be generated here in a real implementation -->
                            <div style="width: 150px; height: 150px; border: 1px solid #ddd; margin: 0 auto; display: flex; align-items: center; justify-content: center;">
                                QR Code
                            </div>
                        </div>
                        
                        <div class="print-date">
                            Dicetak pada: ${new Date().toLocaleDateString('id-ID')}
                        </div>
                    </div>
                </body>
                </html>
            `);
            printWindow.document.close();
            
            // Tunggu sebentar sebelum mencetak
            setTimeout(() => {
                printWindow.print();
                // printWindow.close();
            }, 250);
        }
        
        // Fungsi untuk setup charts
        function setupCharts() {
            // Chart untuk statistik per kecamatan
            const kecamatanCtx = document.getElementById('kecamatanChart').getContext('2d');
            window.kecamatanChart = new Chart(kecamatanCtx, {
                type: 'bar',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'Jumlah Bantuan per Kecamatan',
                        data: [],
                        backgroundColor: 'rgba(13, 71, 161, 0.7)',
                        borderColor: 'rgba(13, 71, 161, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        title: {
                            display: true,
                            text: 'Distribusi Bantuan per Kecamatan'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
            
            // Chart untuk jenis bantuan
            const jenisBantuanCtx = document.getElementById('jenisBantuanChart').getContext('2d');
            window.jenisBantuanChart = new Chart(jenisBantuanCtx, {
                type: 'pie',
                data: {
                    labels: [],
                    datasets: [{
                        data: [],
                        backgroundColor: [
                            'rgba(13, 71, 161, 0.7)',
                            'rgba(0, 105, 92, 0.7)',
                            'rgba(255, 143, 0, 0.7)',
                            'rgba(106, 27, 154, 0.7)',
                            'rgba(229, 57, 53, 0.7)',
                            'rgba(2, 119, 189, 0.7)',
                            'rgba(216, 67, 21, 0.7)',
                            'rgba(0, 121, 107, 0.7)',
                            'rgba(104, 159, 56, 0.7)',
                            'rgba(194, 24, 91, 0.7)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'right',
                        },
                        title: {
                            display: true,
                            text: 'Distribusi Jenis Bantuan'
                        }
                    }
                }
            });
            
            // Chart untuk trend penyaluran
            const trendCtx = document.getElementById('trendChart').getContext('2d');
            window.trendChart = new Chart(trendCtx, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'Jumlah Bantuan per Bulan',
                        data: [],
                        fill: false,
                        backgroundColor: 'rgba(13, 71, 161, 0.7)',
                        borderColor: 'rgba(13, 71, 161, 1)',
                        tension: 0.1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        title: {
                            display: true,
                            text: 'Trend Penyaluran Bantuan per Bulan'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
            
            // Chart untuk top 5 desa
            const topDesaCtx = document.getElementById('topDesaChart').getContext('2d');
            window.topDesaChart = new Chart(topDesaCtx, {
                type: 'bar',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'Jumlah Bantuan',
                        data: [],
                        backgroundColor: 'rgba(0, 105, 92, 0.7)',
                        borderColor: 'rgba(0, 105, 92, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        title: {
                            display: true,
                            text: 'Top 5 Desa Penerima Bantuan'
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
            
            // Chart untuk distribusi per tahun
            const tahunCtx = document.getElementById('tahunChart').getContext('2d');
            window.tahunChart = new Chart(tahunCtx, {
                type: 'bar',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'Jumlah Bantuan',
                        data: [],
                        backgroundColor: 'rgba(255, 143, 0, 0.7)',
                        borderColor: 'rgba(255, 143, 0, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        title: {
                            display: true,
                            text: 'Distribusi Bantuan per Tahun'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
            
            // Chart untuk sebaran per kecamatan
            const sebaranKecamatanCtx = document.getElementById('sebaranKecamatanChart').getContext('2d');
            window.sebaranKecamatanChart = new Chart(sebaranKecamatanCtx, {
                type: 'doughnut',
                data: {
                    labels: [],
                    datasets: [{
                        data: [],
                        backgroundColor: [
                            'rgba(13, 71, 161, 0.7)',
                            'rgba(0, 105, 92, 0.7)',
                            'rgba(255, 143, 0, 0.7)',
                            'rgba(106, 27, 154, 0.7)',
                            'rgba(229, 57, 53, 0.7)',
                            'rgba(2, 119, 189, 0.7)',
                            'rgba(216, 67, 21, 0.7)',
                            'rgba(0, 121, 107, 0.7)',
                            'rgba(104, 159, 56, 0.7)',
                            'rgba(194, 24, 91, 0.7)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'right',
                        },
                        title: {
                            display: true,
                            text: 'Sebaran Bantuan per Kecamatan'
                        }
                    }
                }
            });
            
            // Update charts dengan data
            updateCharts();
        }
        
        // Fungsi untuk update charts dengan data terbaru
        function updateCharts() {
            // Data untuk chart kecamatan
            const kecamatanCount = {};
            bantuanData.forEach(item => {
                kecamatanCount[item.kecamatan] = (kecamatanCount[item.kecamatan] || 0) + 1;
            });
            
            window.kecamatanChart.data.labels = Object.keys(kecamatanCount);
            window.kecamatanChart.data.datasets[0].data = Object.values(kecamatanCount);
            window.kecamatanChart.update();
            
            // Data untuk chart jenis bantuan
            const jenisBantuanCount = {};
            bantuanData.forEach(item => {
                jenisBantuanCount[item.jenisBantuan] = (jenisBantuanCount[item.jenisBantuan] || 0) + 1;
            });
            
            window.jenisBantuanChart.data.labels = Object.keys(jenisBantuanCount);
            window.jenisBantuanChart.data.datasets[0].data = Object.values(jenisBantuanCount);
            window.jenisBantuanChart.update();
            
            // Data untuk trend chart (per bulan)
            const monthlyData = {};
            bantuanData.forEach(item => {
                const date = new Date(item.tanggalPenyaluran);
                const monthYear = `${date.getMonth() + 1}/${date.getFullYear()}`;
                monthlyData[monthYear] = (monthlyData[monthYear] || 0) + 1;
            });
            
            // Urutkan berdasarkan bulan
            const sortedMonths = Object.keys(monthlyData).sort((a, b) => {
                const [aMonth, aYear] = a.split('/').map(Number);
                const [bMonth, bYear] = b.split('/').map(Number);
                return aYear - bYear || aMonth - bMonth;
            });
            
            window.trendChart.data.labels = sortedMonths;
            window.trendChart.data.datasets[0].data = sortedMonths.map(month => monthlyData[month]);
            window.trendChart.update();
            
            // Data untuk top 5 desa
            const desaCount = {};
            bantuanData.forEach(item => {
                desaCount[item.desa] = (desaCount[item.desa] || 0) + 1;
            });
            
            const topDesa = Object.entries(desaCount)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 5);
            
            window.topDesaChart.data.labels = topDesa.map(d => d[0]);
            window.topDesaChart.data.datasets[0].data = topDesa.map(d => d[1]);
            window.topDesaChart.update();
            
            // Data untuk chart tahun
            const tahunCount = {};
            bantuanData.forEach(item => {
                tahunCount[item.tahunAnggaran] = (tahunCount[item.tahunAnggaran] || 0) + 1;
            });
            
            window.tahunChart.data.labels = Object.keys(tahunCount).sort();
            window.tahunChart.data.datasets[0].data = Object.keys(tahunCount).sort().map(year => tahunCount[year]);
            window.tahunChart.update();
            
            // Data untuk sebaran kecamatan (doughnut)
            window.sebaranKecamatanChart.data.labels = Object.keys(kecamatanCount);
            window.sebaranKecamatanChart.data.datasets[0].data = Object.values(kecamatanCount);
            window.sebaranKecamatanChart.update();
        }
        
        // Fungsi untuk backup data
        function backupData() {
            const dataStr = JSON.stringify(bantuanData);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = `backup_bantuan_${new Date().toISOString().slice(0,10)}.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
            
            showNotification('Backup data berhasil!', 'success');
        }
        
        // Fungsi untuk trigger restore data
        function triggerRestore() {
            document.getElementById('restoreFileInput').click();
        }
        
        // Fungsi untuk restore data
        function restoreData(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const restoredData = JSON.parse(e.target.result);
                    
                    if (!Array.isArray(restoredData)) {
                        throw new Error('Format file tidak valid');
                    }
                    
                    // Konfirmasi restore
                    if (confirm('Restore data akan menggantikan semua data yang ada. Lanjutkan?')) {
                        bantuanData = restoredData;
                        saveData();
                        
                        // Update UI
                        renderDataTable();
                        updateDashboardStats();
                        updateCharts();
                        setupFilterDropdowns();
                        
                        showNotification('Data berhasil direstore!', 'success');
                    }
                } catch (error) {
                    showNotification('Error: File backup tidak valid!', 'error');
                    console.error('Restore error:', error);
                }
            };
            reader.readAsText(file);
            
            // Reset input file
            event.target.value = '';
        }
        
        // Fungsi untuk reset data
        function resetData() {
            if (confirm('Apakah Anda yakin ingin menghapus semua data? Tindakan ini tidak dapat dibatalkan!')) {
                bantuanData = [];
                saveData();
                
                // Update UI
                renderDataTable();
                updateDashboardStats();
                updateCharts();
                setupFilterDropdowns();
                
                showNotification('Semua data berhasil dihapus!', 'success');
            }
        }
        
        // Fungsi untuk mengubah kode keamanan
        function changeSecurityCode() {
            const currentCode = document.getElementById('currentSecurityCode').value;
            const newCode = document.getElementById('newSecurityCode').value;
            const confirmCode = document.getElementById('confirmSecurityCode').value;
            
            if (currentCode !== securityCode) {
                showNotification('Kode keamanan saat ini salah!', 'error');
                return;
            }
            
            if (newCode.length < 4) {
                showNotification('Kode keamanan baru minimal 4 karakter!', 'error');
                return;
            }
            
            if (newCode !== confirmCode) {
                showNotification('Konfirmasi kode keamanan tidak cocok!', 'error');
                return;
            }
            
            securityCode = newCode;
            localStorage.setItem('securityCode', securityCode);
            
            // Reset form
            document.getElementById('currentSecurityCode').value = '';
            document.getElementById('newSecurityCode').value = '';
            document.getElementById('confirmSecurityCode').value = '';
            
            showNotification('Kode keamanan berhasil diubah!', 'success');
        }
        
        // Fungsi untuk mengubah tema
        function changeTheme(theme) {
            document.body.className = '';
            
            switch(theme) {
                case 'dark':
                    document.body.classList.add('theme-dark');
                    break;
                case 'green':
                    document.body.classList.add('theme-green');
                    break;
                default:
                    // Default theme
                    break;
            }
            
            // Simpreferensi tema
            localStorage.setItem('theme', theme);
            
            showNotification(`Tema ${theme} diterapkan!`, 'info');
        }
        
        // Fungsi untuk update info di pengaturan
        function updateSettingsInfo() {
            document.getElementById('settingsDataCount').textContent = bantuanData.length;
            
            const lastUpdate = localStorage.getItem('lastUpdate');
            if (lastUpdate) {
                document.getElementById('lastUpdate').textContent = new Date(lastUpdate).toLocaleDateString('id-ID');
            }
        }
        
        // Fungsi untuk menampilkan welcome splash screen
        function showWelcomeSplash() {
            document.getElementById('welcomeSplash').style.display = 'flex';
            
            // Countdown untuk auto close
            let countdown = 5;
            const countdownElement = document.getElementById('countdownTimer');
            const countdownInterval = setInterval(() => {
                countdown--;
                countdownElement.textContent = countdown;
                
                if (countdown <= 0) {
                    clearInterval(countdownInterval);
                    document.getElementById('welcomeSplash').style.opacity = '0';
                    setTimeout(() => {
                        document.getElementById('welcomeSplash').style.display = 'none';
                        showLoginModal();
                    }, 500);
                }
            }, 1000);
        }
        
        // Fungsi untuk menampilkan login modal
        function showLoginModal() {
            const loginModal = new bootstrap.Modal(document.getElementById('loginModal'));
            loginModal.show();
            
            // Reset login attempts jika sudah melebihi timeout
            if (isBlocked && blockTimeout && blockTimeout < Date.now()) {
                isBlocked = false;
                loginAttempts = 0;
                updateLoginUI();
            }
        }
        
        // Fungsi untuk attempt login
        function attemptLogin() {
            if (isBlocked) return;
            
            const inputCode = document.getElementById('securityCode').value;
            
            // Tampilkan loading state
            document.getElementById('loginButton').disabled = true;
            document.getElementById('loginSpinner').classList.remove('d-none');
            document.querySelector('.login-button-text').textContent = 'Memverifikasi...';
            
            // Simulasi proses verifikasi (dalam aplikasi real, ini akan request ke server)
            setTimeout(() => {
                if (inputCode === securityCode) {
                    // Login berhasil
                    loginAttempts = 0;
                    isBlocked = false;
                    
                    // Sembunyikan modal login
                    const loginModal = bootstrap.Modal.getInstance(document.getElementById('loginModal'));
                    loginModal.hide();
                    
                    // Tampilkan aplikasi
                    document.getElementById('appContent').classList.remove('app-content-unauthenticated');
                    
                    // Tampilkan notifikasi
                    showNotification('Login berhasil! Selamat datang di Aplikasi BARJAS.', 'success');
                } else {
                    // Login gagal
                    loginAttempts++;
                    
                    if (loginAttempts >= 3) {
                        isBlocked = true;
                        const blockTime = Date.now() + 30000; // 30 detik
                        blockTimeout = blockTime;
                        
                        // Tampilkan countdown
                        let remainingTime = 30;
                        const countdownInterval = setInterval(() => {
                            remainingTime--;
                            document.getElementById('countdown').textContent = remainingTime;
                            
                            if (remainingTime <= 0) {
                                clearInterval(countdownInterval);
                                isBlocked = false;
                                loginAttempts = 0;
                                updateLoginUI();
                            }
                        }, 1000);
                    }
                    
                    // Tampilkan notifikasi error
                    showNotification('Kode keamanan salah!', 'error');
                    
                    // Shake effect
                    document.getElementById('loginForm').classList.add('login-shake');
                    setTimeout(() => {
                        document.getElementById('loginForm').classList.remove('login-shake');
                    }, 600);
                }
                
                // Reset loading state
                document.getElementById('loginButton').disabled = false;
                document.getElementById('loginSpinner').classList.add('d-none');
                document.querySelector('.login-button-text').textContent = 'Masuk ke Aplikasi';
                
                // Update UI login
                updateLoginUI();
                
                // Reset input
                document.getElementById('securityCode').value = '';
            }, 1000);
        }
        
        // Fungsi untuk update UI login
        function updateLoginUI() {
            const attemptsCount = document.getElementById('attemptsCount');
            const blockedMessage = document.getElementById('blockedMessage');
            
            if (loginAttempts > 0) {
                attemptsCount.textContent = `Percobaan gagal: ${loginAttempts} dari 3`;
                attemptsCount.style.display = 'block';
            } else {
                attemptsCount.style.display = 'none';
            }
            
            if (isBlocked) {
                blockedMessage.classList.remove('d-none');
                document.getElementById('loginButton').disabled = true;
            } else {
                blockedMessage.classList.add('d-none');
                document.getElementById('loginButton').disabled = false;
            }
        }
        
        // Fungsi untuk logout
        function logout() {
            if (confirm('Apakah Anda yakin ingin keluar dari aplikasi?')) {
                // Sembunyikan aplikasi
                document.getElementById('appContent').classList.add('app-content-unauthenticated');
                
                // Tampilkan login modal
                showLoginModal();
                
                // Tampilkan notifikasi
                showNotification('Anda telah logout dari aplikasi.', 'info');
            }
        }
        
        // Fungsi untuk filter desa options berdasarkan kecamatan yang dipilih
        function filterDesaOptions() {
            const kecamatan = document.getElementById('kecamatan').value;
            const desaSelect = document.getElementById('desa');
            
            // Reset options
            desaSelect.innerHTML = '<option value="">Pilih Desa/Kelurahan</option>';
            
            // Jika kecamatan dipilih, filter desa
            if (kecamatan) {
                const allDesaOptions = document.getElementById('desa').querySelectorAll('option');
                allDesaOptions.forEach(option => {
                    if (option.value && option.value !== "") {
                        desaSelect.appendChild(option.cloneNode(true));
                    }
                });
            }
        }
        
        // Inisialisasi saat halaman dimuat
        window.onload = initializeApp;
    </script>
</body>
</html>
