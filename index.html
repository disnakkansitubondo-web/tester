<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APLIKASI BARJAS - SISTEM BANTUAN</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary-color: #0d47a1;
            --secondary-color: #00695c;
            --accent-color: #ff8f00;
            --light-blue: #e3f2fd;
            --dark-blue: #082e5c;
            --gradient-primary: linear-gradient(135deg, var(--primary-color), var(--dark-blue));
            --gradient-secondary: linear-gradient(135deg, var(--secondary-color), #004d40);
            --gradient-accent: linear-gradient(135deg, var(--accent-color), #e65100);
            --shadow-sm: 0 2px 8px rgba(0,0,0,0.08);
            --shadow-md: 0 4px 16px rgba(0,0,0,0.12);
            --shadow-lg: 0 8px 28px rgba(0,0,0,0.15);
            --login-gradient: linear-gradient(135deg, #0d47a1, #00695c, #ff8f00);
        }
        
        body {
            background: linear-gradient(135deg, #f5f9ff 0%, #e8f5e9 100%);
            font-family: 'Poppins', 'Segoe UI', sans-serif;
            min-height: 100vh;
            padding: 10px 0;
            overflow-x: hidden;
        }
        
        .app-container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            box-shadow: var(--shadow-lg);
            border-radius: 12px;
            overflow: hidden;
            position: relative;
            z-index: 10;
        }
        
        .app-header {
            background: var(--gradient-primary);
            color: white;
            padding: 20px 15px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .app-header::before {
            content: "";
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.15) 0%, transparent 70%);
            pointer-events: none;
        }
        
        .app-logo {
            font-size: 2.5rem;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }
        
        .app-title {
            font-size: 1.8rem;
            font-weight: 800;
            margin: 0;
            position: relative;
            z-index: 1;
            text-shadow: 1px 1px 4px rgba(0,0,0,0.3);
        }
        
        .app-subtitle {
            font-size: 1rem;
            opacity: 0.95;
            position: relative;
            z-index: 1;
            font-weight: 300;
            letter-spacing: 0.5px;
            margin-bottom: 5px;
        }
        
        .nav-pills .nav-link {
            border-radius: 8px;
            margin-bottom: 8px;
            padding: 12px 15px;
            font-weight: 500;
            color: #444;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            font-size: 0.9rem;
        }
        
        .nav-pills .nav-link:hover {
            background-color: #f0f7ff;
            transform: translateX(3px);
        }
        
        .nav-pills .nav-link.active {
            background: var(--gradient-primary);
            font-weight: 600;
            box-shadow: var(--shadow-md);
            transform: translateX(3px);
            color: white;
        }
        
        .section-title {
            border-left: 4px solid var(--primary-color);
            padding-left: 12px;
            margin: 20px 0;
            font-weight: 700;
            color: var(--dark-blue);
            font-size: 1.4rem;
            position: relative;
        }
        
        .section-title::after {
            content: "";
            position: absolute;
            bottom: -5px;
            left: 12px;
            width: 40px;
            height: 2px;
            background: var(--gradient-primary);
            border-radius: 2px;
        }
        
        .btn-primary {
            background: var(--gradient-primary);
            border: none;
            padding: 10px 20px;
            font-weight: 600;
            box-shadow: var(--shadow-md);
            border-radius: 8px;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .btn-success {
            background: var(--gradient-secondary);
            border: none;
            padding: 10px 20px;
            font-weight: 600;
            box-shadow: var(--shadow-md);
            border-radius: 8px;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .btn-warning {
            background: var(--gradient-accent);
            border: none;
            padding: 10px 20px;
            font-weight: 600;
            box-shadow: var(--shadow-md);
            border-radius: 8px;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .btn-warning:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .form-label {
            font-weight: 600;
            color: #444;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            font-size: 0.9rem;
        }
        
        .form-label i {
            margin-right: 6px;
            color: var(--primary-color);
        }
        
        .form-control, .form-select {
            border-radius: 8px;
            padding: 12px 15px;
            border: 1px solid #ddd;
            transition: all 0.3s;
            box-shadow: var(--shadow-sm);
            font-size: 0.9rem;
        }
        
        .form-control:focus, .form-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(13, 71, 161, 0.2);
            transform: translateY(-2px);
        }
        
        .copyright {
            text-align: center;
            padding: 20px;
            background-color: var(--light-blue);
            color: var(--dark-blue);
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .data-table {
            font-size: 0.85rem;
            border-collapse: separate;
            border-spacing: 0;
            box-shadow: var(--shadow-sm);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .data-table th {
            background: var(--gradient-primary);
            color: white;
            font-weight: 600;
            padding: 12px 10px;
            text-align: center;
            position: relative;
            font-size: 0.85rem;
        }
        
        .data-table th::after {
            content: "";
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 1px;
            background: rgba(255,255,255,0.3);
        }
        
        .data-table td {
            padding: 10px 8px;
            vertical-align: middle;
            border-bottom: 1px solid #eee;
            font-size: 0.85rem;
        }
        
        .data-table tr:nth-child(even) {
            background-color: #f9fbff;
        }
        
        .data-table tr:hover {
            background-color: #edf5ff;
        }
        
        .feature-icon {
            font-size: 1.1rem;
            margin-right: 8px;
            width: 24px;
            text-align: center;
        }
        
        .card {
            border-radius: 10px;
            border: none;
            box-shadow: var(--shadow-md);
            transition: all 0.3s ease;
            overflow: hidden;
            margin-bottom: 15px;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        
        .card-header {
            border-radius: 10px 10px 0 0 !important;
            font-weight: 600;
            padding: 15px 20px;
            background: var(--gradient-primary);
            color: white;
            font-size: 0.95rem;
        }
        
        .stats-box {
            text-align: center;
            padding: 20px 15px;
            border-radius: 10px;
            background: white;
            box-shadow: var(--shadow-md);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
            margin-bottom: 15px;
        }
        
        .stats-box::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--gradient-primary);
            border-radius: 2px;
        }
        
        .stats-box:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }
        
        .stats-number {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--primary-color);
            margin: 10px 0;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        
        .stats-label {
            font-size: 0.9rem;
            color: #666;
            font-weight: 500;
        }
        
        .notification-toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1050;
            min-width: 280px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: var(--shadow-lg);
            max-width: calc(100vw - 40px);
        }
        
        .input-error {
            border-color: #dc3545;
            box-shadow: 0 0 0 3px rgba(220, 53, 69, 0.2);
        }
        
        .error-message {
            color: #dc3545;
            font-size: 0.8rem;
            margin-top: 5px;
            display: none;
            font-weight: 500;
        }
        
        .watermark {
            position: absolute;
            bottom: 10px;
            right: 15px;
            opacity: 0.8;
            font-size: 0.8rem;
            color: white;
            font-weight: 300;
        }
        
        .control-panel {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            box-shadow: var(--shadow-sm);
        }
        
        .control-title {
            font-size: 1rem;
            color: var(--primary-color);
            font-weight: 600;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--light-blue);
        }
        
        .floating-action-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--gradient-primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .floating-action-btn:hover {
            transform: scale(1.1) rotate(90deg);
        }
        
        .filter-section {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-sm);
        }
        
        .badge-custom {
            background: var(--gradient-primary);
            color: white;
            padding: 6px 12px;
            border-radius: 16px;
            font-weight: 600;
            font-size: 0.8rem;
        }
        
        .mobile-menu-btn {
            display: none;
            position: fixed;
            top: 15px;
            left: 15px;
            z-index: 1050;
            background: var(--gradient-primary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            box-shadow: var(--shadow-lg);
        }
        
        .sidebar-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1040;
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-fadeIn {
            animation: fadeIn 0.5s ease forwards;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 8px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 8px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--dark-blue);
        }
        
        /* Responsive styles */
        @media (max-width: 991.98px) {
            .col-md-3.col-lg-2 {
                position: fixed;
                left: -300px;
                top: 0;
                bottom: 0;
                z-index: 1050;
                width: 280px;
                transition: left 0.3s ease;
                overflow-y: auto;
                padding-top: 60px;
            }
            
            .col-md-3.col-lg-2.mobile-show {
                left: 0;
            }
            
            .col-md-9.col-lg-10 {
                width: 100%;
                flex: 0 0 100%;
                max-width: 100%;
            }
            
            .mobile-menu-btn {
                display: flex;
                align-items: center;
                justify-content: center;
            }
            
            .sidebar-overlay.mobile-show {
                display: block;
            }
        }
        
        /* Print Styles - IMPROVED FOR LANDSCAPE */
        @media print {
            @page {
                size: landscape;
                margin: 0.5cm;
            }
            
            body * {
                visibility: hidden;
            }
            
            .app-container, .app-container * {
                visibility: visible;
            }
            
            .app-container {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                box-shadow: none;
            }
            
            .nav-pills, .mobile-menu-btn, .sidebar-overlay, .floating-action-btn,
            .btn-group, .filter-section, .toast {
                display: none !important;
            }
            
            .col-md-3.col-lg-2.p-4.bg-light {
                display: none !important;
            }
            
            .col-md-9.col-lg-10.p-5 {
                width: 100%;
                flex: 0 0 100%;
                max-width: 100%;
                padding: 0 !important;
            }
            
            .copyright {
                display: none;
            }
            
            .data-table {
                font-size: 10px;
                width: 100% !important;
            }
            
            .data-table th, .data-table td {
                padding: 4px 2px;
            }
            
            /* Sembunyikan kolom aksi dan link Google Drive saat mencetak */
            .data-table th:last-child,
            .data-table td:last-child {
                display: none !important;
            }
            
            /* Judul untuk laporan cetak */
            .print-header {
                display: block !important;
                text-align: center;
                margin-bottom: 15px;
            }
            
            .print-title {
                font-size: 18px;
                font-weight: bold;
                margin-bottom: 5px;
            }
            
            .print-subtitle {
                font-size: 14px;
                margin-bottom: 10px;
            }
            
            .print-date {
                font-size: 12px;
                text-align: right;
                margin-bottom: 10px;
            }
        }

        /* WhatsApp link style */
        .whatsapp-link {
            color: #25D366;
            text-decoration: none;
        }
        
        .whatsapp-link:hover {
            text-decoration: underline;
        }
        
        /* View Link Button */
        .btn-view {
            background: linear-gradient(135deg, #17a2b8, #138496);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
        }
        
        .btn-view:hover {
            background: linear-gradient(135deg, #138496, #117a8b);
            color: white;
        }
        
        /* Undo Button */
        .btn-undo {
            background: linear-gradient(135deg, #6c757d, #5a6268);
            color: white;
            border: none;
        }
        
        .btn-undo:hover {
            background: linear-gradient(135deg, #5a6268, #4e555b);
            color: white;
        }
        
        /* WhatsApp number link in table */
        .whatsapp-number {
            color: #25D366;
            cursor: pointer;
            text-decoration: underline;
        }
        
        /* Welcome Modal Styles */
        .welcome-modal .modal-content {
            border-radius: 15px;
            overflow: hidden;
            border: none;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .welcome-header {
            background: var(--gradient-primary);
            color: white;
            text-align: center;
            padding: 25px;
        }
        
        .welcome-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            display: block;
        }
        
        .welcome-body {
            padding: 25px;
            text-align: center;
        }
        
        .welcome-footer {
            background: #f8f9fa;
            padding: 15px;
            text-align: center;
            border-top: 1px solid #eee;
        }
        
        .countdown-timer {
            font-size: 0.9rem;
            color: #6c757d;
            margin-top: 10px;
        }
        
        /* Button untuk cetak per data */
        .btn-print-individual {
            background: linear-gradient(135deg, #6f42c1, #5a2d95);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
        }
        
        .btn-print-individual:hover {
            background: linear-gradient(135deg, #5a2d95, #4a2479);
            color: white;
        }
        
        /* Developer Info Styles */
        .developer-info {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            box-shadow: var(--shadow-sm);
            font-size: 0.85rem;
        }
        
        .developer-logo {
            max-width: 120px;
            margin-bottom: 15px;
            border-radius: 8px;
        }
        
        .developer-contact a {
            color: var(--primary-color);
            text-decoration: none;
            transition: all 0.3s;
        }
        
        .developer-contact a:hover {
            color: var(--dark-blue);
            text-decoration: underline;
        }
        
        /* Welcome Splash Screen */
        .welcome-splash {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient-primary);
            color: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }
        
        .welcome-splash-content {
            text-align: center;
            max-width: 600px;
            padding: 30px;
        }
        
        .welcome-splash-logo {
            font-size: 4rem;
            margin-bottom: 20px;
            display: block;
        }
        
        .welcome-splash-title {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 15px;
        }
        
        .welcome-splash-message {
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 25px;
        }
        
        .welcome-splash-countdown {
            font-size: 1rem;
            margin-top: 20px;
        }
        
        .welcome-splash-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .welcome-splash-close:hover {
            background: rgba(255,255,255,0.3);
            transform: rotate(90deg);
        }
        
        /* Loading spinner */
        .spinner-border-sm {
            width: 1rem;
            height: 1rem;
        }

        /* Login Modal Styles */
        .login-modal .modal-content {
            border-radius: 15px;
            overflow: hidden;
            border: none;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .login-header {
            background: var(--login-gradient);
            color: white;
            text-align: center;
            padding: 25px 20px;
            position: relative;
        }

        .login-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            color: white;
            display: block;
        }

        .login-title {
            font-size: 1.8rem;
            font-weight: 700;
            margin: 0;
        }

        .login-subtitle {
            font-size: 1rem;
            opacity: 0.9;
            margin: 5px 0 0;
        }

        .login-body {
            padding: 25px;
            position: relative;
            z-index: 1;
        }

        .login-form-group {
            margin-bottom: 20px;
        }

        .login-form-label {
            font-weight: 600;
            color: var(--dark-blue);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
        }

        .login-form-label i {
            margin-right: 10px;
            color: var(--dark-blue);
        }

        .login-form-control {
            border-radius: 8px;
            padding: 12px 15px;
            border: 2px solid #ddd;
            transition: all 0.3s;
        }

        .login-form-control:focus {
            border-color: var(--dark-blue);
            box-shadow: 0 0 0 3px rgba(13, 71, 161, 0.2);
        }

        .login-input-group-text {
            background: var(--light-blue);
            border: 2px solid #ddd;
            border-left: none;
        }

        .btn-login {
            background: var(--gradient-secondary);
            color: white;
            border: none;
            padding: 12px;
            font-weight: 600;
            border-radius: 8px;
            width: 100%;
            transition: all 0.3s;
            margin-top: 10px;
        }

        .btn-login:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 105, 92, 0.4);
        }

        .btn-login:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .login-security-notice {
            text-align: center;
            margin-top: 20px;
            font-size: 0.85rem;
            color: #666;
        }

        .login-attempts-count {
            text-align: center;
            font-size: 0.9rem;
            color: #ff8f00;
            font-weight: 500;
            margin-top: 5px;
        }

        .login-blocked-message {
            text-align: center;
            background: rgba(220, 53, 69, 0.1);
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            color: #dc3545;
            font-weight: 500;
        }

        .login-countdown {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--dark-blue);
        }

        .login-developer-info {
            background: var(--light-blue);
            border-radius: 10px;
            padding: 20px;
            margin-top: 25px;
            text-align: center;
        }

        .login-developer-logo {
            max-width: 180px;
            margin-bottom: 15px;
            border-radius: 8px;
        }

        .login-developer-contact a {
            color: var(--dark-blue);
            text-decoration: none;
            transition: all 0.3s;
            display: inline-block;
            margin: 5px 0;
        }

        .login-developer-contact a:hover {
            color: var(--primary-color);
            text-decoration: underline;
            transform: translateY(-2px);
        }

        .login-copyright {
            text-align: center;
            margin-top: 20px;
            color: #666;
            font-size: 0.9rem;
            opacity: 0.9;
        }

        /* Animations */
        @keyframes login-shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-10px); }
            20%, 40%, 60%, 80% { transform: translateX(10px); }
        }

        .login-shake {
            animation: login-shake 0.6s cubic-bezier(.36,.07,.19,.97) both;
        }

        /* Login particle background */
        #login-particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1040; /* Higher than modal backdrop */
            display: none;
        }

        /* Link Google Drive dalam tabel */
        .drive-link {
            color: #0d47a1;
            text-decoration: none;
            cursor: pointer;
        }

        .drive-link:hover {
            text-decoration: underline;
        }

        /* Modal untuk menambah link */
        .link-modal .modal-dialog {
            max-width: 600px;
        }
        
        /* App content when not authenticated */
        .app-content-unauthenticated {
            display: none;
        }

        /* Search box for desa dropdown */
        .desa-search-container {
            position: relative;
        }
        
        .desa-search-input {
            margin-bottom: 8px;
        }
        
        .desa-dropdown-menu {
            max-height: 200px;
            overflow-y: auto;
        }

        /* Login notification styles */
        .login-notification {
            margin-top: 15px;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
        }
    </style>
</head>
<body>
    <!-- Login Modal -->
    <div class="modal fade login-modal" id="loginModal" tabindex="-1" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="login-header">
                    <div class="login-icon">
                        <i class="fas fa-lock"></i>
                    </div>
                    <h2 class="login-title">AUTHENTICATION REQUIRED</h2>
                    <p class="login-subtitle">Masukkan Kode Keamanan untuk Mengakses Aplikasi</p>
                </div>
                <div class="login-body">
                    <form id="loginForm">
                        <div class="mb-3 login-form-group">
                            <label class="form-label login-form-label">
                                <i class="fas fa-key"></i> Kode Keamanan
                            </label>
                            <div class="input-group">
                                <input type="password" class="form-control login-form-control" id="securityCode" placeholder="Masukkan kode akses aplikasi">
                                <button class="btn btn-outline-secondary toggle-password" type="button">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                            <div class="form-text text-danger login-attempts-count" id="attemptsCount"></div>
                        </div>
                        <button type="submit" class="btn btn-login" id="loginButton">
                            <span class="login-button-text">Masuk ke Aplikasi</span>
                            <span class="spinner-border spinner-border-sm d-none" id="loginSpinner"></span>
                        </button>
                    </form>
                    
                    <div class="login-blocked-message d-none" id="blockedMessage">
                        <i class="fas fa-ban me-2"></i>
                        <span id="blockedText">Terlalu banyak percobaan gagal. Silakan coba lagi dalam </span>
                        <span class="login-countdown" id="countdown">30</span> detik.
                    </div>
                    
                    <div class="login-security-notice">
                        <i class="fas fa-info-circle me-2"></i>
                        Hubungi Administrator untuk mendapatkan kode akses
                    </div>
                    
                    <div class="login-developer-info">
                        <h5 class="mb-3">Developer Information</h5>
                        <div class="login-developer-contact">
                            <p><i class="fab fa-whatsapp me-2"></i> <a href="https://wa.me/6285647709114" target="_blank">+62 856-4770-9114</a></p>
                            <p><i class="fas fa-envelope me-2"></i> <a href="mailto:admin@anekamarket.my.id">admin@anekamarket.my.id</a></p>
                        </div>
                    </div>
                    
                    <div class="login-copyright">
                        &copy; 2025 Lentera karya Situbondo
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Login particle background -->
    <div id="login-particles"></div>
    
    <!-- Welcome Splash Screen -->
    <div class="welcome-splash" id="welcomeSplash">
        <button class="welcome-splash-close" id="closeSplash">
            <i class="fas fa-times"></i>
        </button>
        <div class="welcome-splash-content">
            <div class="welcome-splash-logo">
                <i class="fas fa-hands-helping"></i>
            </div>
            <h1 class="welcome-splash-title">SISTEM BANTUAN BARJAS</h1>
            <p class="welcome-splash-message">
                Aplikasi Sistem Bantuan BARJAS merupakan platform terpadu yang dirancang untuk mentransformasi pendataan, penyaluran, 
                dan monitoring program bantuan pemerintah. Aplikasi ini kami ciptakan untuk mendorong efisiensi, akurasi, 
                dan transparansi dalam pengelolaan bantuan, guna mempercepat penyerapan dan meningkatkan akuntabilitas.
            </p>
            <div class="welcome-splash-countdown" id="splashCountdown">
                Membuka aplikasi dalam <span id="countdownTimer">5</span> detik...
            </div>
        </div>
    </div>
    
    <!-- Main Application Content (initially hidden) -->
    <div class="app-content-unauthenticated" id="appContent">
        <!-- Mobile Menu Button -->
        <button class="mobile-menu-btn" id="mobileMenuBtn">
            <i class="fas fa-bars"></i>
        </button>
        
        <!-- Sidebar Overlay -->
        <div class="sidebar-overlay" id="sidebarOverlay"></div>
        
        <div class="app-container animate-fadeIn">
            <div class="app-header">
                <div class="app-logo">
                    <i class="fas fa-hands-helping"></i>
                </div>
                <h1 class="app-title">BARJAS</h1>
                <p class="app-subtitle">Sistem Bantuan Terpadu</p>
                <p class="app-subtitle" id="institutionName">Dinas Peternakan dan Perikanan Kabupaten Situbondo</p>
                <div class="watermark">v2.1.0</div>
            </div>
            
            <div class="row g-0">
                <!-- Sidebar Navigation -->
                <div class="col-md-3 col-lg-2 p-4 bg-light" id="sidebar">
                    <ul class="nav nav-pills flex-column mb-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link active" data-bs-target="dashboard">
                                <span class="feature-icon"><i class="fas fa-tachometer-alt"></i></span>
                                Dashboard
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-target="inputData">
                                <span class="feature-icon"><i class="fas fa-pencil-alt"></i></span>
                                Input Data Bantuan
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-target="dataTable">
                                <span class="feature-icon"><i class="fas fa-table"></i></span>
                                Tabel Data Bantuan
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-target="statistik">
                                <span class="feature-icon"><i class="fas fa-chart-pie"></i></span>
                                Statistik
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-target="pengaturan">
                                <span class="feature-icon"><i class="fas fa-cog"></i></span>
                                Pengaturan
                            </a>
                        </li>
                        <li class="nav-item mt-4">
                            <a href="#" class="nav-link text-danger" id="logoutBtn">
                                <span class="feature-icon"><i class="fas fa-sign-out-alt"></i></span>
                                Keluar
                            </a>
                        </li>
                    </ul>
                    
                    <div class="developer-info mt-4">
                        <h6 class="text-center mb-3">Developer Information</h6>
                        <div class="developer-contact text-center">
                            <p><i class="fab fa-whatsapp me-2"></i> <a href="https://wa.me/6285647709114" target="_blank">+62 856-4770-9114</a></p>
                            <p><i class="fas fa-envelope me-2"></i> <a href="mailto:admin@anekamarket.my.id">admin@anekamarket.my.id</a></p>
                        </div>
                    </div>
                </div>
                
                <!-- Main Content Area -->
                <div class="col-md-9 col-lg-10 p-5">
                    <!-- Dashboard Section -->
                    <div class="content-section" id="dashboard">
                        <h3 class="section-title">Dashboard</h3>
                        
                        <div class="row mb-4">
                            <div class="col-md-4">
                                <div class="stats-box">
                                    <div class="stats-icon">
                                        <i class="fas fa-users fa-2x text-primary"></i>
                                    </div>
                                    <div class="stats-number" id="totalPenerima">0</div>
                                    <div class="stats-label">Total Penerima Bantuan</div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="stats-box">
                                    <div class="stats-icon">
                                        <i class="fas fa-map-marker-alt fa-2x text-success"></i>
                                    </div>
                                    <div class="stats-number" id="totalDesa">0</div>
                                    <div class="stats-label">Desa Terjangkau</div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="stats-box">
                                    <div class="stats-icon">
                                        <i class="fas fa-box-open fa-2x text-warning"></i>
                                    </div>
                                    <div class="stats-number" id="totalBantuan">0</div>
                                    <div class="stats-label">Jenis Bantuan</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-8">
                                <div class="card">
                                    <div class="card-header">
                                        <i class="fas fa-chart-bar me-2"></i> Statistik Bantuan per Desa
                                    </div>
                                    <div class="card-body">
                                        <canvas id="desaChart" height="250"></canvas>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card">
                                    <div class="card-header">
                                        <i class="fas fa-chart-pie me-2"></i> Distribusi Jenis Bantuan
                                    </div>
                                    <div class="card-body">
                                        <canvas id="jenisBantuanChart" height="250"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mt-4">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-header">
                                        <i class="fas fa-history me-2"></i> Data Terbaru
                                    </div>
                                    <div class="card-body">
                                        <div class="table-responsive">
                                            <table class="table table-hover data-table" id="recentDataTable">
                                                <thead>
                                                    <tr>
                                                        <th>No</th>
                                                        <th>Nama Penerima</th>
                                                        <th>Alamat</th>
                                                        <th>Jenis Bantuan</th>
                                                        <th>Tanggal</th>
                                                        <th>Link</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <!-- Data akan diisi oleh JavaScript -->
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Input Data Section -->
                    <div class="content-section d-none" id="inputData">
                        <h3 class="section-title">Input Data Bantuan</h3>
                        
                        <div class="card">
                            <div class="card-header">
                                <i class="fas fa-pencil-alt me-2"></i> Formulir Input Data
                            </div>
                            <div class="card-body">
                                <form id="dataForm">
                                    <div class="row mb-3">
                                        <div class="col-md-6">
                                            <label class="form-label">
                                                <i class="fas fa-user"></i> Nama Penerima
                                            </label>
                                            <input type="text" class="form-control" id="namaPenerima" required>
                                            <div class="error-message" id="namaError">Nama penerima harus diisi</div>
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label">
                                                <i class="fas fa-phone"></i> Nomor WhatsApp
                                            </label>
                                            <input type="tel" class="form-control" id="whatsapp" placeholder="Contoh: 628123456789">
                                            <div class="error-message" id="whatsappError">Format nomor WhatsApp tidak valid</div>
                                        </div>
                                    </div>
                                    
                                    <div class="row mb-3">
                                        <div class="col-md-6">
                                            <label class="form-label">
                                                <i class="fas fa-map-marker-alt"></i> Desa
                                            </label>
                                            <div class="desa-search-container">
                                                <input type="text" class="form-control desa-search-input" id="desaSearch" placeholder="Cari desa...">
                                                <select class="form-select" id="desa" required>
                                                    <option value="">Pilih Desa</option>
                                                    <option value="Sumberanyar">Sumberanyar</option>
                                                    <option value="Banyuputih">Banyuputih</option>
                                                    <option value="Sumberejo">Sumberejo</option>
                                                    <option value="Pasirputih">Pasirputih</option>
                                                    <option value="Wringinanom">Wringinanom</option>
                                                    <option value="Mimbaan">Mimbaan</option>
                                                    <option value="Sumberwaru">Sumberwaru</option>
                                                    <option value="Patemon">Patemon</option>
                                                </select>
                                            </div>
                                            <div class="error-message" id="desaError">Desa harus dipilih</div>
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label">
                                                <i class="fas fa-home"></i> Alamat Lengkap
                                            </label>
                                            <textarea class="form-control" id="alamat" rows="2"></textarea>
                                        </div>
                                    </div>
                                    
                                    <div class="row mb-3">
                                        <div class="col-md-6">
                                            <label class="form-label">
                                                <i class="fas fa-box-open"></i> Jenis Bantuan
                                            </label>
                                            <select class="form-select" id="jenisBantuan" required>
                                                <option value="">Pilih Jenis Bantuan</option>
                                                <option value="Bibit Lele">Bibit Lele</option>
                                                <option value="Bibit Nila">Bibit Nila</option>
                                                <option value="Bibit Ayam">Bibit Ayam</option>
                                                <option value="Bibit Kambing">Bibit Kambing</option>
                                                <option value="Pakan Ternak">Pakan Ternak</option>
                                                <option value="Pupuk Organik">Pupuk Organik</option>
                                                <option value="Alat Pertanian">Alat Pertanian</option>
                                            </select>
                                            <div class="error-message" id="jenisError">Jenis bantuan harus dipilih</div>
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label">
                                                <i class="fas fa-box"></i> Jumlah
                                            </label>
                                            <input type="number" class="form-control" id="jumlah" min="1" value="1" required>
                                            <div class="error-message" id="jumlahError">Jumlah harus lebih dari 0</div>
                                        </div>
                                    </div>
                                    
                                    <div class="row mb-3">
                                        <div class="col-md-6">
                                            <label class="form-label">
                                                <i class="fas fa-calendar-alt"></i> Tanggal Penyaluran
                                            </label>
                                            <input type="date" class="form-control" id="tanggal" required>
                                            <div class="error-message" id="tanggalError">Tanggal harus diisi</div>
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label">
                                                <i class="fas fa-link"></i> Link Google Drive (opsional)
                                            </label>
                                            <div class="input-group">
                                                <input type="url" class="form-control" id="linkDrive" placeholder="https://drive.google.com/...">
                                                <button class="btn btn-outline-secondary" type="button" id="testLinkBtn">
                                                    <i class="fas fa-test-tube"></i> Test
                                                </button>
                                            </div>
                                            <div class="error-message" id="linkError">Format URL tidak valid</div>
                                        </div>
                                    </div>
                                    
                                    <div class="row mb-3">
                                        <div class="col-md-12">
                                            <label class="form-label">
                                                <i class="fas fa-sticky-note"></i> Keterangan (opsional)
                                            </label>
                                            <textarea class="form-control" id="keterangan" rows="2" placeholder="Tambahkan catatan atau keterangan tambahan"></textarea>
                                        </div>
                                    </div>
                                    
                                    <div class="d-flex justify-content-between mt-4">
                                        <button type="reset" class="btn btn-secondary">
                                            <i class="fas fa-undo me-2"></i> Reset
                                        </button>
                                        <button type="submit" class="btn btn-primary">
                                            <i class="fas fa-save me-2"></i> Simpan Data
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Data Table Section -->
                    <div class="content-section d-none" id="dataTable">
                        <h3 class="section-title">Tabel Data Bantuan</h3>
                        
                        <div class="filter-section mb-4">
                            <div class="row g-3">
                                <div class="col-md-3">
                                    <label class="form-label">Filter Berdasarkan Desa</label>
                                    <select class="form-select" id="filterDesa">
                                        <option value="">Semua Desa</option>
                                        <option value="Sumberanyar">Sumberanyar</option>
                                        <option value="Banyuputih">Banyuputih</option>
                                        <option value="Sumberejo">Sumberejo</option>
                                        <option value="Pasirputih">Pasirputih</option>
                                        <option value="Wringinanom">Wringinanom</option>
                                        <option value="Mimbaan">Mimbaan</option>
                                        <option value="Sumberwaru">Sumberwaru</option>
                                        <option value="Patemon">Patemon</option>
                                    </select>
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label">Filter Berdasarkan Jenis</label>
                                    <select class="form-select" id="filterJenis">
                                        <option value="">Semua Jenis</option>
                                        <option value="Bibit Lele">Bibit Lele</option>
                                        <option value="Bibit Nila">Bibit Nila</option>
                                        <option value="Bibit Ayam">Bibit Ayam</option>
                                        <option value="Bibit Kambing">Bibit Kambing</option>
                                        <option value="Pakan Ternak">Pakan Ternak</option>
                                        <option value="Pupuk Organik">Pupuk Organik</option>
                                        <option value="Alat Pertanian">Alat Pertanian</option>
                                    </select>
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label">Tanggal Mulai</label>
                                    <input type="date" class="form-control" id="filterTglMulai">
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label">Tanggal Akhir</label>
                                    <input type="date" class="form-control" id="filterTglAkhir">
                                </div>
                                <div class="col-md-12 d-flex justify-content-end">
                                    <button class="btn btn-outline-secondary me-2" id="resetFilter">
                                        <i class="fas fa-sync-alt me-2"></i> Reset Filter
                                    </button>
                                    <button class="btn btn-primary" id="applyFilter">
                                        <i class="fas fa-filter me-2"></i> Terapkan Filter
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="control-panel">
                            <div class="control-title">Kelola Data</div>
                            <div class="d-flex flex-wrap gap-2">
                                <button class="btn btn-success" id="exportExcelBtn">
                                    <i class="fas fa-file-excel me-2"></i> Export ke Excel
                                </button>
                                <button class="btn btn-danger" id="exportPdfBtn">
                                    <i class="fas fa-file-pdf me-2"></i> Export ke PDF
                                </button>
                                <button class="btn btn-warning" id="printBtn">
                                    <i class="fas fa-print me-2"></i> Cetak Tabel
                                </button>
                                <button class="btn btn-info" id="importExcelBtn">
                                    <i class="fas fa-file-import me-2"></i> Import dari Excel
                                </button>
                                <input type="file" id="importExcelInput" accept=".xlsx, .xls" class="d-none">
                                <button class="btn btn-secondary" id="clearAllBtn">
                                    <i class="fas fa-trash-alt me-2"></i> Hapus Semua Data
                                </button>
                            </div>
                        </div>
                        
                        <div class="table-responsive mt-4">
                            <table class="table table-hover data-table" id="mainDataTable">
                                <thead>
                                    <tr>
                                        <th>No</th>
                                        <th>Nama Penerima</th>
                                        <th>WhatsApp</th>
                                        <th>Desa</th>
                                        <th>Alamat</th>
                                        <th>Jenis Bantuan</th>
                                        <th>Jumlah</th>
                                        <th>Tanggal</th>
                                        <th>Link</th>
                                        <th>Aksi</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Data akan diisi oleh JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- Statistik Section -->
                    <div class="content-section d-none" id="statistik">
                        <h3 class="section-title">Statistik Data Bantuan</h3>
                        
                        <div class="row mb-4">
                            <div class="col-md-4">
                                <div class="stats-box">
                                    <div class="stats-icon">
                                        <i class="fas fa-users fa-2x text-primary"></i>
                                    </div>
                                    <div class="stats-number" id="statPenerima">0</div>
                                    <div class="stats-label">Total Penerima Bantuan</div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="stats-box">
                                    <div class="stats-icon">
                                        <i class="fas fa-map-marker-alt fa-2x text-success"></i>
                                    </div>
                                    <div class="stats-number" id="statDesa">0</div>
                                    <div class="stats-label">Desa Terjangkau</div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="stats-box">
                                    <div class="stats-icon">
                                        <i class="fas fa-box-open fa-2x text-warning"></i>
                                    </div>
                                    <div class="stats-number" id="statJenis">0</div>
                                    <div class="stats-label">Jenis Bantuan</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-header">
                                        <i class="fas fa-chart-bar me-2"></i> Distribusi Bantuan per Desa
                                    </div>
                                    <div class="card-body">
                                        <canvas id="statistikDesaChart" height="250"></canvas>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-header">
                                        <i class="fas fa-chart-pie me-2"></i> Distribusi Jenis Bantuan
                                    </div>
                                    <div class="card-body">
                                        <canvas id="statistikJenisChart" height="250"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mt-4">
                            <div class="col-md-12">
                                <div class="card">
                                    <div class="card-header">
                                        <i class="fas fa-chart-line me-2"></i> Trend Penyaluran per Bulan
                                    </div>
                                    <div class="card-body">
                                        <canvas id="trendBulananChart" height="250"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Pengaturan Section -->
                    <div class="content-section d-none" id="pengaturan">
                        <h3 class="section-title">Pengaturan Aplikasi</h3>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-header">
                                        <i class="fas fa-database me-2"></i> Kelola Data
                                    </div>
                                    <div class="card-body">
                                        <div class="d-grid gap-2">
                                            <button class="btn btn-success mb-2" id="backupDataBtn">
                                                <i class="fas fa-download me-2"></i> Backup Data ke File
                                            </button>
                                            <button class="btn btn-info mb-2" id="restoreDataBtn">
                                                <i class="fas fa-upload me-2"></i> Restore Data dari File
                                            </button>
                                            <input type="file" id="restoreDataInput" accept=".json" class="d-none">
                                            <button class="btn btn-warning mb-2" id="exportTemplateBtn">
                                                <i class="fas fa-file-alt me-2"></i> Unduh Template Excel
                                            </button>
                                            <button class="btn btn-danger" id="clearDataBtn">
                                                <i class="fas fa-trash-alt me-2"></i> Hapus Semua Data
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-header">
                                        <i class="fas fa-key me-2"></i> Keamanan
                                    </div>
                                    <div class="card-body">
                                        <div class="mb-3">
                                            <label class="form-label">
                                                <i class="fas fa-lock me-2"></i> Ubah Kode Keamanan
                                            </label>
                                            <div class="input-group">
                                                <input type="password" class="form-control" id="newSecurityCode" placeholder="Masukkan kode keamanan baru">
                                                <button class="btn btn-outline-secondary toggle-password" type="button">
                                                    <i class="fas fa-eye"></i>
                                                </button>
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">
                                                <i class="fas fa-building me-2"></i> Nama Instansi
                                            </label>
                                            <input type="text" class="form-control" id="institutionNameInput" placeholder="Masukkan nama instansi">
                                        </div>
                                        <button class="btn btn-primary" id="saveSettingsBtn">
                                            <i class="fas fa-save me-2"></i> Simpan Pengaturan
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mt-4">
                            <div class="col-md-12">
                                <div class="card">
                                    <div class="card-header">
                                        <i class="fas fa-info-circle me-2"></i> Informasi Aplikasi
                                    </div>
                                    <div class="card-body">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <table class="table table-borderless">
                                                    <tr>
                                                        <th width="40%">Nama Aplikasi</th>
                                                        <td>BARJAS (Sistem Bantuan Terpadu)</td>
                                                    </tr>
                                                    <tr>
                                                        <th>Versi</th>
                                                        <td>v2.1.0</td>
                                                    </tr>
                                                    <tr>
                                                        <th>Tanggal Rilis</th>
                                                        <td>15 Maret 2025</td>
                                                    </tr>
                                                    <tr>
                                                        <th>Developer</th>
                                                        <td>Lentera Karya Situbondo</td>
                                                    </tr>
                                                </table>
                                            </div>
                                            <div class="col-md-6">
                                                <table class="table table-borderless">
                                                    <tr>
                                                        <th width="40%">Total Data</th>
                                                        <td id="infoTotalData">0 data</td>
                                                    </tr>
                                                    <tr>
                                                        <th>Browser</th>
                                                        <td id="infoBrowser">-</td>
                                                    </tr>
                                                    <tr>
                                                        <th>Ukuran Layar</th>
                                                        <td id="infoScreenSize">-</td>
                                                    </tr>
                                                    <tr>
                                                        <th>Status</th>
                                                        <td><span class="badge bg-success" id="infoStatus">Aktif</span></td>
                                                    </tr>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="copyright">
                &copy; 2025 Dinas Peternakan dan Perikanan Kabupaten Situbondo - Developed by Lentera Karya Situbondo
            </div>
        </div>
        
        <!-- Floating Action Button -->
        <div class="floating-action-btn" id="fab">
            <i class="fas fa-plus"></i>
        </div>
        
        <!-- Notification Toast -->
        <div class="toast notification-toast" role="alert" aria-live="assertive" aria-atomic="true" id="notificationToast">
            <div class="toast-header">
                <i class="fas fa-bell me-2 text-primary"></i>
                <strong class="me-auto">Notifikasi</strong>
                <small>Baru saja</small>
                <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
            <div class="toast-body" id="toastMessage">
                Pesan notifikasi akan muncul di sini
            </div>
        </div>
    </div>
    
    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <script>
        // Inisialisasi variabel global
        window.jsPDF = window.jspdf.jsPDF;
        let securityCode = "123456"; // Kode default
        let loginAttempts = 0;
        let isBlocked = false;
        let blockTime = 0;
        let dataBantuan = [];
        let currentSection = 'dashboard';
        
        // DOM Elements
        const loginModal = new bootstrap.Modal(document.getElementById('loginModal'));
        const notificationToast = new bootstrap.Toast(document.getElementById('notificationToast'));
        const welcomeSplash = document.getElementById('welcomeSplash');
        const appContent = document.getElementById('appContent');
        const loginForm = document.getElementById('loginForm');
        const securityCodeInput = document.getElementById('securityCode');
        const loginButton = document.getElementById('loginButton');
        const loginSpinner = document.getElementById('loginSpinner');
        const attemptsCount = document.getElementById('attemptsCount');
        const blockedMessage = document.getElementById('blockedMessage');
        const countdownElement = document.getElementById('countdown');
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const sidebar = document.getElementById('sidebar');
        const sidebarOverlay = document.getElementById('sidebarOverlay');
        const navLinks = document.querySelectorAll('.nav-link[data-bs-target]');
        const contentSections = document.querySelectorAll('.content-section');
        const dataForm = document.getElementById('dataForm');
        const mainDataTable = document.getElementById('mainDataTable');
        const recentDataTable = document.getElementById('recentDataTable');
        const fab = document.getElementById('fab');
        
        // Fungsi untuk menampilkan notifikasi
        function showNotification(message, type = 'info') {
            const toastMessage = document.getElementById('toastMessage');
            toastMessage.textContent = message;
            
            const toastHeader = document.querySelector('#notificationToast .toast-header');
            toastHeader.classList.remove('text-primary', 'text-success', 'text-danger', 'text-warning');
            
            switch(type) {
                case 'success':
                    toastHeader.classList.add('text-success');
                    break;
                case 'error':
                    toastHeader.classList.add('text-danger');
                    break;
                case 'warning':
                    toastHeader.classList.add('text-warning');
                    break;
                default:
                    toastHeader.classList.add('text-primary');
            }
            
            notificationToast.show();
        }
        
        // Fungsi untuk memuat data dari localStorage
        function loadData() {
            const savedData = localStorage.getItem('dataBantuan');
            if (savedData) {
                dataBantuan = JSON.parse(savedData);
            }
            
            const savedCode = localStorage.getItem('securityCode');
            if (savedCode) {
                securityCode = savedCode;
            }
            
            const institutionName = localStorage.getItem('institutionName');
            if (institutionName) {
                document.getElementById('institutionName').textContent = institutionName;
                document.getElementById('institutionNameInput').value = institutionName;
            }
            
            updateDashboard();
            updateDataTable();
            updateRecentDataTable();
            updateStatistics();
        }
        
        // Fungsi untuk menyimpan data ke localStorage
        function saveData() {
            localStorage.setItem('dataBantuan', JSON.stringify(dataBantuan));
            localStorage.setItem('securityCode', securityCode);
            
            const institutionName = document.getElementById('institutionNameInput').value;
            if (institutionName) {
                localStorage.setItem('institutionName', institutionName);
                document.getElementById('institutionName').textContent = institutionName;
            }
        }
        
        // Fungsi untuk memperbarui dashboard
        function updateDashboard() {
            // Hitung total penerima
            document.getElementById('totalPenerima').textContent = dataBantuan.length;
            
            // Hitung total desa
            const desaSet = new Set(dataBantuan.map(item => item.desa));
            document.getElementById('totalDesa').textContent = desaSet.size;
            
            // Hitung total jenis bantuan
            const jenisSet = new Set(dataBantuan.map(item => item.jenisBantuan));
            document.getElementById('totalBantuan').textContent = jenisSet.size;
            
            // Perbarui grafik
            updateCharts();
        }
        
        // Fungsi untuk memperbarui tabel data utama
        function updateDataTable() {
            const tbody = mainDataTable.querySelector('tbody');
            tbody.innerHTML = '';
            
            dataBantuan.forEach((item, index) => {
                const row = document.createElement('tr');
                
                // Format nomor WhatsApp
                let whatsappDisplay = '-';
                if (item.whatsapp) {
                    whatsappDisplay = item.whatsapp.startsWith('62') ? item.whatsapp : `62${item.whatsapp}`;
                }
                
                // Format link Google Drive
                let linkDisplay = '-';
                if (item.linkDrive) {
                    linkDisplay = `<a href="${item.linkDrive}" target="_blank" class="drive-link">Lihat Dokumen</a>`;
                }
                
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${item.namaPenerima}</td>
                    <td>${whatsappDisplay}</td>
                    <td>${item.desa}</td>
                    <td>${item.alamat || '-'}</td>
                    <td>${item.jenisBantuan}</td>
                    <td>${item.jumlah}</td>
                    <td>${formatDate(item.tanggal)}</td>
                    <td>${linkDisplay}</td>
                    <td>
                        <div class="btn-group btn-group-sm">
                            <button class="btn btn-outline-primary view-btn" data-index="${index}">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn btn-outline-warning edit-btn" data-index="${index}">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-outline-danger delete-btn" data-index="${index}">
                                <i class="fas fa-trash"></i>
                            </button>
                            <button class="btn btn-outline-info print-btn" data-index="${index}">
                                <i class="fas fa-print"></i>
                            </button>
                        </div>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
            
            // Tambahkan event listener untuk tombol aksi
            attachTableActionListeners();
        }
        
        // Fungsi untuk memperbarui tabel data terbaru
        function updateRecentDataTable() {
            const tbody = recentDataTable.querySelector('tbody');
            tbody.innerHTML = '';
            
            // Ambil 5 data terbaru
            const recentData = [...dataBantuan]
                .sort((a, b) => new Date(b.tanggal) - new Date(a.tanggal))
                .slice(0, 5);
            
            recentData.forEach((item, index) => {
                const row = document.createElement('tr');
                
                // Format link Google Drive
                let linkDisplay = '-';
                if (item.linkDrive) {
                    linkDisplay = `<a href="${item.linkDrive}" target="_blank" class="drive-link">Lihat Dokumen</a>`;
                }
                
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${item.namaPenerima}</td>
                    <td>${item.desa}</td>
                    <td>${item.jenisBantuan}</td>
                    <td>${formatDate(item.tanggal)}</td>
                    <td>${linkDisplay}</td>
                `;
                
                tbody.appendChild(row);
            });
        }
        
        // Fungsi untuk memperbarui statistik
        function updateStatistics() {
            document.getElementById('statPenerima').textContent = dataBantuan.length;
            
            const desaSet = new Set(dataBantuan.map(item => item.desa));
            document.getElementById('statDesa').textContent = desaSet.size;
            
            const jenisSet = new Set(dataBantuan.map(item => item.jenisBantuan));
            document.getElementById('statJenis').textContent = jenisSet.size;
            
            updateStatisticCharts();
        }
        
        // Fungsi untuk memperbarui grafik
        function updateCharts() {
            // Grafik distribusi per desa
            const desaCount = {};
            dataBantuan.forEach(item => {
                desaCount[item.desa] = (desaCount[item.desa] || 0) + 1;
            });
            
            const desaCtx = document.getElementById('desaChart').getContext('2d');
            if (window.desaChartInstance) {
                window.desaChartInstance.destroy();
            }
            
            window.desaChartInstance = new Chart(desaCtx, {
                type: 'bar',
                data: {
                    labels: Object.keys(desaCount),
                    datasets: [{
                        label: 'Jumlah Penerima per Desa',
                        data: Object.values(desaCount),
                        backgroundColor: 'rgba(13, 71, 161, 0.7)',
                        borderColor: 'rgba(13, 71, 161, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
            
            // Grafik distribusi jenis bantuan
            const jenisCount = {};
            dataBantuan.forEach(item => {
                jenisCount[item.jenisBantuan] = (jenisCount[item.jenisBantuan] || 0) + 1;
            });
            
            const jenisCtx = document.getElementById('jenisBantuanChart').getContext('2d');
            if (window.jenisChartInstance) {
                window.jenisChartInstance.destroy();
            }
            
            window.jenisChartInstance = new Chart(jenisCtx, {
                type: 'pie',
                data: {
                    labels: Object.keys(jenisCount),
                    datasets: [{
                        data: Object.values(jenisCount),
                        backgroundColor: [
                            'rgba(13, 71, 161, 0.7)',
                            'rgba(0, 105, 92, 0.7)',
                            'rgba(255, 143, 0, 0.7)',
                            'rgba(106, 27, 154, 0.7)',
                            'rgba(229, 57, 53, 0.7)',
                            'rgba(2, 119, 189, 0.7)',
                            'rgba(216, 67, 21, 0.7)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }
        
        // Fungsi untuk memperbarui grafik statistik
        function updateStatisticCharts() {
            // Grafik distribusi per desa
            const desaCount = {};
            dataBantuan.forEach(item => {
                desaCount[item.desa] = (desaCount[item.desa] || 0) + 1;
            });
            
            const desaCtx = document.getElementById('statistikDesaChart').getContext('2d');
            if (window.statDesaChartInstance) {
                window.statDesaChartInstance.destroy();
            }
            
            window.statDesaChartInstance = new Chart(desaCtx, {
                type: 'bar',
                data: {
                    labels: Object.keys(desaCount),
                    datasets: [{
                        label: 'Jumlah Penerima per Desa',
                        data: Object.values(desaCount),
                        backgroundColor: 'rgba(0, 105, 92, 0.7)',
                        borderColor: 'rgba(0, 105, 92, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
            
            // Grafik distribusi jenis bantuan
            const jenisCount = {};
            dataBantuan.forEach(item => {
                jenisCount[item.jenisBantuan] = (jenisCount[item.jenisBantuan] || 0) + 1;
            });
            
            const jenisCtx = document.getElementById('statistikJenisChart').getContext('2d');
            if (window.statJenisChartInstance) {
                window.statJenisChartInstance.destroy();
            }
            
            window.statJenisChartInstance = new Chart(jenisCtx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(jenisCount),
                    datasets: [{
                        data: Object.values(jenisCount),
                        backgroundColor: [
                            'rgba(13, 71, 161, 0.7)',
                            'rgba(0, 105, 92, 0.7)',
                            'rgba(255, 143, 0, 0.7)',
                            'rgba(106, 27, 154, 0.7)',
                            'rgba(229, 57, 53, 0.7)',
                            'rgba(2, 119, 189, 0.7)',
                            'rgba(216, 67, 21, 0.7)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
            
            // Grafik trend bulanan
            const monthlyData = {};
            dataBantuan.forEach(item => {
                const date = new Date(item.tanggal);
                const monthYear = `${date.getMonth() + 1}/${date.getFullYear()}`;
                monthlyData[monthYear] = (monthlyData[monthYear] || 0) + 1;
            });
            
            const sortedMonths = Object.keys(monthlyData).sort((a, b) => {
                const [aMonth, aYear] = a.split('/').map(Number);
                const [bMonth, bYear] = b.split('/').map(Number);
                return aYear - bYear || aMonth - bMonth;
            });
            
            const monthlyValues = sortedMonths.map(month => monthlyData[month]);
            
            const trendCtx = document.getElementById('trendBulananChart').getContext('2d');
            if (window.trendChartInstance) {
                window.trendChartInstance.destroy();
            }
            
            window.trendChartInstance = new Chart(trendCtx, {
                type: 'line',
                data: {
                    labels: sortedMonths,
                    datasets: [{
                        label: 'Penyaluran per Bulan',
                        data: monthlyValues,
                        backgroundColor: 'rgba(255, 143, 0, 0.2)',
                        borderColor: 'rgba(255, 143, 0, 1)',
                        borderWidth: 2,
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
        }
        
        // Fungsi untuk memformat tanggal
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('id-ID', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric'
            });
        }
        
        // Fungsi untuk menampilkan login notification
        function showLoginNotification() {
            // Perbaikan: Cek apakah elemen dengan ID 'loginNotification' ada
            const loginNotification = document.getElementById('loginNotification');
            if (!loginNotification) {
                console.log("Elemen loginNotification tidak ditemukan");
                return;
            }
            
            loginNotification.classList.remove('d-none');
            loginNotification.innerHTML = `
                <div class="alert alert-info">
                    <i class="fas fa-info-circle me-2"></i>
                    <strong>Selamat datang!</strong> Anda telah berhasil login ke sistem BARJAS.
                </div>
            `;
            
            // Sembunyikan notifikasi setelah 5 detik
            setTimeout(() => {
                loginNotification.classList.add('d-none');
            }, 5000);
        }
        
        // Fungsi untuk menangani login
        function handleLogin(e) {
            e.preventDefault();
            
            if (isBlocked) {
                showNotification('Akun terkunci sementara. Silakan coba lagi nanti.', 'error');
                return;
            }
            
            const enteredCode = securityCodeInput.value.trim();
            
            if (enteredCode === securityCode) {
                // Login berhasil
                loginSpinner.classList.remove('d-none');
                loginButton.querySelector('.login-button-text').textContent = 'Memproses...';
                
                setTimeout(() => {
                    loginModal.hide();
                    appContent.classList.remove('app-content-unauthenticated');
                    showNotification('Login berhasil! Selamat datang di aplikasi BARJAS.', 'success');
                    showLoginNotification();
                    loginAttempts = 0;
                    attemptsCount.classList.add('d-none');
                    loginSpinner.classList.add('d-none');
                    loginButton.querySelector('.login-button-text').textContent = 'Masuk ke Aplikasi';
                    securityCodeInput.value = '';
                }, 1500);
            } else {
                // Login gagal
                loginAttempts++;
                
                if (loginAttempts >= 3) {
                    isBlocked = true;
                    blockTime = 30;
                    attemptsCount.classList.add('d-none');
                    blockedMessage.classList.remove('d-none');
                    
                    const countdownInterval = setInterval(() => {
                        countdownElement.textContent = blockTime;
                        blockTime--;
                        
                        if (blockTime < 0) {
                            clearInterval(countdownInterval);
                            isBlocked = false;
                            loginAttempts = 0;
                            blockedMessage.classList.add('d-none');
                            attemptsCount.classList.add('d-none');
                        }
                    }, 1000);
                    
                    showNotification('Terlalu banyak percobaan gagal. Akun terkunci sementara.', 'error');
                } else {
                    attemptsCount.textContent = `Percobaan gagal: ${loginAttempts} dari 3`;
                    attemptsCount.classList.remove('d-none');
                    securityCodeInput.classList.add('login-shake');
                    
                    setTimeout(() => {
                        securityCodeInput.classList.remove('login-shake');
                    }, 600);
                    
                    showNotification('Kode keamanan salah. Silakan coba lagi.', 'error');
                }
                
                securityCodeInput.value = '';
            }
        }
        
        // Fungsi untuk menangani logout
        function handleLogout() {
            appContent.classList.add('app-content-unauthenticated');
            loginModal.show();
            showNotification('Anda telah logout dari aplikasi.', 'info');
        }
        
        // Fungsi untuk menangani pengiriman form data
        function handleDataSubmit(e) {
            e.preventDefault();
            
            // Validasi form
            let isValid = true;
            
            const namaPenerima = document.getElementById('namaPenerima');
            const desa = document.getElementById('desa');
            const jenisBantuan = document.getElementById('jenisBantuan');
            const jumlah = document.getElementById('jumlah');
            const tanggal = document.getElementById('tanggal');
            const linkDrive = document.getElementById('linkDrive');
            
            // Validasi nama penerima
            if (!namaPenerima.value.trim()) {
                document.getElementById('namaError').style.display = 'block';
                namaPenerima.classList.add('input-error');
                isValid = false;
            } else {
                document.getElementById('namaError').style.display = 'none';
                namaPenerima.classList.remove('input-error');
            }
            
            // Validasi desa
            if (!desa.value) {
                document.getElementById('desaError').style.display = 'block';
                desa.classList.add('input-error');
                isValid = false;
            } else {
                document.getElementById('desaError').style.display = 'none';
                desa.classList.remove('input-error');
            }
            
            // Validasi jenis bantuan
            if (!jenisBantuan.value) {
                document.getElementById('jenisError').style.display = 'block';
                jenisBantuan.classList.add('input-error');
                isValid = false;
            } else {
                document.getElementById('jenisError').style.display = 'none';
                jenisBantuan.classList.remove('input-error');
            }
            
            // Validasi jumlah
            if (!jumlah.value || parseInt(jumlah.value) <= 0) {
                document.getElementById('jumlahError').style.display = 'block';
                jumlah.classList.add('input-error');
                isValid = false;
            } else {
                document.getElementById('jumlahError').style.display = 'none';
                jumlah.classList.remove('input-error');
            }
            
            // Validasi tanggal
            if (!tanggal.value) {
                document.getElementById('tanggalError').style.display = 'block';
                tanggal.classList.add('input-error');
                isValid = false;
            } else {
                document.getElementById('tanggalError').style.display = 'none';
                tanggal.classList.remove('input-error');
            }
            
            // Validasi link Google Drive (jika diisi)
            if (linkDrive.value && !isValidUrl(linkDrive.value)) {
                document.getElementById('linkError').style.display = 'block';
                linkDrive.classList.add('input-error');
                isValid = false;
            } else {
                document.getElementById('linkError').style.display = 'none';
                linkDrive.classList.remove('input-error');
            }
            
            if (!isValid) {
                showNotification('Harap periksa kembali form input. Terdapat data yang tidak valid.', 'error');
                return;
            }
            
            // Simpan data
            const newData = {
                id: Date.now(),
                namaPenerima: namaPenerima.value.trim(),
                whatsapp: document.getElementById('whatsapp').value.trim(),
                desa: desa.value,
                alamat: document.getElementById('alamat').value.trim(),
                jenisBantuan: jenisBantuan.value,
                jumlah: parseInt(jumlah.value),
                tanggal: tanggal.value,
                linkDrive: linkDrive.value.trim(),
                keterangan: document.getElementById('keterangan').value.trim(),
                createdAt: new Date().toISOString()
            };
            
            dataBantuan.push(newData);
            saveData();
            
            // Reset form
            dataForm.reset();
            
            // Perbarui UI
            updateDashboard();
            updateDataTable();
            updateRecentDataTable();
            updateStatistics();
            
            showNotification('Data berhasil disimpan!', 'success');
            
            // Scroll ke tabel data jika di section input data
            if (currentSection === 'inputData') {
                document.querySelector('[data-bs-target="dataTable"]').click();
            }
        }
        
        // Fungsi untuk memvalidasi URL
        function isValidUrl(string) {
            try {
                new URL(string);
                return true;
            } catch (_) {
                return false;
            }
        }
        
        // Fungsi untuk menambahkan event listener ke tombol aksi di tabel
        function attachTableActionListeners() {
            // Tombol lihat
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const index = this.getAttribute('data-index');
                    viewData(index);
                });
            });
            
            // Tombol edit
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const index = this.getAttribute('data-index');
                    editData(index);
                });
            });
            
            // Tombol hapus
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const index = this.getAttribute('data-index');
                    deleteData(index);
                });
            });
            
            // Tombol cetak per data
            document.querySelectorAll('.print-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const index = this.getAttribute('data-index');
                    printSingleData(index);
                });
            });
        }
        
        // Fungsi untuk melihat data
        function viewData(index) {
            const data = dataBantuan[index];
            
            let message = `
                <strong>Nama Penerima:</strong> ${data.namaPenerima}<br>
                <strong>WhatsApp:</strong> ${data.whatsapp || '-'}<br>
                <strong>Desa:</strong> ${data.desa}<br>
                <strong>Alamat:</strong> ${data.alamat || '-'}<br>
                <strong>Jenis Bantuan:</strong> ${data.jenisBantuan}<br>
                <strong>Jumlah:</strong> ${data.jumlah}<br>
                <strong>Tanggal:</strong> ${formatDate(data.tanggal)}<br>
            `;
            
            if (data.linkDrive) {
                message += `<strong>Link Dokumen:</strong> <a href="${data.linkDrive}" target="_blank">${data.linkDrive}</a><br>`;
            }
            
            if (data.keterangan) {
                message += `<strong>Keterangan:</strong> ${data.keterangan}<br>`;
            }
            
            showNotification(message, 'info');
        }
        
        // Fungsi untuk mengedit data
        function editData(index) {
            const data = dataBantuan[index];
            
            // Isi form dengan data yang ada
            document.getElementById('namaPenerima').value = data.namaPenerima;
            document.getElementById('whatsapp').value = data.whatsapp || '';
            document.getElementById('desa').value = data.desa;
            document.getElementById('alamat').value = data.alamat || '';
            document.getElementById('jenisBantuan').value = data.jenisBantuan;
            document.getElementById('jumlah').value = data.jumlah;
            document.getElementById('tanggal').value = data.tanggal;
            document.getElementById('linkDrive').value = data.linkDrive || '';
            document.getElementById('keterangan').value = data.keterangan || '';
            
            // Hapus data lama
            dataBantuan.splice(index, 1);
            saveData();
            
            // Perbarui UI
            updateDashboard();
            updateDataTable();
            updateRecentDataTable();
            updateStatistics();
            
            // Buka tab input data
            document.querySelector('[data-bs-target="inputData"]').click();
            
            showNotification('Data telah dimuat ke form. Silakan edit dan simpan perubahan.', 'info');
        }
        
        // Fungsi untuk menghapus data
        function deleteData(index) {
            if (confirm('Apakah Anda yakin ingin menghapus data ini?')) {
                dataBantuan.splice(index, 1);
                saveData();
                
                // Perbarui UI
                updateDashboard();
                updateDataTable();
                updateRecentDataTable();
                updateStatistics();
                
                showNotification('Data berhasil dihapus!', 'success');
            }
        }
        
        // Fungsi untuk mencetak data tunggal
        function printSingleData(index) {
            const data = dataBantuan[index];
            
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Cetak Data Bantuan - ${data.namaPenerima}</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        .header { text-align: center; margin-bottom: 20px; }
                        .header h2 { color: #0d47a1; }
                        .data-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
                        .data-table th, .data-table td { border: 1px solid #ddd; padding: 8px; }
                        .data-table th { background-color: #f2f2f2; text-align: left; }
                        .footer { margin-top: 30px; text-align: right; font-size: 14px; }
                        @media print {
                            body { margin: 0; }
                            .no-print { display: none; }
                        }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h2>DATA BANTUAN BARJAS</h2>
                        <p>${document.getElementById('institutionName').textContent}</p>
                    </div>
                    
                    <table class="data-table">
                        <tr>
                            <th width="30%">Nama Penerima</th>
                            <td>${data.namaPenerima}</td>
                        </tr>
                        <tr>
                            <th>Nomor WhatsApp</th>
                            <td>${data.whatsapp || '-'}</td>
                        </tr>
                        <tr>
                            <th>Desa</th>
                            <td>${data.desa}</td>
                        </tr>
                        <tr>
                            <th>Alamat</th>
                            <td>${data.alamat || '-'}</td>
                        </tr>
                        <tr>
                            <th>Jenis Bantuan</th>
                            <td>${data.jenisBantuan}</td>
                        </tr>
                        <tr>
                            <th>Jumlah</th>
                            <td>${data.jumlah}</td>
                        </tr>
                        <tr>
                            <th>Tanggal Penyaluran</th>
                            <td>${formatDate(data.tanggal)}</td>
                        </tr>
                        ${data.linkDrive ? `
                        <tr>
                            <th>Link Dokumen</th>
                            <td><a href="${data.linkDrive}">${data.linkDrive}</a></td>
                        </tr>
                        ` : ''}
                        ${data.keterangan ? `
                        <tr>
                            <th>Keterangan</th>
                            <td>${data.keterangan}</td>
                        </tr>
                        ` : ''}
                    </table>
                    
                    <div class="footer">
                        <p>Dicetak pada: ${new Date().toLocaleDateString('id-ID', { 
                            day: '2-digit', 
                            month: 'long', 
                            year: 'numeric',
                            hour: '2-digit',
                            minute: '2-digit'
                        })}</p>
                    </div>
                    
                    <div class="no-print" style="margin-top: 20px;">
                        <button onclick="window.print()">Cetak</button>
                        <button onclick="window.close()">Tutup</button>
                    </div>
                </body>
                </html>
            `);
            
            printWindow.document.close();
        }
        
        // Fungsi untuk mengekspor data ke Excel
        function exportToExcel() {
            if (dataBantuan.length === 0) {
                showNotification('Tidak ada data untuk diekspor.', 'warning');
                return;
            }
            
            // Siapkan data untuk diekspor
            const dataToExport = dataBantuan.map(item => ({
                'Nama Penerima': item.namaPenerima,
                'WhatsApp': item.whatsapp || '',
                'Desa': item.desa,
                'Alamat': item.alamat || '',
                'Jenis Bantuan': item.jenisBantuan,
                'Jumlah': item.jumlah,
                'Tanggal': formatDate(item.tanggal),
                'Link Dokumen': item.linkDrive || '',
                'Keterangan': item.keterangan || ''
            }));
            
            // Buat worksheet
            const ws = XLSX.utils.json_to_sheet(dataToExport);
            
            // Buat workbook
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Data Bantuan');
            
            // Ekspor ke file
            const fileName = `Data_Bantuan_BARJAS_${new Date().toISOString().split('T')[0]}.xlsx`;
            XLSX.writeFile(wb, fileName);
            
            showNotification('Data berhasil diekspor ke Excel.', 'success');
        }
        
        // Fungsi untuk mengekspor data ke PDF
        function exportToPDF() {
            if (dataBantuan.length === 0) {
                showNotification('Tidak ada data untuk diekspor.', 'warning');
                return;
            }
            
            const doc = new jsPDF();
            
            // Judul
            doc.setFontSize(18);
            doc.setTextColor(13, 71, 161);
            doc.text('DATA BANTUAN BARJAS', 105, 15, { align: 'center' });
            
            doc.setFontSize(12);
            doc.setTextColor(0, 0, 0);
            doc.text(`Instansi: ${document.getElementById('institutionName').textContent}`, 105, 22, { align: 'center' });
            doc.text(`Total Data: ${dataBantuan.length}`, 105, 29, { align: 'center' });
            
            // Siapkan data untuk tabel
            const tableData = dataBantuan.map(item => [
                item.namaPenerima,
                item.whatsapp || '-',
                item.desa,
                item.jenisBantuan,
                item.jumlah,
                formatDate(item.tanggal)
            ]);
            
            // Buat tabel
            doc.autoTable({
                startY: 35,
                head: [['Nama Penerima', 'WhatsApp', 'Desa', 'Jenis Bantuan', 'Jumlah', 'Tanggal']],
                body: tableData,
                theme: 'grid',
                headStyles: {
                    fillColor: [13, 71, 161],
                    textColor: [255, 255, 255],
                    fontStyle: 'bold'
                },
                alternateRowStyles: {
                    fillColor: [240, 240, 240]
                }
            });
            
            // Footer
            const pageCount = doc.internal.getNumberOfPages();
            for (let i = 1; i <= pageCount; i++) {
                doc.setPage(i);
                doc.setFontSize(10);
                doc.text(`Halaman ${i} dari ${pageCount}`, 105, doc.internal.pageSize.height - 10, { align: 'center' });
                doc.text(`Dicetak pada: ${new Date().toLocaleDateString('id-ID')}`, 105, doc.internal.pageSize.height - 5, { align: 'center' });
            }
            
            // Simpan PDF
            const fileName = `Data_Bantuan_BARJAS_${new Date().toISOString().split('T')[0]}.pdf`;
            doc.save(fileName);
            
            showNotification('Data berhasil diekspor ke PDF.', 'success');
        }
        
        // Fungsi untuk mencetak tabel
        function printTable() {
            if (dataBantuan.length === 0) {
                showNotification('Tidak ada data untuk dicetak.', 'warning');
                return;
            }
            
            // Buat elemen untuk cetak
            const printContent = document.createElement('div');
            printContent.innerHTML = `
                <div class="print-header">
                    <h2 class="print-title">DATA BANTUAN BARJAS</h2>
                    <p class="print-subtitle">${document.getElementById('institutionName').textContent}</p>
                    <p class="print-date">Dicetak pada: ${new Date().toLocaleDateString('id-ID', { 
                        day: '2-digit', 
                        month: 'long', 
                        year: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit'
                    })}</p>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>No</th>
                            <th>Nama Penerima</th>
                            <th>WhatsApp</th>
                            <th>Desa</th>
                            <th>Jenis Bantuan</th>
                            <th>Jumlah</th>
                            <th>Tanggal</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${dataBantuan.map((item, index) => `
                            <tr>
                                <td>${index + 1}</td>
                                <td>${item.namaPenerima}</td>
                                <td>${item.whatsapp || '-'}</td>
                                <td>${item.desa}</td>
                                <td>${item.jenisBantuan}</td>
                                <td>${item.jumlah}</td>
                                <td>${formatDate(item.tanggal)}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
            
            // Simpan HTML asli dan ganti dengan konten cetak
            const originalContent = document.body.innerHTML;
            document.body.innerHTML = printContent.innerHTML;
            
            // Cetak
            window.print();
            
            // Kembalikan konten asli
            document.body.innerHTML = originalContent;
            
            // Muat ulang event listeners
            loadEventListeners();
            
            showNotification('Tabel berhasil dicetak.', 'success');
        }
        
        // Fungsi untuk mengimpor data dari Excel
        function importFromExcel(file) {
            const reader = new FileReader();
            
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    
                    // Ambil sheet pertama
                    const worksheet = workbook.Sheets[workbook.SheetNames[0]];
                    const jsonData = XLSX.utils.sheet_to_json(worksheet);
                    
                    if (jsonData.length === 0) {
                        showNotification('File Excel tidak mengandung data.', 'error');
                        return;
                    }
                    
                    // Konversi data yang diimpor ke format yang sesuai
                    const importedData = jsonData.map(item => {
                        // Tangani berbagai format kolom
                        const namaPenerima = item['Nama Penerima'] || item['namaPenerima'] || item['Nama'] || '';
                        const whatsapp = item['WhatsApp'] || item['whatsapp'] || item['No WhatsApp'] || '';
                        const desa = item['Desa'] || item['desa'] || '';
                        const alamat = item['Alamat'] || item['alamat'] || '';
                        const jenisBantuan = item['Jenis Bantuan'] || item['jenisBantuan'] || item['Jenis'] || '';
                        const jumlah = item['Jumlah'] || item['jumlah'] || 1;
                        const tanggal = item['Tanggal'] || item['tanggal'] || new Date().toISOString().split('T')[0];
                        const linkDrive = item['Link Dokumen'] || item['linkDrive'] || item['Link'] || '';
                        const keterangan = item['Keterangan'] || item['keterangan'] || '';
                        
                        return {
                            id: Date.now() + Math.random(),
                            namaPenerima: namaPenerima.toString(),
                            whatsapp: whatsapp.toString(),
                            desa: desa.toString(),
                            alamat: alamat.toString(),
                            jenisBantuan: jenisBantuan.toString(),
                            jumlah: parseInt(jumlah) || 1,
                            tanggal: typeof tanggal === 'string' ? tanggal : new Date(tanggal).toISOString().split('T')[0],
                            linkDrive: linkDrive.toString(),
                            keterangan: keterangan.toString(),
                            createdAt: new Date().toISOString()
                        };
                    }).filter(item => item.namaPenerima && item.desa && item.jenisBantuan);
                    
                    if (importedData.length === 0) {
                        showNotification('Tidak ada data valid yang dapat diimpor.', 'error');
                        return;
                    }
                    
                    // Tambahkan data yang diimpor ke data existing
                    dataBantuan = [...dataBantuan, ...importedData];
                    saveData();
                    
                    // Perbarui UI
                    updateDashboard();
                    updateDataTable();
                    updateRecentDataTable();
                    updateStatistics();
                    
                    showNotification(`Berhasil mengimpor ${importedData.length} data dari Excel.`, 'success');
                    
                } catch (error) {
                    console.error('Error importing Excel:', error);
                    showNotification('Terjadi kesalahan saat mengimpor file Excel.', 'error');
                }
            };
            
            reader.onerror = function() {
                showNotification('Gagal membaca file Excel.', 'error');
            };
            
            reader.readAsArrayBuffer(file);
        }
        
        // Fungsi untuk menghapus semua data
        function clearAllData() {
            if (dataBantuan.length === 0) {
                showNotification('Tidak ada data untuk dihapus.', 'warning');
                return;
            }
            
            if (confirm('Apakah Anda yakin ingin menghapus SEMUA data? Tindakan ini tidak dapat dibatalkan.')) {
                dataBantuan = [];
                saveData();
                
                // Perbarui UI
                updateDashboard();
                updateDataTable();
                updateRecentDataTable();
                updateStatistics();
                
                showNotification('Semua data berhasil dihapus.', 'success');
            }
        }
        
        // Fungsi untuk membackup data
        function backupData() {
            if (dataBantuan.length === 0) {
                showNotification('Tidak ada data untuk dibackup.', 'warning');
                return;
            }
            
            const dataStr = JSON.stringify(dataBantuan, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = `backup_data_barjas_${new Date().toISOString().split('T')[0]}.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
            
            showNotification('Backup data berhasil dilakukan.', 'success');
        }
        
        // Fungsi untuk merestore data
        function restoreData(file) {
            const reader = new FileReader();
            
            reader.onload = function(e) {
                try {
                    const importedData = JSON.parse(e.target.result);
                    
                    if (!Array.isArray(importedData)) {
                        showNotification('File backup tidak valid.', 'error');
                        return;
                    }
                    
                    // Validasi data
                    const validData = importedData.filter(item => 
                        item.namaPenerima && item.desa && item.jenisBantuan
                    );
                    
                    if (validData.length === 0) {
                        showNotification('Tidak ada data valid dalam file backup.', 'error');
                        return;
                    }
                    
                    // Ganti data existing dengan data yang di-restore
                    dataBantuan = validData;
                    saveData();
                    
                    // Perbarui UI
                    updateDashboard();
                    updateDataTable();
                    updateRecentDataTable();
                    updateStatistics();
                    
                    showNotification(`Berhasil merestore ${validData.length} data dari backup.`, 'success');
                    
                } catch (error) {
                    console.error('Error restoring data:', error);
                    showNotification('Terjadi kesalahan saat merestore data.', 'error');
                }
            };
            
            reader.onerror = function() {
                showNotification('Gagal membaca file backup.', 'error');
            };
            
            reader.readAsText(file);
        }
        
        // Fungsi untuk mengekspor template Excel
        function exportTemplate() {
            const templateData = [{
                'Nama Penerima': 'Contoh Nama',
                'WhatsApp': '628123456789',
                'Desa': 'Sumberanyar',
                'Alamat': 'Alamat lengkap penerima',
                'Jenis Bantuan': 'Bibit Lele',
                'Jumlah': 10,
                'Tanggal': '2023-11-15',
                'Link Dokumen': 'https://drive.google.com/...',
                'Keterangan': 'Keterangan tambahan (opsional)'
            }];
            
            // Buat worksheet
            const ws = XLSX.utils.json_to_sheet(templateData);
            
            // Buat workbook
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Template');
            
            // Ekspor ke file
            const fileName = `Template_Import_Data_BARJAS.xlsx`;
            XLSX.writeFile(wb, fileName);
            
            showNotification('Template berhasil diunduh.', 'success');
        }
        
        // Fungsi untuk menyimpan pengaturan
        function saveSettings() {
            const newCode = document.getElementById('newSecurityCode').value.trim();
            
            if (newCode && newCode.length >= 4) {
                securityCode = newCode;
                localStorage.setItem('securityCode', securityCode);
                document.getElementById('newSecurityCode').value = '';
                showNotification('Kode keamanan berhasil diperbarui.', 'success');
            }
            
            const institutionName = document.getElementById('institutionNameInput').value;
            if (institutionName) {
                localStorage.setItem('institutionName', institutionName);
                document.getElementById('institutionName').textContent = institutionName;
                showNotification('Nama instansi berhasil diperbarui.', 'success');
            }
        }
        
        // Fungsi untuk memuat event listeners
        function loadEventListeners() {
            // Event listener untuk form login
            loginForm.addEventListener('submit', handleLogin);
            
            // Event listener untuk toggle password visibility
            document.querySelectorAll('.toggle-password').forEach(btn => {
                btn.addEventListener('click', function() {
                    const input = this.parentElement.querySelector('input');
                    const icon = this.querySelector('i');
                    
                    if (input.type === 'password') {
                        input.type = 'text';
                        icon.classList.remove('fa-eye');
                        icon.classList.add('fa-eye-slash');
                    } else {
                        input.type = 'password';
                        icon.classList.remove('fa-eye-slash');
                        icon.classList.add('fa-eye');
                    }
                });
            });
            
            // Event listener untuk tombol logout
            document.getElementById('logoutBtn').addEventListener('click', handleLogout);
            
            // Event listener untuk navigasi
            navLinks.forEach(link => {
                link.addEventListener('click', function() {
                    const target = this.getAttribute('data-bs-target');
                    
                    // Perbarui status aktif
                    navLinks.forEach(nav => nav.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Tampilkan section yang sesuai
                    contentSections.forEach(section => section.classList.add('d-none'));
                    document.getElementById(target).classList.remove('d-none');
                    
                    currentSection = target;
                    
                    // Perbarui UI berdasarkan section
                    if (target === 'dashboard') {
                        updateDashboard();
                    } else if (target === 'dataTable') {
                        updateDataTable();
                    } else if (target === 'statistik') {
                        updateStatistics();
                    }
                    
                    // Sembunyikan sidebar di mobile
                    if (window.innerWidth < 992) {
                        sidebar.classList.remove('mobile-show');
                        sidebarOverlay.classList.remove('mobile-show');
                    }
                });
            });
            
            // Event listener untuk mobile menu
            mobileMenuBtn.addEventListener('click', function() {
                sidebar.classList.add('mobile-show');
                sidebarOverlay.classList.add('mobile-show');
            });
            
            // Event listener untuk sidebar overlay
            sidebarOverlay.addEventListener('click', function() {
                sidebar.classList.remove('mobile-show');
                this.classList.remove('mobile-show');
            });
            
            // Event listener untuk form input data
            dataForm.addEventListener('submit', handleDataSubmit);
            
            // Event listener untuk test link Google Drive
            document.getElementById('testLinkBtn').addEventListener('click', function() {
                const link = document.getElementById('linkDrive').value.trim();
                if (link) {
                    if (isValidUrl(link)) {
                        window.open(link, '_blank');
                    } else {
                        showNotification('Format URL tidak valid.', 'error');
                    }
                } else {
                    showNotification('Masukkan link Google Drive terlebih dahulu.', 'warning');
                }
            });
            
            // Event listener untuk filter data
            document.getElementById('applyFilter').addEventListener('click', function() {
                // Implementasi filter akan ditambahkan kemudian
                showNotification('Fitur filter sedang dalam pengembangan.', 'info');
            });
            
            document.getElementById('resetFilter').addEventListener('click', function() {
                document.getElementById('filterDesa').value = '';
                document.getElementById('filterJenis').value = '';
                document.getElementById('filterTglMulai').value = '';
                document.getElementById('filterTglAkhir').value = '';
                showNotification('Filter telah direset.', 'info');
            });
            
            // Event listener untuk ekspor data
            document.getElementById('exportExcelBtn').addEventListener('click', exportToExcel);
            document.getElementById('exportPdfBtn').addEventListener('click', exportToPDF);
            document.getElementById('printBtn').addEventListener('click', printTable);
            
            // Event listener untuk impor data
            document.getElementById('importExcelBtn').addEventListener('click', function() {
                document.getElementById('importExcelInput').click();
            });
            
            document.getElementById('importExcelInput').addEventListener('change', function(e) {
                if (e.target.files.length > 0) {
                    importFromExcel(e.target.files[0]);
                    e.target.value = ''; // Reset input file
                }
            });
            
            // Event listener untuk hapus semua data
            document.getElementById('clearAllBtn').addEventListener('click', clearAllData);
            document.getElementById('clearDataBtn').addEventListener('click', clearAllData);
            
            // Event listener untuk backup dan restore data
            document.getElementById('backupDataBtn').addEventListener('click', backupData);
            
            document.getElementById('restoreDataBtn').addEventListener('click', function() {
                document.getElementById('restoreDataInput').click();
            });
            
            document.getElementById('restoreDataInput').addEventListener('change', function(e) {
                if (e.target.files.length > 0) {
                    if (confirm('Restore data akan mengganti semua data yang ada. Lanjutkan?')) {
                        restoreData(e.target.files[0]);
                    }
                    e.target.value = ''; // Reset input file
                }
            });
            
            // Event listener untuk export template
            document.getElementById('exportTemplateBtn').addEventListener('click', exportTemplate);
            
            // Event listener untuk simpan pengaturan
            document.getElementById('saveSettingsBtn').addEventListener('click', saveSettings);
            
            // Event listener untuk floating action button
            fab.addEventListener('click', function() {
                document.querySelector('[data-bs-target="inputData"]').click();
            });
            
            // Event listener untuk pencarian desa
            document.getElementById('desaSearch').addEventListener('input', function() {
                const searchValue = this.value.toLowerCase();
                const options = document.getElementById('desa').options;
                
                for (let i = 0; i < options.length; i++) {
                    const option = options[i];
                    if (option.text.toLowerCase().includes(searchValue)) {
                        option.style.display = '';
                    } else {
                        option.style.display = 'none';
                    }
                }
            });
            
            // Event listener untuk welcome splash screen
            document.getElementById('closeSplash').addEventListener('click', function() {
                welcomeSplash.style.opacity = '0';
                setTimeout(() => {
                    welcomeSplash.style.display = 'none';
                    loginModal.show();
                }, 500);
            });
        }
        
        // Fungsi untuk inisialisasi aplikasi
        function initApp() {
            // Muat data
            loadData();
            
            // Muat event listeners
            loadEventListeners();
            
            // Tampilkan informasi browser dan layar
            document.getElementById('infoBrowser').textContent = navigator.userAgent;
            document.getElementById('infoScreenSize').textContent = `${window.innerWidth} x ${window.innerHeight} px`;
            document.getElementById('infoTotalData').textContent = `${dataBantuan.length} data`;
            
            // Tampilkan welcome splash screen
            setTimeout(() => {
                welcomeSplash.style.opacity = '0';
                setTimeout(() => {
                    welcomeSplash.style.display = 'none';
                    loginModal.show();
                }, 500);
            }, 5000);
            
            // Countdown untuk splash screen
            let countdown = 5;
            const countdownInterval = setInterval(() => {
                countdown--;
                document.getElementById('countdownTimer').textContent = countdown;
                
                if (countdown <= 0) {
                    clearInterval(countdownInterval);
                }
            }, 1000);
        }
        
        // Inisialisasi aplikasi ketika DOM sudah dimuat
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
