<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APLIKASI BARJAS - SISTEM BANTUAN</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary-color: #0d47a1;
            --secondary-color: #00695c;
            --accent-color: #ff8f00;
            --light-blue: #e3f2fd;
            --dark-blue: #082e5c;
            --gradient-primary: linear-gradient(135deg, var(--primary-color), var(--dark-blue));
            --gradient-secondary: linear-gradient(135deg, var(--secondary-color), #004d40);
            --gradient-accent: linear-gradient(135deg, var(--accent-color), #e65100);
            --shadow-sm: 0 2px 8px rgba(0,0,0,0.08);
            --shadow-md: 0 4px 16px rgba(0,0,0,0.12);
            --shadow-lg: 0 8px 28px rgba(0,0,0,0.15);
            --login-gradient: linear-gradient(135deg, #0d47a1, #00695c, #ff8f00);
        }
        
        body {
            background: linear-gradient(135deg, #f5f9ff 0%, #e8f5e9 100%);
            font-family: 'Poppins', 'Segoe UI', sans-serif;
            min-height: 100vh;
            padding: 10px 0;
            overflow-x: hidden;
        }
        
        .app-container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            box-shadow: var(--shadow-lg);
            border-radius: 12px;
            overflow: hidden;
            position: relative;
            z-index: 10;
        }
        
        .app-header {
            background: var(--gradient-primary);
            color: white;
            padding: 20px 15px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .app-header::before {
            content: "";
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.15) 0%, transparent 70%);
            pointer-events: none;
        }
        
        .app-logo {
            font-size: 2.5rem;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }
        
        .app-title {
            font-size: 1.8rem;
            font-weight: 800;
            margin: 0;
            position: relative;
            z-index: 1;
            text-shadow: 1px 1px 4px rgba(0,0,0,0.3);
        }
        
        .app-subtitle {
            font-size: 1rem;
            opacity: 0.95;
            position: relative;
            z-index: 1;
            font-weight: 300;
            letter-spacing: 0.5px;
            margin-bottom: 5px;
        }
        
        .nav-pills .nav-link {
            border-radius: 8px;
            margin-bottom: 8px;
            padding: 12px 15px;
            font-weight: 500;
            color: #444;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            font-size: 0.9rem;
        }
        
        .nav-pills .nav-link:hover {
            background-color: #f0f7ff;
            transform: translateX(3px);
        }
        
        .nav-pills .nav-link.active {
            background: var(--gradient-primary);
            font-weight: 600;
            box-shadow: var(--shadow-md);
            transform: translateX(3px);
            color: white;
        }
        
        .section-title {
            border-left: 4px solid var(--primary-color);
            padding-left: 12px;
            margin: 20px 0;
            font-weight: 700;
            color: var(--dark-blue);
            font-size: 1.4rem;
            position: relative;
        }
        
        .section-title::after {
            content: "";
            position: absolute;
            bottom: -5px;
            left: 12px;
            width: 40px;
            height: 2px;
            background: var(--gradient-primary);
            border-radius: 2px;
        }
        
        .btn-primary {
            background: var(--gradient-primary);
            border: none;
            padding: 10px 20px;
            font-weight: 600;
            box-shadow: var(--shadow-md);
            border-radius: 8px;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .btn-success {
            background: var(--gradient-secondary);
            border: none;
            padding: 10px 20px;
            font-weight: 600;
            box-shadow: var(--shadow-md);
            border-radius: 8px;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .btn-warning {
            background: var(--gradient-accent);
            border: none;
            padding: 10px 20px;
            font-weight: 600;
            box-shadow: var(--shadow-md);
            border-radius: 8px;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .btn-warning:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .form-label {
            font-weight: 600;
            color: #444;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            font-size: 0.9rem;
        }
        
        .form-label i {
            margin-right: 6px;
            color: var(--primary-color);
        }
        
        .form-control, .form-select {
            border-radius: 8px;
            padding: 12px 15px;
            border: 1px solid #ddd;
            transition: all 0.3s;
            box-shadow: var(--shadow-sm);
            font-size: 0.9rem;
        }
        
        .form-control:focus, .form-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(13, 71, 161, 0.2);
            transform: translateY(-2px);
        }
        
        .copyright {
            text-align: center;
            padding: 20px;
            background-color: var(--light-blue);
            color: var(--dark-blue);
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .data-table {
            font-size: 0.85rem;
            border-collapse: separate;
            border-spacing: 0;
            box-shadow: var(--shadow-sm);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .data-table th {
            background: var(--gradient-primary);
            color: white;
            font-weight: 600;
            padding: 12px 10px;
            text-align: center;
            position: relative;
            font-size: 0.85rem;
        }
        
        .data-table th::after {
            content: "";
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 1px;
            background: rgba(255,255,255,0.3);
        }
        
        .data-table td {
            padding: 10px 8px;
            vertical-align: middle;
            border-bottom: 1px solid #eee;
            font-size: 0.85rem;
        }
        
        .data-table tr:nth-child(even) {
            background-color: #f9fbff;
        }
        
        .data-table tr:hover {
            background-color: #edf5ff;
        }
        
        .feature-icon {
            font-size: 1.1rem;
            margin-right: 8px;
            width: 24px;
            text-align: center;
        }
        
        .card {
            border-radius: 10px;
            border: none;
            box-shadow: var(--shadow-md);
            transition: all 0.3s ease;
            overflow: hidden;
            margin-bottom: 15px;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        
        .card-header {
            border-radius: 10px 10px 0 0 !important;
            font-weight: 600;
            padding: 15px 20px;
            background: var(--gradient-primary);
            color: white;
            font-size: 0.95rem;
        }
        
        .stats-box {
            text-align: center;
            padding: 20px 15px;
            border-radius: 10px;
            background: white;
            box-shadow: var(--shadow-md);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
            margin-bottom: 15px;
        }
        
        .stats-box::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--gradient-primary);
            border-radius: 2px;
        }
        
        .stats-box:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }
        
        .stats-number {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--primary-color);
            margin: 10px 0;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        
        .stats-label {
            font-size: 0.9rem;
            color: #666;
            font-weight: 500;
        }
        
        .notification-toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1050;
            min-width: 280px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: var(--shadow-lg);
            max-width: calc(100vw - 40px);
        }
        
        .input-error {
            border-color: #dc3545;
            box-shadow: 0 0 0 3px rgba(220, 53, 69, 0.2);
        }
        
        .error-message {
            color: #dc3545;
            font-size: 0.8rem;
            margin-top: 5px;
            display: none;
            font-weight: 500;
        }
        
        .watermark {
            position: absolute;
            bottom: 10px;
            right: 15px;
            opacity: 0.8;
            font-size: 0.8rem;
            color: white;
            font-weight: 300;
        }
        
        .control-panel {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            box-shadow: var(--shadow-sm);
        }
        
        .control-title {
            font-size: 1rem;
            color: var(--primary-color);
            font-weight: 600;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--light-blue);
        }
        
        .floating-action-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--gradient-primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .floating-action-btn:hover {
            transform: scale(1.1) rotate(90deg);
        }
        
        .filter-section {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-sm);
        }
        
        .badge-custom {
            background: var(--gradient-primary);
            color: white;
            padding: 6px 12px;
            border-radius: 16px;
            font-weight: 600;
            font-size: 0.8rem;
        }
        
        .mobile-menu-btn {
            display: none;
            position: fixed;
            top: 15px;
            left: 15px;
            z-index: 1050;
            background: var(--gradient-primary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            box-shadow: var(--shadow-lg);
        }
        
        .sidebar-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1040;
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-fadeIn {
            animation: fadeIn 0.5s ease forwards;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 8px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 8px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--dark-blue);
        }
        
        /* Responsive styles */
        @media (max-width: 991.98px) {
            .col-md-3.col-lg-2 {
                position: fixed;
                left: -300px;
                top: 0;
                bottom: 0;
                z-index: 1050;
                width: 280px;
                transition: left 0.3s ease;
                overflow-y: auto;
                padding-top: 60px;
            }
            
            .col-md-3.col-lg-2.mobile-show {
                left: 0;
            }
            
            .col-md-9.col-lg-10 {
                width: 100%;
                flex: 0 0 100%;
                max-width: 100%;
            }
            
            .mobile-menu-btn {
                display: flex;
                align-items: center;
                justify-content: center;
            }
            
            .sidebar-overlay.mobile-show {
                display: block;
            }
        }
        
        /* Print Styles - IMPROVED FOR LANDSCAPE */
        @media print {
            @page {
                size: landscape;
                margin: 0.5cm;
            }
            
            body * {
                visibility: hidden;
            }
            
            .app-container, .app-container * {
                visibility: visible;
            }
            
            .app-container {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                box-shadow: none;
            }
            
            .nav-pills, .mobile-menu-btn, .sidebar-overlay, .floating-action-btn,
            .btn-group, .filter-section, .toast {
                display: none !important;
            }
            
            .col-md-3.col-lg-2.p-4.bg-light {
                display: none !important;
            }
            
            .col-md-9.col-lg-10.p-5 {
                width: 100%;
                flex: 0 0 100%;
                max-width: 100%;
                padding: 0 !important;
            }
            
            .copyright {
                display: none;
            }
            
            .data-table {
                font-size: 10px;
                width: 100% !important;
            }
            
            .data-table th, .data-table td {
                padding: 4px 2px;
            }
            
            /* Sembunyikan kolom aksi dan link Google Drive saat mencetak */
            .data-table th:last-child,
            .data-table td:last-child {
                display: none !important;
            }
            
            /* Judul untuk laporan cetak */
            .print-header {
                display: block !important;
                text-align: center;
                margin-bottom: 15px;
            }
            
            .print-title {
                font-size: 18px;
                font-weight: bold;
                margin-bottom: 5px;
            }
            
            .print-subtitle {
                font-size: 14px;
                margin-bottom: 10px;
            }
            
            .print-date {
                font-size: 12px;
                text-align: right;
                margin-bottom: 10px;
            }
        }

        /* WhatsApp link style */
        .whatsapp-link {
            color: #25D366;
            text-decoration: none;
        }
        
        .whatsapp-link:hover {
            text-decoration: underline;
        }
        
        /* View Link Button */
        .btn-view {
            background: linear-gradient(135deg, #17a2b8, #138496);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
        }
        
        .btn-view:hover {
            background: linear-gradient(135deg, #138496, #117a8b);
            color: white;
        }
        
        /* Undo Button */
        .btn-undo {
            background: linear-gradient(135deg, #6c757d, #5a6268);
            color: white;
            border: none;
        }
        
        .btn-undo:hover {
            background: linear-gradient(135deg, #5a6268, #4e555b);
            color: white;
        }
        
        /* WhatsApp number link in table */
        .whatsapp-number {
            color: #25D366;
            cursor: pointer;
            text-decoration: underline;
        }
        
        /* Welcome Modal Styles */
        .welcome-modal .modal-content {
            border-radius: 15px;
            overflow: hidden;
            border: none;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .welcome-header {
            background: var(--gradient-primary);
            color: white;
            text-align: center;
            padding: 25px;
        }
        
        .welcome-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }
        
        .welcome-body {
            padding: 25px;
            text-align: center;
        }
        
        .welcome-footer {
            background: #f8f9fa;
            padding: 15px;
            text-align: center;
            border-top: 1px solid #eee;
        }
        
        .countdown-timer {
            font-size: 0.9rem;
            color: #6c757d;
            margin-top: 10px;
        }
        
        /* Button untuk cetak per data */
        .btn-print-individual {
            background: linear-gradient(135deg, #6f42c1, #5a2d95);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
        }
        
        .btn-print-individual:hover {
            background: linear-gradient(135deg, #5a2d95, #4a2479);
            color: white;
        }
        
        /* Developer Info Styles */
        .developer-info {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: var(--shadow-sm);
        }
        
        .developer-logo {
            max-width: 120px;
            margin-bottom: 15px;
            border-radius: 8px;
        }
        
        .developer-contact a {
            color: var(--primary-color);
            text-decoration: none;
            transition: all 0.3s;
        }
        
        .developer-contact a:hover {
            color: var(--dark-blue);
            text-decoration: underline;
        }
        
        /* Welcome Splash Screen */
        .welcome-splash {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient-primary);
            color: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }
        
        .welcome-splash-content {
            text-align: center;
            max-width: 600px;
            padding: 30px;
        }
        
        .welcome-splash-logo {
            font-size: 4rem;
            margin-bottom: 20px;
        }
        
        .welcome-splash-title {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 15px;
        }
        
        .welcome-splash-message {
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 25px;
        }
        
        .welcome-splash-countdown {
            font-size: 1rem;
            margin-top: 20px;
        }
        
        .welcome-splash-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .welcome-splash-close:hover {
            background: rgba(255,255,255,0.3);
            transform: rotate(90deg);
        }
        
        /* Loading spinner */
        .spinner-border-sm {
            width: 1rem;
            height: 1rem;
        }

        /* Login Modal Styles */
        .login-modal .modal-content {
            border-radius: 15px;
            overflow: hidden;
            border: none;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .login-header {
            background: var(--login-gradient);
            color: white;
            text-align: center;
            padding: 25px 20px;
            position: relative;
        }

        .login-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            color: white;
        }

        .login-title {
            font-size: 1.8rem;
            font-weight: 700;
            margin: 0;
        }

        .login-subtitle {
            font-size: 1rem;
            opacity: 0.9;
            margin: 5px 0 0;
        }

        .login-body {
            padding: 25px;
        }

        .login-form-group {
            margin-bottom: 20px;
        }

        .login-form-label {
            font-weight: 600;
            color: var(--dark-blue);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
        }

        .login-form-label i {
            margin-right: 10px;
            color: var(--dark-blue);
        }

        .login-form-control {
            border-radius: 8px;
            padding: 12px 15px;
            border: 2px solid #ddd;
            transition: all 0.3s;
        }

        .login-form-control:focus {
            border-color: var(--dark-blue);
            box-shadow: 0 0 0 3px rgba(13, 71, 161, 0.2);
        }

        .login-input-group-text {
            background: var(--light-blue);
            border: 2px solid #ddd;
            border-left: none;
        }

        .btn-login {
            background: var(--gradient-secondary);
            color: white;
            border: none;
            padding: 12px;
            font-weight: 600;
            border-radius: 8px;
            width: 100%;
            transition: all 0.3s;
            margin-top: 10px;
        }

        .btn-login:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 105, 92, 0.4);
        }

        .btn-login:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .login-security-notice {
            text-align: center;
            margin-top: 20px;
            font-size: 0.85rem;
            color: #666;
        }

        .login-attempts-count {
            text-align: center;
            font-size: 0.9rem;
            color: #ff8f00;
            font-weight: 500;
            margin-top: 5px;
        }

        .login-blocked-message {
            text-align: center;
            background: rgba(220, 53, 69, 0.1);
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            color: #dc3545;
            font-weight: 500;
        }

        .login-countdown {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--dark-blue);
        }

        .login-developer-info {
            background: var(--light-blue);
            border-radius: 10px;
            padding: 20px;
            margin-top: 25px;
            text-align: center;
        }

        .login-developer-logo {
            max-width: 180px;
            margin-bottom: 15px;
            border-radius: 8px;
        }

        .login-developer-contact a {
            color: var(--dark-blue);
            text-decoration: none;
            transition: all 0.3s;
            display: inline-block;
            margin: 5px 0;
        }

        .login-developer-contact a:hover {
            color: var(--primary-color);
            text-decoration: underline;
            transform: translateY(-2px);
        }

        .login-copyright {
            text-align: center;
            margin-top: 20px;
            color: #666;
            font-size: 0.9rem;
            opacity: 0.9;
        }

        /* Animations */
        @keyframes login-shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-10px); }
            20%, 40%, 60%, 80% { transform: translateX(10px); }
        }

        .login-shake {
            animation: login-shake 0.6s cubic-bezier(.36,.07,.19,.97) both;
        }

        /* Login particle background */
        #login-particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1040; /* Higher than modal backdrop */
            display: none;
        }

        /* Link Google Drive dalam tabel */
        .drive-link {
            color: #0d47a1;
            text-decoration: none;
            cursor: pointer;
        }

        .drive-link:hover {
            text-decoration: underline;
        }

        /* Modal untuk menambah link */
        .link-modal .modal-dialog {
            max-width: 600px;
        }
    </style>
</head>
<body>
    <!-- Login Modal -->
    <div class="modal fade login-modal" id="loginModal" tabindex="-1" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="login-header">
                    <div class="login-icon">
                        <i class="fas fa-lock"></i>
                    </div>
                    <h2 class="login-title">AUTHENTICATION REQUIRED</h2>
                    <p class="login-subtitle">Masukkan Kode Keamanan untuk Mengakses Aplikasi</p>
                </div>
                <div class="login-body">
                    <form id="loginForm">
                        <div class="mb-3 login-form-group">
                            <label class="form-label login-form-label">
                                <i class="fas fa-key"></i> Kode Keamanan
                            </label>
                            <div class="input-group">
                                <input type="password" class="form-control login-form-control" id="securityCode" placeholder="Masukkan kode akses aplikasi">
                                <button class="btn btn-outline-secondary toggle-password" type="button">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                            <div class="form-text text-danger login-attempts-count" id="attemptsCount"></div>
                        </div>
                        <button type="submit" class="btn btn-login" id="loginButton">
                            <span class="login-button-text">Masuk ke Aplikasi</span>
                            <span class="spinner-border spinner-border-sm d-none" id="loginSpinner"></span>
                        </button>
                    </form>
                    
                    <div class="login-blocked-message d-none" id="blockedMessage">
                        <i class="fas fa-ban me-2"></i>
                        <span id="blockedText">Terlalu banyak percobaan gagal. Silakan coba lagi dalam </span>
                        <span class="login-countdown" id="countdown">30</span> detik.
                    </div>
                    
                    <div class="login-security-notice">
                        <i class="fas fa-info-circle me-2"></i>
                        Hubungi Administrator untuk mendapatkan kode akses
                    </div>
                    
                    <div class="login-developer-info">
                        <h5 class="mb-3">Developer Information</h5>
                        <div class="login-developer-contact">
                            <p><i class="fab fa-whatsapp me-2"></i> <a href="https://wa.me/6285647709114" target="_blank">+62 856-4770-9114</a></p>
                            <p><i class="fas fa-envelope me-2"></i> <a href="mailto:admin@anekamarket.my.id">admin@anekamarket.my.id</a></p>
                        </div>
                    </div>
                    
                    <div class="login-copyright">
                        &copy; 2025 Lentera karya Situbondo
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Login particle background -->
    <div id="login-particles"></div>
    
    <!-- Welcome Splash Screen -->
    <div class="welcome-splash" id="welcomeSplash">
        <button class="welcome-splash-close" id="closeSplash">
            <i class="fas fa-times"></i>
        </button>
        <div class="welcome-splash-content">
            <div class="welcome-splash-logo">
                <i class="fas fa-hands-helping"></i>
            </div>
            <h1 class="welcome-splash-title">SISTEM BANTUAN BARJAS</h1>
            <p class="welcome-splash-message">
                Aplikasi Sistem Bantuan BARJAS merupakan platform terpadu yang dirancang untuk mentransformasi pendataan, penyaluran, 
                dan monitoring program bantuan pemerintah. Aplikasi ini kami ciptakan untuk mendorong efisiensi, akurasi, 
                dan transparansi dalam pengelolaan bantuan, guna mempercepat penyerapan dan meningkatkan akuntabilitas.
            </p>
            <div class="welcome-splash-countdown" id="splashCountdown">
                Membuka aplikasi dalam <span id="countdownTimer">5</span> detik...
            </div>
        </div>
    </div>
    
    <!-- Mobile Menu Button -->
    <button class="mobile-menu-btn" id="mobileMenuBtn">
        <i class="fas fa-bars"></i>
    </button>
    
    <!-- Sidebar Overlay -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>
    
    <div class="app-container animate-fadeIn">
        <div class="app-header">
            <div class="app-logo">
                <i class="fas fa-hands-helping"></i>
            </div>
            <h1 class="app-title">BARJAS</h1>
            <p class="app-subtitle">Sistem Bantuan Terpadu</p>
            <p class="app-subtitle" id="institutionName">Dinas Peternakan dan Perikanan Kabupaten Situbondo</p>
            <div class="watermark">v2.1.0</div>
        </div>
        
        <div class="row g-0">
            <!-- Sidebar Navigation -->
            <div class="col-md-3 col-lg-2 p-4 bg-light" id="sidebar">
                <ul class="nav nav-pills flex-column mb-auto">
                    <li class="nav-item">
                        <a href="#" class="nav-link active" data-bs-target="dashboard">
                            <span class="feature-icon"><i class="fas fa-home"></i></span>
                            Dashboard
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-bs-target="inputData">
                            <span class="feature-icon"><i class="fas fa-pen-to-square"></i></span>
                            Input Data Bantuan
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-bs-target="dataTable">
                            <span class="feature-icon"><i class="fas fa-table"></i></span>
                            Tabel Data
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-bs-target="settings">
                            <span class="feature-icon"><i class="fas fa-gear"></i></span>
                            Pengaturan
                        </a>
                    </li>
                </ul>
                
                <div class="developer-info">
                    <h6 class="mb-3">Developer Information</h6>
                    <div class="developer-contact">
                        <p><i class="fab fa-whatsapp me-2"></i> <a href="https://wa.me/6285647709114" target="_blank">+62 856-4770-9114</a></p>
                        <p><i class="fas fa-envelope me-2"></i> <a href="mailto:admin@anekamarket.my.id">admin@anekamarket.my.id</a></p>
                    </div>
                </div>
            </div>
            
            <!-- Main Content -->
            <div class="col-md-9 col-lg-10 p-5" id="mainContent">
                <!-- Dashboard Section -->
                <div class="content-section" id="dashboard">
                    <h3 class="section-title">Dashboard</h3>
                    
                    <div class="row">
                        <div class="col-md-3">
                            <div class="stats-box">
                                <div class="stats-icon">
                                    <i class="fas fa-users fa-2x text-primary"></i>
                                </div>
                                <div class="stats-number" id="totalPenerima">0</div>
                                <div class="stats-label">Total Penerima Bantuan</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stats-box">
                                <div class="stats-icon">
                                    <i class="fas fa-box-open fa-2x text-success"></i>
                                </div>
                                <div class="stats-number" id="totalBantuan">0</div>
                                <div class="stats-label">Total Jenis Bantuan</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stats-box">
                                <div class="stats-icon">
                                    <i class="fas fa-check-circle fa-2x text-info"></i>
                                </div>
                                <div class="stats-number" id="totalTersalurkan">0</div>
                                <div class="stats-label">Bantuan Tersalurkan</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stats-box">
                                <div class="stats-icon">
                                    <i class="fas fa-chart-line fa-2x text-warning"></i>
                                </div>
                                <div class="stats-number" id="persentase">0%</div>
                                <div class="stats-label">Tingkat Penyerapan</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row mt-4">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <i class="fas fa-chart-pie me-2"></i> Distribusi Bantuan per Jenis
                                </div>
                                <div class="card-body">
                                    <canvas id="jenisBantuanChart" height="250"></canvas>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <i class="fas fa-chart-bar me-2"></i> Bantuan per Kecamatan
                                </div>
                                <div class="card-body">
                                    <canvas id="kecamatanChart" height="250"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row mt-4">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header">
                                    <i class="fas fa-history me-2"></i> Aktivitas Terbaru
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-hover data-table">
                                            <thead>
                                                <tr>
                                                    <th>No</th>
                                                    <th>Tanggal</th>
                                                    <th>Nama Penerima</th>
                                                    <th>Jenis Bantuan</th>
                                                    <th>Kecamatan</th>
                                                    <th>Status</th>
                                                </tr>
                                            </thead>
                                            <tbody id="recentActivities">
                                                <!-- Data aktivitas akan diisi oleh JavaScript -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Input Data Section -->
                <div class="content-section d-none" id="inputData">
                    <h3 class="section-title">Input Data Bantuan</h3>
                    
                    <form id="bantuanForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label"><i class="fas fa-user"></i> Nama Penerima</label>
                                    <input type="text" class="form-control" id="namaPenerima" required>
                                    <div class="error-message" id="namaPenerimaError">Nama penerima harus diisi</div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label"><i class="fas fa-id-card"></i> NIK</label>
                                    <input type="text" class="form-control" id="nik" required>
                                    <div class="error-message" id="nikError">NIK harus diisi dengan 16 digit angka</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label"><i class="fas fa-phone"></i> Nomor Telepon</label>
                                    <input type="text" class="form-control" id="noTelepon" required>
                                    <div class="error-message" id="noTeleponError">Nomor telepon harus diisi</div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label"><i class="fas fa-map-marker-alt"></i> Alamat</label>
                                    <textarea class="form-control" id="alamat" rows="1" required></textarea>
                                    <div class="error-message" id="alamatError">Alamat harus diisi</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label class="form-label"><i class="fas fa-map-marked-alt"></i> Kecamatan</label>
                                    <select class="form-select" id="kecamatan" required>
                                        <option value="">Pilih Kecamatan</option>
                                        <option value="Arjasa">Arjasa</option>
                                        <option value="Asembagus">Asembagus</option>
                                        <option value="Banyuglugur">Banyuglugur</option>
                                        <option value="Banyuputih">Banyuputih</option>
                                        <option value="Besuki">Besuki</option>
                                        <option value="Bungatan">Bungatan</option>
                                        <option value="Jangkar">Jangkar</option>
                                        <option value="Jatibanteng">Jatibanteng</option>
                                        <option value="Kapongan">Kapongan</option>
                                        <option value="Kendit">Kendit</option>
                                        <option value="Mangaran">Mangaran</option>
                                        <option value="Mlandingan">Mlandingan</option>
                                        <option value="Panarukan">Panarukan</option>
                                        <option value="Panji">Panji</option>
                                        <option value="Situbondo">Situbondo</option>
                                        <option value="Suboh">Suboh</option>
                                        <option value="Sumbermalang">Sumbermalang</option>
                                    </select>
                                    <div class="error-message" id="kecamatanError">Kecamatan harus dipilih</div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label class="form-label"><i class="fas fa-box"></i> Jenis Bantuan</label>
                                    <select class="form-select" id="jenisBantuan" required>
                                        <option value="">Pilih Jenis Bantuan</option>
                                        <option value="Bibit Sapi">Bibit Sapi</option>
                                        <option value="Bibit Kambing">Bibit Kambing</option>
                                        <option value="Pakan Ternak">Pakan Ternak</option>
                                        <option value="Obat-obatan">Obat-obatan</option>
                                        <option value="Alat Peternakan">Alat Peternakan</option>
                                        <option value="Bibit Ikan">Bibit Ikan</option>
                                        <option value="Pakan Ikan">Pakan Ikan</option>
                                        <option value="Kolam Ikan">Kolam Ikan</option>
                                        <option value="Bantuan Tunai">Bantuan Tunai</option>
                                        <option value="Lainnya">Lainnya</option>
                                    </select>
                                    <div class="error-message" id="jenisBantuanError">Jenis bantuan harus dipilih</div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label class="form-label"><i class="fas fa-calendar-alt"></i> Tanggal Penyaluran</label>
                                    <input type="date" class="form-control" id="tanggalPenyaluran" required>
                                    <div class="error-message" id="tanggalPenyaluranError">Tanggal penyaluran harus diisi</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label"><i class="fas fa-file-alt"></i> Keterangan (Opsional)</label>
                                    <textarea class="form-control" id="keterangan" rows="2"></textarea>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label"><i class="fas fa-link"></i> Link Google Drive (Opsional)</label>
                                    <input type="url" class="form-control" id="linkDrive" placeholder="https://drive.google.com/...">
                                    <div class="form-text">Masukkan link Google Drive untuk dokumen pendukung</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="d-flex justify-content-between mt-4">
                            <button type="reset" class="btn btn-secondary">
                                <i class="fas fa-undo me-2"></i> Reset Form
                            </button>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save me-2"></i> Simpan Data
                            </button>
                        </div>
                    </form>
                </div>
                
                <!-- Data Table Section -->
                <div class="content-section d-none" id="dataTable">
                    <h3 class="section-title">Tabel Data Bantuan</h3>
                    
                    <div class="filter-section">
                        <div class="row">
                            <div class="col-md-3">
                                <div class="mb-3">
                                    <label class="form-label"><i class="fas fa-filter"></i> Filter Kecamatan</label>
                                    <select class="form-select" id="filterKecamatan">
                                        <option value="">Semua Kecamatan</option>
                                        <option value="Arjasa">Arjasa</option>
                                        <option value="Asembagus">Asembagus</option>
                                        <option value="Banyuglugur">Banyuglugur</option>
                                        <option value="Banyuputih">Banyuputih</option>
                                        <option value="Besuki">Besuki</option>
                                        <option value="Bungatan">Bungatan</option>
                                        <option value="Jangkar">Jangkar</option>
                                        <option value="Jatibanteng">Jatibanteng</option>
                                        <option value="Kapongan">Kapongan</option>
                                        <option value="Kendit">Kendit</option>
                                        <option value="Mangaran">Mangaran</option>
                                        <option value="Mlandingan">Mlandingan</option>
                                        <option value="Panarukan">Panarukan</option>
                                        <option value="Panji">Panji</option>
                                        <option value="Situbondo">Situbondo</option>
                                        <option value="Suboh">Suboh</option>
                                        <option value="Sumbermalang">Sumbermalang</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="mb-3">
                                    <label class="form-label"><i class="fas fa-filter"></i> Filter Jenis Bantuan</label>
                                    <select class="form-select" id="filterJenisBantuan">
                                        <option value="">Semua Jenis</option>
                                        <option value="Bibit Sapi">Bibit Sapi</option>
                                        <option value="Bibit Kambing">Bibit Kambing</option>
                                        <option value="Pakan Ternak">Pakan Ternak</option>
                                        <option value="Obat-obatan">Obat-obatan</option>
                                        <option value="Alat Peternakan">Alat Peternakan</option>
                                        <option value="Bibit Ikan">Bibit Ikan</option>
                                        <option value="Pakan Ikan">Pakan Ikan</option>
                                        <option value="Kolam Ikan">Kolam Ikan</option>
                                        <option value="Bantuan Tunai">Bantuan Tunai</option>
                                        <option value="Lainnya">Lainnya</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="mb-3">
                                    <label class="form-label"><i class="fas fa-calendar"></i> Tanggal Mulai</label>
                                    <input type="date" class="form-control" id="filterTanggalMulai">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="mb-3">
                                    <label class="form-label"><i class="fas fa-calendar"></i> Tanggal Akhir</label>
                                    <input type="date" class="form-control" id="filterTanggalAkhir">
                                </div>
                            </div>
                        </div>
                        
                        <div class="d-flex justify-content-between">
                            <div>
                                <button class="btn btn-primary" id="applyFilter">
                                    <i class="fas fa-check me-2"></i> Terapkan Filter
                                </button>
                                <button class="btn btn-secondary ms-2" id="resetFilter">
                                    <i class="fas fa-sync me-2"></i> Reset Filter
                                </button>
                            </div>
                            <div>
                                <button class="btn btn-success" id="exportExcel">
                                    <i class="fas fa-file-excel me-2"></i> Export Excel
                                </button>
                                <button class="btn btn-danger ms-2" id="exportPDF">
                                    <i class="fas fa-file-pdf me-2"></i> Export PDF
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="table-responsive">
                        <table class="table table-striped table-bordered data-table" id="tabelBantuan">
                            <thead>
                                <tr>
                                    <th>No</th>
                                    <th>Tanggal</th>
                                    <th>Nama Penerima</th>
                                    <th>NIK</th>
                                    <th>Telepon</th>
                                    <th>Alamat</th>
                                    <th>Kecamatan</th>
                                    <th>Jenis Bantuan</th>
                                    <th>Keterangan</th>
                                    <th>Link Drive</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Data akan diisi oleh JavaScript -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="control-panel">
                        <h5 class="control-title">Kontrol Data</h5>
                        <div class="d-flex justify-content-between">
                            <div>
                                <button class="btn btn-warning" id="backupData">
                                    <i class="fas fa-download me-2"></i> Backup Data
                                </button>
                                <button class="btn btn-info ms-2" id="restoreData">
                                    <i class="fas fa-upload me-2"></i> Restore Data
                                </button>
                                <input type="file" id="restoreFile" accept=".json" style="display: none;">
                            </div>
                            <div>
                                <button class="btn btn-danger" id="resetData">
                                    <i class="fas fa-trash-alt me-2"></i> Reset Data
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Settings Section -->
                <div class="content-section d-none" id="settings">
                    <h3 class="section-title">Pengaturan Aplikasi</h3>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <i class="fas fa-user-cog me-2"></i> Pengaturan Akun
                                </div>
                                <div class="card-body">
                                    <form id="accountSettings">
                                        <div class="mb-3">
                                            <label class="form-label"><i class="fas fa-building"></i> Nama Instansi</label>
                                            <input type="text" class="form-control" id="namaInstansi" value="Dinas Peternakan dan Perikanan Kabupaten Situbondo">
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label"><i class="fas fa-user"></i> Nama Pengguna</label>
                                            <input type="text" class="form-control" id="namaPengguna" value="Administrator">
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label"><i class="fas fa-lock"></i> Kata Sandi Baru</label>
                                            <input type="password" class="form-control" id="kataSandiBaru" placeholder="Masukkan kata sandi baru">
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label"><i class="fas fa-lock"></i> Konfirmasi Kata Sandi</label>
                                            <input type="password" class="form-control" id="konfirmasiKataSandi" placeholder="Konfirmasi kata sandi baru">
                                        </div>
                                        <button type="submit" class="btn btn-primary">
                                            <i class="fas fa-save me-2"></i> Simpan Perubahan
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <i class="fas fa-database me-2"></i> Manajemen Data
                                </div>
                                <div class="card-body">
                                    <div class="mb-4">
                                        <h6 class="mb-3"><i class="fas fa-download me-2"></i> Backup Data</h6>
                                        <p>Buat cadangan data aplikasi untuk keamanan.</p>
                                        <button class="btn btn-warning w-100" id="backupDataSettings">
                                            <i class="fas fa-download me-2"></i> Backup Data Sekarang
                                        </button>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <h6 class="mb-3"><i class="fas fa-upload me-2"></i> Restore Data</h6>
                                        <p>Pulihkan data dari file backup sebelumnya.</p>
                                        <div class="input-group mb-2">
                                            <input type="file" class="form-control" id="restoreFileInput" accept=".json">
                                            <button class="btn btn-info" id="restoreDataSettings">
                                                <i class="fas fa-upload me-2"></i> Restore
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <h6 class="mb-3 text-danger"><i class="fas fa-trash-alt me-2"></i> Reset Data</h6>
                                        <p>Hapus semua data dalam aplikasi. Tindakan ini tidak dapat dibatalkan!</p>
                                        <button class="btn btn-danger w-100" id="resetDataSettings" data-bs-toggle="modal" data-bs-target="#resetDataModal">
                                            <i class="fas fa-trash-alt me-2"></i> Reset Semua Data
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="copyright">
            &copy; 2025 Lentera karya Situbondo - Aplikasi Sistem Bantuan BARJAS
        </div>
    </div>
    
    <!-- Floating Action Button -->
    <div class="floating-action-btn" id="fab">
        <i class="fas fa-plus"></i>
    </div>
    
    <!-- Toast Notification -->
    <div class="toast notification-toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-autohide="true" data-bs-delay="5000">
        <div class="toast-header">
            <strong class="me-auto" id="toastTitle">Notification</strong>
            <small id="toastTime">Just now</small>
            <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
        <div class="toast-body" id="toastMessage">
            <!-- Message will be inserted here -->
        </div>
    </div>
    
    <!-- Reset Data Confirmation Modal -->
    <div class="modal fade" id="resetDataModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-danger text-white">
                    <h5 class="modal-title"><i class="fas fa-exclamation-triangle me-2"></i> Konfirmasi Reset Data</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-danger">
                        <i class="fas fa-radiation me-2"></i> <strong>PERINGATAN: Tindakan ini sangat berbahaya!</strong>
                    </div>
                    <p>Anda akan menghapus <strong>SEMUA DATA</strong> dalam aplikasi. Tindakan ini tidak dapat dibatalkan!</p>
                    
                    <div class="mb-3">
                        <label class="form-label">Masukkan kata sandi untuk konfirmasi:</label>
                        <input type="password" class="form-control" id="resetPassword" placeholder="Kata sandi">
                    </div>
                    
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="checkbox" id="resetConfirmation">
                        <label class="form-check-label text-danger" for="resetConfirmation">
                            Saya mengerti bahwa semua data akan dihapus permanen dan tidak dapat dikembalikan
                        </label>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i> Batal
                    </button>
                    <button type="button" class="btn btn-danger" id="confirmReset" disabled>
                        <i class="fas fa-trash-alt me-2"></i> Reset Semua Data
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Delete Confirmation Modal -->
    <div class="modal fade" id="deleteModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-danger text-white">
                    <h5 class="modal-title"><i class="fas fa-trash-alt me-2"></i> Konfirmasi Hapus</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>Apakah Anda yakin ingin menghapus data ini? Tindakan ini tidak dapat dibatalkan.</p>
                    <div class="alert alert-warning">
                        <i class="fas fa-exclamation-circle me-2"></i> Data yang dihapus tidak dapat dikembalikan.
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i> Batal
                    </button>
                    <button type="button" class="btn btn-danger" id="confirmDelete">
                        <i class="fas fa-trash-alt me-2"></i> Hapus Data
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Link Drive Modal -->
    <div class="modal fade link-modal" id="linkModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title"><i class="fas fa-link me-2"></i> Tambahkan Link Google Drive</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">Link Google Drive</label>
                        <input type="url" class="form-control" id="modalLinkDrive" placeholder="https://drive.google.com/...">
                        <div class="form-text">Masukkan link Google Drive untuk dokumen pendukung</div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i> Batal
                    </button>
                    <button type="button" class="btn btn-primary" id="saveLink">
                        <i class="fas fa-save me-2"></i> Simpan
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/particles.js/2.0.0/particles.min.js"></script>
    
    <script>
        // Deklarasi variabel global
        let bantuanData = [];
        let currentEditId = null;
        let currentDeleteId = null;
        let loginAttempts = 0;
        let isBlocked = false;
        let blockTime = 0;
        let securityCode = "BARJAS2025"; // Kode keamanan default
        
        // Inisialisasi aplikasi saat DOM siap
        document.addEventListener('DOMContentLoaded', function() {
            // Tampilkan splash screen
            showSplashScreen();
            
            // Inisialisasi komponen UI
            initUIComponents();
            
            // Muat data dari localStorage
            loadData();
            
            // Update dashboard
            updateDashboard();
            
            // Setup event listeners
            setupEventListeners();
            
            // Setup login modal
            setupLoginModal();
        });
        
        // Tampilkan splash screen
        function showSplashScreen() {
            let countdown = 5;
            const countdownTimer = document.getElementById('countdownTimer');
            const closeSplash = document.getElementById('closeSplash');
            
            const countdownInterval = setInterval(() => {
                countdown--;
                countdownTimer.textContent = countdown;
                
                if (countdown <= 0) {
                    clearInterval(countdownInterval);
                    document.getElementById('welcomeSplash').style.opacity = '0';
                    setTimeout(() => {
                        document.getElementById('welcomeSplash').style.display = 'none';
                        // Tampilkan login modal setelah splash screen
                        showLoginModal();
                    }, 500);
                }
            }, 1000);
            
            closeSplash.addEventListener('click', function() {
                clearInterval(countdownInterval);
                document.getElementById('welcomeSplash').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('welcomeSplash').style.display = 'none';
                    // Tampilkan login modal setelah splash screen
                    showLoginModal();
                }, 500);
            });
        }
        
        // Tampilkan modal login
        function showLoginModal() {
            const loginModal = new bootstrap.Modal(document.getElementById('loginModal'));
            loginModal.show();
        }
        
        // Setup modal login
        function setupLoginModal() {
            const loginForm = document.getElementById('loginForm');
            const securityCodeInput = document.getElementById('securityCode');
            const loginButton = document.getElementById('loginButton');
            const loginSpinner = document.getElementById('loginSpinner');
            const attemptsCount = document.getElementById('attemptsCount');
            const blockedMessage = document.getElementById('blockedMessage');
            const countdownElement = document.getElementById('countdown');
            const togglePasswordButton = document.querySelector('.toggle-password');
            
            // Cek status block
            checkBlockStatus();
            
            // Toggle password visibility
            togglePasswordButton.addEventListener('click', function() {
                if (securityCodeInput.type === 'password') {
                    securityCodeInput.type = 'text';
                    togglePasswordButton.innerHTML = '<i class="fas fa-eye-slash"></i>';
                } else {
                    securityCodeInput.type = 'password';
                    togglePasswordButton.innerHTML = '<i class="fas fa-eye"></i>';
                }
            });
            
            // Handle login form submission
            loginForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                if (isBlocked) {
                    return;
                }
                
                const enteredCode = securityCodeInput.value.trim();
                
                if (enteredCode === securityCode) {
                    // Login berhasil
                    loginSpinner.classList.remove('d-none');
                    loginButton.disabled = true;
                    
                    // Simpan status login di localStorage
                    localStorage.setItem('isLoggedIn', 'true');
                    localStorage.setItem('loginTime', new Date().getTime());
                    
                    // Reset percobaan login
                    loginAttempts = 0;
                    localStorage.setItem('loginAttempts', loginAttempts);
                    
                    // Simpan kode keamanan jika diubah
                    if (enteredCode !== securityCode) {
                        securityCode = enteredCode;
                        localStorage.setItem('securityCode', securityCode);
                    }
                    
                    // Tunggu sebentar untuk efek visual
                    setTimeout(() => {
                        bootstrap.Modal.getInstance(document.getElementById('loginModal')).hide();
                        showNotification('Login Berhasil', 'Selamat datang di Aplikasi BARJAS', 'success');
                    }, 1000);
                } else {
                    // Login gagal
                    loginAttempts++;
                    localStorage.setItem('loginAttempts', loginAttempts);
                    
                    if (loginAttempts >= 3) {
                        // Blokir akses setelah 3 percobaan gagal
                        isBlocked = true;
                        blockTime = new Date().getTime();
                        localStorage.setItem('blockTime', blockTime);
                        
                        securityCodeInput.disabled = true;
                        loginButton.disabled = true;
                        attemptsCount.classList.add('d-none');
                        blockedMessage.classList.remove('d-none');
                        
                        // Mulai countdown
                        let countdown = 30;
                        countdownElement.textContent = countdown;
                        
                        const countdownInterval = setInterval(() => {
                            countdown--;
                            countdownElement.textContent = countdown;
                            
                            if (countdown <= 0) {
                                clearInterval(countdownInterval);
                                isBlocked = false;
                                securityCodeInput.disabled = false;
                                loginButton.disabled = false;
                                blockedMessage.classList.add('d-none');
                                attemptsCount.classList.remove('d-none');
                                loginAttempts = 0;
                                localStorage.setItem('loginAttempts', loginAttempts);
                                localStorage.removeItem('blockTime');
                            }
                        }, 1000);
                    } else {
                        // Tampilkan pesan error
                        securityCodeInput.classList.add('login-shake');
                        setTimeout(() => {
                            securityCodeInput.classList.remove('login-shake');
                        }, 600);
                        
                        attemptsCount.textContent = `Percobaan gagal: ${loginAttempts} dari 3`;
                        attemptsCount.classList.remove('d-none');
                    }
                }
            });
        }
        
        // Cek status block
        function checkBlockStatus() {
            const savedAttempts = localStorage.getItem('loginAttempts');
            const savedBlockTime = localStorage.getItem('blockTime');
            const attemptsCount = document.getElementById('attemptsCount');
            const blockedMessage = document.getElementById('blockedMessage');
            const countdownElement = document.getElementById('countdown');
            const securityCodeInput = document.getElementById('securityCode');
            const loginButton = document.getElementById('loginButton');
            
            if (savedAttempts) {
                loginAttempts = parseInt(savedAttempts);
            }
            
            if (savedBlockTime) {
                const currentTime = new Date().getTime();
                const elapsedTime = Math.floor((currentTime - parseInt(savedBlockTime)) / 1000);
                
                if (elapsedTime < 30) {
                    isBlocked = true;
                    blockTime = parseInt(savedBlockTime);
                    
                    securityCodeInput.disabled = true;
                    loginButton.disabled = true;
                    attemptsCount.classList.add('d-none');
                    blockedMessage.classList.remove('d-none');
                    
                    // Mulai countdown
                    let countdown = 30 - elapsedTime;
                    countdownElement.textContent = countdown;
                    
                    const countdownInterval = setInterval(() => {
                        countdown--;
                        countdownElement.textContent = countdown;
                        
                        if (countdown <= 0) {
                            clearInterval(countdownInterval);
                            isBlocked = false;
                            securityCodeInput.disabled = false;
                            loginButton.disabled = false;
                            blockedMessage.classList.add('d-none');
                            attemptsCount.classList.remove('d-none');
                            loginAttempts = 0;
                            localStorage.setItem('loginAttempts', loginAttempts);
                            localStorage.removeItem('blockTime');
                        }
                    }, 1000);
                } else {
                    localStorage.removeItem('blockTime');
                    loginAttempts = 0;
                    localStorage.setItem('loginAttempts', loginAttempts);
                }
            }
            
            if (loginAttempts > 0) {
                attemptsCount.textContent = `Percobaan gagal: ${loginAttempts} dari 3`;
                attemptsCount.classList.remove('d-none');
            }
        }
        
        // Inisialisasi komponen UI
        function initUIComponents() {
            // Inisialisasi tooltip Bootstrap
            const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
            tooltipTriggerList.map(function (tooltipTriggerEl) {
                return new bootstrap.Tooltip(tooltipTriggerEl);
            });
            
            // Inisialisasi datepicker
            $('.datepicker').datepicker({
                format: 'yyyy-mm-dd',
                autoclose: true,
                todayHighlight: true
            });
            
            // Set tanggal default untuk filter
            const today = new Date();
            const firstDayOfMonth = new Date(today.getFullYear(), today.getMonth(), 1);
            
            document.getElementById('filterTanggalMulai').valueAsDate = firstDayOfMonth;
            document.getElementById('filterTanggalAkhir').valueAsDate = today;
            
            // Set tanggal penyaluran default ke hari ini
            document.getElementById('tanggalPenyaluran').valueAsDate = today;
        }
        
        // Muat data dari localStorage
        function loadData() {
            const savedData = localStorage.getItem('bantuanData');
            const savedSettings = localStorage.getItem('appSettings');
            
            if (savedData) {
                bantuanData = JSON.parse(savedData);
            }
            
            if (savedSettings) {
                const settings = JSON.parse(savedSettings);
                document.getElementById('namaInstansi').value = settings.namaInstansi || 'Dinas Peternakan dan Perikanan Kabupaten Situbondo';
                document.getElementById('namaPengguna').value = settings.namaPengguna || 'Administrator';
                document.getElementById('institutionName').textContent = settings.namaInstansi || 'Dinas Peternakan dan Perikanan Kabupaten Situbondo';
                
                // Load security code if exists
                if (settings.securityCode) {
                    securityCode = settings.securityCode;
                }
            }
            
            // Render tabel data
            renderDataTable();
        }
        
        // Simpan data ke localStorage
        function saveData() {
            localStorage.setItem('bantuanData', JSON.stringify(bantuanData));
            
            const settings = {
                namaInstansi: document.getElementById('namaInstansi').value,
                namaPengguna: document.getElementById('namaPengguna').value,
                securityCode: securityCode
            };
            
            localStorage.setItem('appSettings', JSON.stringify(settings));
            document.getElementById('institutionName').textContent = settings.namaInstansi;
        }
        
        // Setup event listeners
        function setupEventListeners() {
            // Navigation
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Update active nav link
                    document.querySelectorAll('.nav-link').forEach(navLink => {
                        navLink.classList.remove('active');
                    });
                    this.classList.add('active');
                    
                    // Show corresponding section
                    const target = this.getAttribute('data-bs-target');
                    document.querySelectorAll('.content-section').forEach(section => {
                        section.classList.add('d-none');
                    });
                    document.getElementById(target).classList.remove('d-none');
                });
            });
            
            // Form submission
            document.getElementById('bantuanForm').addEventListener('submit', function(e) {
                e.preventDefault();
                handleFormSubmit();
            });
            
            // Account settings form
            document.getElementById('accountSettings').addEventListener('submit', function(e) {
                e.preventDefault();
                saveAccountSettings();
            });
            
            // Filter buttons
            document.getElementById('applyFilter').addEventListener('click', applyFilters);
            document.getElementById('resetFilter').addEventListener('click', resetFilters);
            
            // Export buttons
            document.getElementById('exportExcel').addEventListener('click', exportToExcel);
            document.getElementById('exportPDF').addEventListener('click', exportToPDF);
            
            // Backup and restore buttons
            document.getElementById('backupData').addEventListener('click', backupData);
            document.getElementById('restoreData').addEventListener('click', triggerRestore);
            document.getElementById('restoreFile').addEventListener('change', restoreData);
            
            document.getElementById('backupDataSettings').addEventListener('click', backupData);
            document.getElementById('restoreDataSettings').addEventListener('click', function() {
                document.getElementById('restoreFileInput').click();
            });
            document.getElementById('restoreFileInput').addEventListener('change', restoreData);
            
            // Reset data buttons
            document.getElementById('resetData').addEventListener('click', function() {
                $('#resetDataModal').modal('show');
            });
            
            document.getElementById('resetDataSettings').addEventListener('click', function() {
                $('#resetDataModal').modal('show');
            });
            
            // Reset data confirmation
            document.getElementById('resetPassword').addEventListener('input', function() {
                const confirmButton = document.getElementById('confirmReset');
                const confirmationCheckbox = document.getElementById('resetConfirmation');
                
                confirmButton.disabled = !(this.value === securityCode && confirmationCheckbox.checked);
            });
            
            document.getElementById('resetConfirmation').addEventListener('change', function() {
                const confirmButton = document.getElementById('confirmReset');
                const passwordInput = document.getElementById('resetPassword');
                
                confirmButton.disabled = !(passwordInput.value === securityCode && this.checked);
            });
            
            document.getElementById('confirmReset').addEventListener('click', resetAllData);
            
            // Delete confirmation
            document.getElementById('confirmDelete').addEventListener('click', confirmDelete);
            
            // Mobile menu button
            document.getElementById('mobileMenuBtn').addEventListener('click', toggleMobileMenu);
            document.getElementById('sidebarOverlay').addEventListener('click', toggleMobileMenu);
            
            // FAB button
            document.getElementById('fab').addEventListener('click', function() {
                // Switch to input data section
                document.querySelectorAll('.nav-link').forEach(navLink => {
                    navLink.classList.remove('active');
                });
                document.querySelector('[data-bs-target="inputData"]').classList.add('active');
                
                document.querySelectorAll('.content-section').forEach(section => {
                    section.classList.add('d-none');
                });
                document.getElementById('inputData').classList.remove('d-none');
                
                // Close mobile menu if open
                document.getElementById('sidebar').classList.remove('mobile-show');
                document.getElementById('sidebarOverlay').classList.remove('mobile-show');
            });
        }
        
        // Toggle mobile menu
        function toggleMobileMenu() {
            document.getElementById('sidebar').classList.toggle('mobile-show');
            document.getElementById('sidebarOverlay').classList.toggle('mobile-show');
        }
        
        // Handle form submission
        function handleFormSubmit() {
            if (validateForm()) {
                const formData = {
                    id: currentEditId || Date.now().toString(),
                    namaPenerima: document.getElementById('namaPenerima').value,
                    nik: document.getElementById('nik').value,
                    noTelepon: document.getElementById('noTelepon').value,
                    alamat: document.getElementById('alamat').value,
                    kecamatan: document.getElementById('kecamatan').value,
                    jenisBantuan: document.getElementById('jenisBantuan').value,
                    tanggalPenyaluran: document.getElementById('tanggalPenyaluran').value,
                    keterangan: document.getElementById('keterangan').value,
                    linkDrive: document.getElementById('linkDrive').value,
                    timestamp: new Date().toISOString()
                };
                
                if (currentEditId) {
                    // Edit existing data
                    const index = bantuanData.findIndex(item => item.id === currentEditId);
                    if (index !== -1) {
                        bantuanData[index] = formData;
                        showNotification('Data Diperbarui', 'Data bantuan berhasil diperbarui', 'success');
                    }
                    currentEditId = null;
                } else {
                    // Add new data
                    bantuanData.push(formData);
                    showNotification('Data Tersimpan', 'Data bantuan berhasil disimpan', 'success');
                }
                
                // Save data and update UI
                saveData();
                renderDataTable();
                updateDashboard();
                document.getElementById('bantuanForm').reset();
                
                // Set default tanggal penyaluran ke hari ini
                document.getElementById('tanggalPenyaluran').valueAsDate = new Date();
            }
        }
        
        // Validasi form
        function validateForm() {
            let isValid = true;
            
            // Validasi Nama Penerima
            const namaPenerima = document.getElementById('namaPenerima');
            const namaPenerimaError = document.getElementById('namaPenerimaError');
            if (!namaPenerima.value.trim()) {
                namaPenerima.classList.add('input-error');
                namaPenerimaError.style.display = 'block';
                isValid = false;
            } else {
                namaPenerima.classList.remove('input-error');
                namaPenerimaError.style.display = 'none';
            }
            
            // Validasi NIK
            const nik = document.getElementById('nik');
            const nikError = document.getElementById('nikError');
            const nikRegex = /^\d{16}$/;
            if (!nik.value.trim() || !nikRegex.test(nik.value)) {
                nik.classList.add('input-error');
                nikError.style.display = 'block';
                isValid = false;
            } else {
                nik.classList.remove('input-error');
                nikError.style.display = 'none';
            }
            
            // Validasi Nomor Telepon
            const noTelepon = document.getElementById('noTelepon');
            const noTeleponError = document.getElementById('noTeleponError');
            if (!noTelepon.value.trim()) {
                noTelepon.classList.add('input-error');
                noTeleponError.style.display = 'block';
                isValid = false;
            } else {
                noTelepon.classList.remove('input-error');
                noTeleponError.style.display = 'none';
            }
            
            // Validasi Alamat
            const alamat = document.getElementById('alamat');
            const alamatError = document.getElementById('alamatError');
            if (!alamat.value.trim()) {
                alamat.classList.add('input-error');
                alamatError.style.display = 'block';
                isValid = false;
            } else {
                alamat.classList.remove('input-error');
                alamatError.style.display = 'none';
            }
            
            // Validasi Kecamatan
            const kecamatan = document.getElementById('kecamatan');
            const kecamatanError = document.getElementById('kecamatanError');
            if (!kecamatan.value) {
                kecamatan.classList.add('input-error');
                kecamatanError.style.display = 'block';
                isValid = false;
            } else {
                kecamatan.classList.remove('input-error');
                kecamatanError.style.display = 'none';
            }
            
            // Validasi Jenis Bantuan
            const jenisBantuan = document.getElementById('jenisBantuan');
            const jenisBantuanError = document.getElementById('jenisBantuanError');
            if (!jenisBantuan.value) {
                jenisBantuan.classList.add('input-error');
                jenisBantuanError.style.display = 'block';
                isValid = false;
            } else {
                jenisBantuan.classList.remove('input-error');
                jenisBantuanError.style.display = 'none';
            }
            
            // Validasi Tanggal Penyaluran
            const tanggalPenyaluran = document.getElementById('tanggalPenyaluran');
            const tanggalPenyaluranError = document.getElementById('tanggalPenyaluranError');
            if (!tanggalPenyaluran.value) {
                tanggalPenyaluran.classList.add('input-error');
                tanggalPenyaluranError.style.display = 'block';
                isValid = false;
            } else {
                tanggalPenyaluran.classList.remove('input-error');
                tanggalPenyaluranError.style.display = 'none';
            }
            
            return isValid;
        }
        
        // Render data table
        function renderDataTable() {
            const tableBody = document.querySelector('#tabelBantuan tbody');
            tableBody.innerHTML = '';
            
            if (bantuanData.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="11" class="text-center py-4">
                            <i class="fas fa-database fs-1 d-block mb-2 text-muted"></i>
                            <p class="text-muted">Tidak ada data bantuan</p>
                            <button class="btn btn-primary" id="gotoInput">
                                <i class="fas fa-plus me-2"></i> Tambah Data Bantuan
                            </button>
                        </td>
                    </tr>
                `;
                
                document.getElementById('gotoInput').addEventListener('click', function() {
                    document.querySelector('[data-bs-target="inputData"]').click();
                });
                
                return;
            }
            
            bantuanData.forEach((item, index) => {
                const row = document.createElement('tr');
                
                // Format tanggal untuk tampilan
                const tanggal = new Date(item.tanggalPenyaluran);
                const formattedDate = tanggal.toLocaleDateString('id-ID', {
                    day: '2-digit',
                    month: '2-digit',
                    year: 'numeric'
                });
                
                // Format nomor telepon untuk WhatsApp
                const whatsappNumber = item.noTelepon.replace(/\D/g, '');
                const whatsappLink = `https://wa.me/62${whatsappNumber.substring(1)}`;
                
                row.innerHTML = `
                    <td class="text-center">${index + 1}</td>
                    <td>${formattedDate}</td>
                    <td>${item.namaPenerima}</td>
                    <td>${item.nik}</td>
                    <td>
                        <a href="${whatsappLink}" target="_blank" class="whatsapp-link">
                            <i class="fab fa-whatsapp me-1"></i> ${item.noTelepon}
                        </a>
                    </td>
                    <td>${item.alamat}</td>
                    <td>${item.kecamatan}</td>
                    <td>${item.jenisBantuan}</td>
                    <td>${item.keterangan || '-'}</td>
                    <td>
                        ${item.linkDrive ? 
                            `<a href="${item.linkDrive}" target="_blank" class="drive-link">
                                <i class="fas fa-external-link-alt me-1"></i> Lihat Dokumen
                            </a>` : 
                            '-'
                        }
                    </td>
                    <td class="text-center">
                        <div class="btn-group btn-group-sm">
                            <button class="btn btn-outline-primary edit-btn" data-id="${item.id}">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-outline-danger delete-btn" data-id="${item.id}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
            
            // Add event listeners to edit and delete buttons
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    editData(id);
                });
            });
            
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    showDeleteConfirmation(id);
                });
            });
        }
        
        // Edit data
        function editData(id) {
            const data = bantuanData.find(item => item.id === id);
            if (data) {
                document.getElementById('namaPenerima').value = data.namaPenerima;
                document.getElementById('nik').value = data.nik;
                document.getElementById('noTelepon').value = data.noTelepon;
                document.getElementById('alamat').value = data.alamat;
                document.getElementById('kecamatan').value = data.kecamatan;
                document.getElementById('jenisBantuan').value = data.jenisBantuan;
                document.getElementById('tanggalPenyaluran').value = data.tanggalPenyaluran;
                document.getElementById('keterangan').value = data.keterangan || '';
                document.getElementById('linkDrive').value = data.linkDrive || '';
                
                currentEditId = id;
                
                // Scroll to form
                document.querySelector('[data-bs-target="inputData"]').click();
                
                showNotification('Edit Data', 'Silakan edit data yang diperlukan', 'info');
            }
        }
        
        // Tampilkan konfirmasi hapus
        function showDeleteConfirmation(id) {
            currentDeleteId = id;
            $('#deleteModal').modal('show');
        }
        
        // Konfirmasi hapus data
        function confirmDelete() {
            if (currentDeleteId) {
                bantuanData = bantuanData.filter(item => item.id !== currentDeleteId);
                saveData();
                renderDataTable();
                updateDashboard();
                
                showNotification('Data Dihapus', 'Data bantuan berhasil dihapus', 'success');
                
                $('#deleteModal').modal('hide');
                currentDeleteId = null;
            }
        }
        
        // Terapkan filter
        function applyFilters() {
            const kecamatan = document.getElementById('filterKecamatan').value;
            const jenisBantuan = document.getElementById('filterJenisBantuan').value;
            const tanggalMulai = document.getElementById('filterTanggalMulai').value;
            const tanggalAkhir = document.getElementById('filterTanggalAkhir').value;
            
            let filteredData = [...bantuanData];
            
            // Filter by kecamatan
            if (kecamatan) {
                filteredData = filteredData.filter(item => item.kecamatan === kecamatan);
            }
            
            // Filter by jenis bantuan
            if (jenisBantuan) {
                filteredData = filteredData.filter(item => item.jenisBantuan === jenisBantuan);
            }
            
            // Filter by tanggal
            if (tanggalMulai) {
                filteredData = filteredData.filter(item => {
                    const itemDate = new Date(item.tanggalPenyaluran);
                    const startDate = new Date(tanggalMulai);
                    return itemDate >= startDate;
                });
            }
            
            if (tanggalAkhir) {
                filteredData = filteredData.filter(item => {
                    const itemDate = new Date(item.tanggalPenyaluran);
                    const endDate = new Date(tanggalAkhir);
                    endDate.setHours(23, 59, 59, 999); // Set to end of day
                    return itemDate <= endDate;
                });
            }
            
            // Render filtered data
            renderFilteredData(filteredData);
        }
        
        // Render filtered data
        function renderFilteredData(data) {
            const tableBody = document.querySelector('#tabelBantuan tbody');
            tableBody.innerHTML = '';
            
            if (data.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="11" class="text-center py-4">
                            <i class="fas fa-search fs-1 d-block mb-2 text-muted"></i>
                            <p class="text-muted">Tidak ada data yang sesuai dengan filter</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            data.forEach((item, index) => {
                const row = document.createElement('tr');
                
                // Format tanggal untuk tampilan
                const tanggal = new Date(item.tanggalPenyaluran);
                const formattedDate = tanggal.toLocaleDateString('id-ID', {
                    day: '2-digit',
                    month: '2-digit',
                    year: 'numeric'
                });
                
                // Format nomor telepon untuk WhatsApp
                const whatsappNumber = item.noTelepon.replace(/\D/g, '');
                const whatsappLink = `https://wa.me/62${whatsappNumber.substring(1)}`;
                
                row.innerHTML = `
                    <td class="text-center">${index + 1}</td>
                    <td>${formattedDate}</td>
                    <td>${item.namaPenerima}</td>
                    <td>${item.nik}</td>
                    <td>
                        <a href="${whatsappLink}" target="_blank" class="whatsapp-link">
                            <i class="fab fa-whatsapp me-1"></i> ${item.noTelepon}
                        </a>
                    </td>
                    <td>${item.alamat}</td>
                    <td>${item.kecamatan}</td>
                    <td>${item.jenisBantuan}</td>
                    <td>${item.keterangan || '-'}</td>
                    <td>
                        ${item.linkDrive ? 
                            `<a href="${item.linkDrive}" target="_blank" class="drive-link">
                                <i class="fas fa-external-link-alt me-1"></i> Lihat Dokumen
                            </a>` : 
                            '-'
                        }
                    </td>
                    <td class="text-center">
                        <div class="btn-group btn-group-sm">
                            <button class="btn btn-outline-primary edit-btn" data-id="${item.id}">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-outline-danger delete-btn" data-id="${item.id}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
            
            // Add event listeners to edit and delete buttons
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    editData(id);
                });
            });
            
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    showDeleteConfirmation(id);
                });
            });
        }
        
        // Reset filter
        function resetFilters() {
            document.getElementById('filterKecamatan').value = '';
            document.getElementById('filterJenisBantuan').value = '';
            
            const today = new Date();
            const firstDayOfMonth = new Date(today.getFullYear(), today.getMonth(), 1);
            
            document.getElementById('filterTanggalMulai').valueAsDate = firstDayOfMonth;
            document.getElementById('filterTanggalAkhir').valueAsDate = today;
            
            renderDataTable();
        }
        
        // Update dashboard
        function updateDashboard() {
            // Update stats
            document.getElementById('totalPenerima').textContent = bantuanData.length;
            
            // Hitung total jenis bantuan unik
            const uniqueJenisBantuan = new Set(bantuanData.map(item => item.jenisBantuan));
            document.getElementById('totalBantuan').textContent = uniqueJenisBantuan.size;
            
            // Asumsikan semua bantuan tersalurkan (karena ini sistem input data penyaluran)
            document.getElementById('totalTersalurkan').textContent = bantuanData.length;
            
            // Hitung persentase (dalam konteks ini selalu 100% karena semua data adalah penyaluran)
            document.getElementById('persentase').textContent = '100%';
            
            // Update recent activities
            updateRecentActivities();
            
            // Update charts
            updateCharts();
        }
        
        // Update recent activities
        function updateRecentActivities() {
            const recentActivities = document.getElementById('recentActivities');
            recentActivities.innerHTML = '';
            
            // Ambil 5 data terbaru
            const recentData = [...bantuanData]
                .sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp))
                .slice(0, 5);
            
            if (recentData.length === 0) {
                recentActivities.innerHTML = `
                    <tr>
                        <td colspan="6" class="text-center py-3 text-muted">
                            Tidak ada aktivitas terbaru
                        </td>
                    </tr>
                `;
                return;
            }
            
            recentData.forEach((item, index) => {
                const row = document.createElement('tr');
                
                // Format tanggal untuk tampilan
                const tanggal = new Date(item.tanggalPenyaluran);
                const formattedDate = tanggal.toLocaleDateString('id-ID', {
                    day: '2-digit',
                    month: 'short',
                    year: 'numeric'
                });
                
                row.innerHTML = `
                    <td class="text-center">${index + 1}</td>
                    <td>${formattedDate}</td>
                    <td>${item.namaPenerima}</td>
                    <td>${item.jenisBantuan}</td>
                    <td>${item.kecamatan}</td>
                    <td>
                        <span class="badge bg-success">Tersalurkan</span>
                    </td>
                `;
                
                recentActivities.appendChild(row);
            });
        }
        
        // Update charts
        function updateCharts() {
            // Data untuk chart jenis bantuan
            const jenisBantuanCount = {};
            bantuanData.forEach(item => {
                if (jenisBantuanCount[item.jenisBantuan]) {
                    jenisBantuanCount[item.jenisBantuan]++;
                } else {
                    jenisBantuanCount[item.jenisBantuan] = 1;
                }
            });
            
            const jenisBantuanLabels = Object.keys(jenisBantuanCount);
            const jenisBantuanData = Object.values(jenisBantuanCount);
            
            // Data untuk chart kecamatan
            const kecamatanCount = {};
            bantuanData.forEach(item => {
                if (kecamatanCount[item.kecamatan]) {
                    kecamatanCount[item.kecamatan]++;
                } else {
                    kecamatanCount[item.kecamatan] = 1;
                }
            });
            
            const kecamatanLabels = Object.keys(kecamatanCount);
            const kecamatanData = Object.values(kecamatanCount);
            
            // Render charts
            renderJenisBantuanChart(jenisBantuanLabels, jenisBantuanData);
            renderKecamatanChart(kecamatanLabels, kecamatanData);
        }
        
        // Render chart jenis bantuan
        function renderJenisBantuanChart(labels, data) {
            const ctx = document.getElementById('jenisBantuanChart').getContext('2d');
            
            if (window.jenisBantuanChartInstance) {
                window.jenisBantuanChartInstance.destroy();
            }
            
            const backgroundColors = [
                'rgba(255, 99, 132, 0.7)',
                'rgba(54, 162, 235, 0.7)',
                'rgba(255, 206, 86, 0.7)',
                'rgba(75, 192, 192, 0.7)',
                'rgba(153, 102, 255, 0.7)',
                'rgba(255, 159, 64, 0.7)',
                'rgba(199, 199, 199, 0.7)',
                'rgba(83, 102, 255, 0.7)',
                'rgba(40, 159, 64, 0.7)',
                'rgba(210, 99, 132, 0.7)'
            ];
            
            window.jenisBantuanChartInstance = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: labels,
                    datasets: [{
                        data: data,
                        backgroundColor: backgroundColors.slice(0, labels.length),
                        borderColor: backgroundColors.map(color => color.replace('0.7', '1')),
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'right',
                        },
                        title: {
                            display: true,
                            text: 'Distribusi Jenis Bantuan'
                        }
                    }
                }
            });
        }
        
        // Render chart kecamatan
        function renderKecamatanChart(labels, data) {
            const ctx = document.getElementById('kecamatanChart').getContext('2d');
            
            if (window.kecamatanChartInstance) {
                window.kecamatanChartInstance.destroy();
            }
            
            window.kecamatanChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Jumlah Bantuan',
                        data: data,
                        backgroundColor: 'rgba(54, 162, 235, 0.7)',
                        borderColor: 'rgba(54, 162, 235, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                precision: 0
                            }
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'Bantuan per Kecamatan'
                        }
                    }
                }
            });
        }
        
        // Export to Excel
        function exportToExcel() {
            if (bantuanData.length === 0) {
                showNotification('Ekspor Gagal', 'Tidak ada data untuk diekspor', 'warning');
                return;
            }
            
            try {
                // Prepare data for export
                const dataToExport = bantuanData.map(item => {
                    return {
                        'Tanggal Penyaluran': new Date(item.tanggalPenyaluran).toLocaleDateString('id-ID'),
                        'Nama Penerima': item.namaPenerima,
                        'NIK': item.nik,
                        'Nomor Telepon': item.noTelepon,
                        'Alamat': item.alamat,
                        'Kecamatan': item.kecamatan,
                        'Jenis Bantuan': item.jenisBantuan,
                        'Keterangan': item.keterangan || '',
                        'Link Drive': item.linkDrive || ''
                    };
                });
                
                // Create worksheet
                const ws = XLSX.utils.json_to_sheet(dataToExport);
                
                // Create workbook
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, 'Data Bantuan');
                
                // Generate file name with current date
                const date = new Date();
                const dateStr = date.toISOString().split('T')[0];
                const fileName = `Data_Bantuan_${dateStr}.xlsx`;
                
                // Export to file
                XLSX.writeFile(wb, fileName);
                
                showNotification('Ekspor Berhasil', `Data berhasil diekspor ke ${fileName}`, 'success');
            } catch (error) {
                console.error('Error exporting to Excel:', error);
                showNotification('Ekspor Gagal', 'Terjadi kesalahan saat mengekspor data', 'error');
            }
        }
        
        // Export to PDF
        function exportToPDF() {
            if (bantuanData.length === 0) {
                showNotification('Ekspor Gagal', 'Tidak ada data untuk diekspor', 'warning');
                return;
            }
            
            try {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                
                // Add title
                doc.setFontSize(18);
                doc.text('LAPORAN DATA BANTUAN', 105, 15, { align: 'center' });
                
                // Add institution name
                doc.setFontSize(12);
                doc.text(document.getElementById('institutionName').textContent, 105, 22, { align: 'center' });
                
                // Add date
                const date = new Date();
                const dateStr = date.toLocaleDateString('id-ID', {
                    day: '2-digit',
                    month: 'long',
                    year: 'numeric'
                });
                doc.setFontSize(10);
                doc.text(`Tanggal Ekspor: ${dateStr}`, 105, 29, { align: 'center' });
                
                // Prepare data for table
                const tableData = bantuanData.map(item => {
                    return [
                        new Date(item.tanggalPenyaluran).toLocaleDateString('id-ID'),
                        item.namaPenerima,
                        item.nik,
                        item.noTelepon,
                        item.alamat,
                        item.kecamatan,
                        item.jenisBantuan,
                        item.keterangan || '-'
                    ];
                });
                
                // Add table
                doc.autoTable({
                    startY: 35,
                    head: [['Tanggal', 'Nama', 'NIK', 'Telepon', 'Alamat', 'Kecamatan', 'Jenis', 'Keterangan']],
                    body: tableData,
                    theme: 'grid',
                    headStyles: {
                        fillColor: [13, 71, 161],
                        textColor: 255
                    },
                    alternateRowStyles: {
                        fillColor: [240, 240, 240]
                    },
                    styles: {
                        fontSize: 8,
                        cellPadding: 1
                    },
                    margin: { top: 35 }
                });
                
                // Add page numbers
                const pageCount = doc.internal.getNumberOfPages();
                for (let i = 1; i <= pageCount; i++) {
                    doc.setPage(i);
                    doc.setFontSize(8);
                    doc.text(`Halaman ${i} dari ${pageCount}`, doc.internal.pageSize.width / 2, doc.internal.pageSize.height - 10, { align: 'center' });
                }
                
                // Generate file name with current date
                const fileName = `Data_Bantuan_${date.toISOString().split('T')[0]}.pdf`;
                
                // Save PDF
                doc.save(fileName);
                
                showNotification('Ekspor Berhasil', `Data berhasil diekspor ke ${fileName}`, 'success');
            } catch (error) {
                console.error('Error exporting to PDF:', error);
                showNotification('Ekspor Gagal', 'Terjadi kesalahan saat mengekspor data', 'error');
            }
        }
        
        // Backup data
        function backupData() {
            if (bantuanData.length === 0) {
                showNotification('Backup Gagal', 'Tidak ada data untuk dibackup', 'warning');
                return;
            }
            
            try {
                const dataStr = JSON.stringify(bantuanData);
                const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
                
                const exportFileDefaultName = `backup_bantuan_${new Date().toISOString().split('T')[0]}.json`;
                
                const linkElement = document.createElement('a');
                linkElement.setAttribute('href', dataUri);
                linkElement.setAttribute('download', exportFileDefaultName);
                linkElement.click();
                
                showNotification('Backup Berhasil', 'Data berhasil dibackup', 'success');
            } catch (error) {
                console.error('Error backing up data:', error);
                showNotification('Backup Gagal', 'Terjadi kesalahan saat membackup data', 'error');
            }
        }
        
        // Trigger restore
        function triggerRestore() {
            document.getElementById('restoreFile').click();
        }
        
        // Restore data
        function restoreData(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const restoredData = JSON.parse(e.target.result);
                    
                    if (!Array.isArray(restoredData)) {
                        throw new Error('Format file backup tidak valid');
                    }
                    
                    // Validasi data
                    const isValid = restoredData.every(item => {
                        return item.hasOwnProperty('namaPenerima') && 
                               item.hasOwnProperty('nik') && 
                               item.hasOwnProperty('noTelepon') && 
                               item.hasOwnProperty('alamat') && 
                               item.hasOwnProperty('kecamatan') && 
                               item.hasOwnProperty('jenisBantuan') && 
                               item.hasOwnProperty('tanggalPenyaluran');
                    });
                    
                    if (!isValid) {
                        throw new Error('Format data dalam file backup tidak valid');
                    }
                    
                    // Konfirmasi restore
                    if (confirm('Apakah Anda yakin ingin memulihkan data dari backup? Data saat ini akan digantikan.')) {
                        bantuanData = restoredData;
                        saveData();
                        renderDataTable();
                        updateDashboard();
                        
                        showNotification('Restore Berhasil', 'Data berhasil dipulihkan dari backup', 'success');
                    }
                } catch (error) {
                    console.error('Error restoring data:', error);
                    showNotification('Restore Gagal', 'Terjadi kesalahan saat memulihkan data. Pastikan file backup valid.', 'error');
                }
            };
            reader.readAsText(file);
            
            // Reset input file
            event.target.value = '';
        }
        
        // Reset semua data
        function resetAllData() {
            const password = document.getElementById('resetPassword').value;
            const confirmation = document.getElementById('resetConfirmation').checked;
            
            if (password !== securityCode) {
                showNotification('Reset Gagal', 'Kata sandi tidak valid', 'error');
                return;
            }
            
            if (!confirmation) {
                showNotification('Reset Gagal', 'Anda harus mencentang konfirmasi', 'error');
                return;
            }
            
            // Reset data
            bantuanData = [];
            saveData();
            renderDataTable();
            updateDashboard();
            
            // Tutup modal
            $('#resetDataModal').modal('hide');
            
            // Reset form konfirmasi
            document.getElementById('resetPassword').value = '';
            document.getElementById('resetConfirmation').checked = false;
            
            showNotification('Reset Berhasil', 'Semua data telah direset', 'success');
        }
        
        // Simpan pengaturan akun
        function saveAccountSettings() {
            const namaInstansi = document.getElementById('namaInstansi').value;
            const namaPengguna = document.getElementById('namaPengguna').value;
            const kataSandiBaru = document.getElementById('kataSandiBaru').value;
            const konfirmasiKataSandi = document.getElementById('konfirmasiKataSandi').value;
            
            if (kataSandiBaru && kataSandiBaru !== konfirmasiKataSandi) {
                showNotification('Penyimpanan Gagal', 'Kata sandi baru dan konfirmasi tidak cocok', 'error');
                return;
            }
            
            const settings = {
                namaInstansi: namaInstansi,
                namaPengguna: namaPengguna,
                securityCode: securityCode
            };
            
            // Jika kata sandi diubah, update securityCode
            if (kataSandiBaru) {
                settings.securityCode = kataSandiBaru;
                securityCode = kataSandiBaru;
            }
            
            localStorage.setItem('appSettings', JSON.stringify(settings));
            document.getElementById('institutionName').textContent = namaInstansi;
            
            // Reset form kata sandi
            document.getElementById('kataSandiBaru').value = '';
            document.getElementById('konfirmasiKataSandi').value = '';
            
            showNotification('Penyimpanan Berhasil', 'Pengaturan akun berhasil disimpan', 'success');
        }
        
        // Tampilkan notifikasi
        function showNotification(title, message, type = 'info') {
            const toast = document.querySelector('.toast');
            const toastTitle = document.getElementById('toastTitle');
            const toastMessage = document.getElementById('toastMessage');
            const toastTime = document.getElementById('toastTime');
            
            // Set title and message
            toastTitle.textContent = title;
            toastMessage.textContent = message;
            toastTime.textContent = 'Baru saja';
            
            // Set color based on type
            switch (type) {
                case 'success':
                    toast.classList.add('bg-success', 'text-white');
                    break;
                case 'error':
                    toast.classList.add('bg-danger', 'text-white');
                    break;
                case 'warning':
                    toast.classList.add('bg-warning');
                    break;
                default:
                    toast.classList.add('bg-info', 'text-white');
            }
            
            // Show toast
            const bsToast = new bootstrap.Toast(toast);
            bsToast.show();
        }
    </script>
</body>
</html>
