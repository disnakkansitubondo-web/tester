<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APLIKASI BARJAS - Dinas Peternakan dan Perikanan Situbondo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary-color: #0d47a1;
            --secondary-color: #00695c;
            --accent-color: #ff8f00;
            --light-blue: #e3f2fd;
            --dark-blue: #082e5c;
            --gradient-primary: linear-gradient(135deg, var(--primary-color), var(--dark-blue));
            --gradient-secondary: linear-gradient(135deg, var(--secondary-color), #004d40);
            --gradient-accent: linear-gradient(135deg, var(--accent-color), #e65100);
            --shadow-sm: 0 2px 8px rgba(0,0,0,0.08);
            --shadow-md: 0 4px 16px rgba(0,0,0,0.12);
            --shadow-lg: 0 8px 28px rgba(0,0,0,0.15);
        }
        
        body {
            background: linear-gradient(135deg, #f5f9ff 0%, #e8f5e9 100%);
            font-family: 'Poppins', 'Segoe UI', sans-serif;
            min-height: 100vh;
            padding: 10px 0;
            overflow-x: hidden;
        }
        
        /* Container untuk particles.js */
        #particles-js {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
        }
        
        .app-container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            box-shadow: var(--shadow-lg);
            border-radius: 12px;
            overflow: hidden;
            position: relative;
            z-index: 10;
        }
        
        .app-header {
            background: var(--gradient-primary);
            color: white;
            padding: 20px 15px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .app-header::before {
            content: "";
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.15) 0%, transparent 70%);
            pointer-events: none;
        }
        
        .app-logo {
            font-size: 2.5rem;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }
        
        .app-title {
            font-size: 1.8rem;
            font-weight: 800;
            margin: 0;
            position: relative;
            z-index: 1;
            text-shadow: 1px 1px 4px rgba(0,0,0,0.3);
        }
        
        .app-subtitle {
            font-size: 1rem;
            opacity: 0.95;
            position: relative;
            z-index: 1;
            font-weight: 300;
            letter-spacing: 0.5px;
            margin-bottom: 5px;
        }
        
        .nav-pills .nav-link {
            border-radius: 8px;
            margin-bottom: 8px;
            padding: 12px 15px;
            font-weight: 500;
            color: #444;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            font-size: 0.9rem;
        }
        
        .nav-pills .nav-link:hover {
            background-color: #f0f7ff;
            transform: translateX(3px);
        }
        
        .nav-pills .nav-link.active {
            background: var(--gradient-primary);
            font-weight: 600;
            box-shadow: var(--shadow-md);
            transform: translateX(3px);
        }
        
        .section-title {
            border-left: 4px solid var(--primary-color);
            padding-left: 12px;
            margin: 20px 0;
            font-weight: 700;
            color: var(--dark-blue);
            font-size: 1.4rem;
            position: relative;
        }
        
        .section-title::after {
            content: "";
            position: absolute;
            bottom: -5px;
            left: 12px;
            width: 40px;
            height: 2px;
            background: var(--gradient-primary);
            border-radius: 2px;
        }
        
        .btn-primary {
            background: var(--gradient-primary);
            border: none;
            padding: 10px 20px;
            font-weight: 600;
            box-shadow: var(--shadow-md);
            border-radius: 8px;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .btn-success {
            background: var(--gradient-secondary);
            border: none;
            padding: 10px 20px;
            font-weight: 600;
            box-shadow: var(--shadow-md);
            border-radius: 8px;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .btn-warning {
            background: var(--gradient-accent);
            border: none;
            padding: 10px 20px;
            font-weight: 600;
            box-shadow: var(--shadow-md);
            border-radius: 8px;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .btn-warning:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .form-label {
            font-weight: 600;
            color: #444;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            font-size: 0.9rem;
        }
        
        .form-label i {
            margin-right: 6px;
            color: var(--primary-color);
        }
        
        .form-control, .form-select {
            border-radius: 8px;
            padding: 12px 15px;
            border: 1px solid #ddd;
            transition: all 0.3s;
            box-shadow: var(--shadow-sm);
            font-size: 0.9rem;
        }
        
        .form-control:focus, .form-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(13, 71, 161, 0.2);
            transform: translateY(-2px);
        }
        
        .copyright {
            text-align: center;
            padding: 20px;
            background-color: var(--light-blue);
            color: var(--dark-blue);
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .data-table {
            font-size: 0.85rem;
            border-collapse: separate;
            border-spacing: 0;
            box-shadow: var(--shadow-sm);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .data-table th {
            background: var(--gradient-primary);
            color: white;
            font-weight: 600;
            padding: 12px 10px;
            text-align: center;
            position: relative;
            font-size: 0.85rem;
        }
        
        .data-table th::after {
            content: "";
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 1px;
            background: rgba(255,255,255,0.3);
        }
        
        .data-table td {
            padding: 10px 8px;
            vertical-align: middle;
            border-bottom: 1px solid #eee;
            font-size: 0.85rem;
        }
        
        .data-table tr:nth-child(even) {
            background-color: #f9fbff;
        }
        
        .data-table tr:hover {
            background-color: #edf5ff;
        }
        
        .feature-icon {
            font-size: 1.1rem;
            margin-right: 8px;
            width: 24px;
            text-align: center;
        }
        
        .password-modal .modal-content {
            border-radius: 12px;
            box-shadow: var(--shadow-lg);
            border: none;
        }
        
        .card {
            border-radius: 10px;
            border: none;
            box-shadow: var(--shadow-md);
            transition: all 0.3s ease;
            overflow: hidden;
            margin-bottom: 15px;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        
        .card-header {
            border-radius: 10px 10px 0 0 !important;
            font-weight: 600;
            padding: 15px 20px;
            background: var(--gradient-primary);
            color: white;
            font-size: 0.95rem;
        }
        
        .stats-box {
            text-align: center;
            padding: 20px 15px;
            border-radius: 10px;
            background: white;
            box-shadow: var(--shadow-md);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
            margin-bottom: 15px;
        }
        
        .stats-box::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--gradient-primary);
            border-radius: 2px;
        }
        
        .stats-box:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }
        
        .stats-number {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--primary-color);
            margin: 10px 0;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        
        .stats-label {
            font-size: 0.9rem;
            color: #666;
            font-weight: 500;
        }
        
        .notification-toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1050;
            min-width: 280px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: var(--shadow-lg);
            max-width: calc(100vw - 40px);
        }
        
        .input-error {
            border-color: #dc3545;
            box-shadow: 0 0 0 3px rgba(220, 53, 69, 0.2);
        }
        
        .error-message {
            color: #dc3545;
            font-size: 0.8rem;
            margin-top: 5px;
            display: none;
            font-weight: 500;
        }
        
        .watermark {
            position: absolute;
            bottom: 10px;
            right: 15px;
            opacity: 0.8;
            font-size: 0.8rem;
            color: white;
            font-weight: 300;
        }
        
        .control-panel {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            box-shadow: var(--shadow-sm);
        }
        
        .control-title {
            font-size: 1rem;
            color: var(--primary-color);
            font-weight: 600;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--light-blue);
        }
        
        .floating-action-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--gradient-primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .floating-action-btn:hover {
            transform: scale(1.1) rotate(90deg);
        }
        
        .filter-section {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-sm);
        }
        
        .badge-custom {
            background: var(--gradient-primary);
            color: white;
            padding: 6px 12px;
            border-radius: 16px;
            font-weight: 600;
            font-size: 0.8rem;
        }
        
        .mobile-menu-btn {
            display: none;
            position: fixed;
            top: 15px;
            left: 15px;
            z-index: 1050;
            background: var(--gradient-primary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            box-shadow: var(--shadow-lg);
        }
        
        .sidebar-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1040;
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-fadeIn {
            animation: fadeIn 0.5s ease forwards;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 8px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 8px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--dark-blue);
        }
        
        /* Responsive styles */
        @media (max-width: 991.98px) {
            .col-md-3.col-lg-2 {
                position: fixed;
                left: -300px;
                top: 0;
                bottom: 0;
                z-index: 1050;
                width: 280px;
                transition: left 0.3s ease;
                overflow-y: auto;
                padding-top: 60px;
            }
            
            .col-md-3.col-lg-2.mobile-show {
                left: 0;
            }
            
            .col-md-9.col-lg-10 {
                width: 100%;
                flex: 0 0 100%;
                max-width: 100%;
            }
            
            .mobile-menu-btn {
                display: flex;
                align-items: center;
                justify-content: center;
            }
            
            .sidebar-overlay.mobile-show {
                display: block;
            }
        }
        
        /* Print Styles - IMPROVED FOR LANDSCAPE */
        @media print {
            @page {
                size: landscape;
                margin: 0.5cm;
            }
            
            body * {
                visibility: hidden;
            }
            
            .app-container, .app-container * {
                visibility: visible;
            }
            
            .app-container {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                box-shadow: none;
            }
            
            .nav-pills, .mobile-menu-btn, .sidebar-overlay, .floating-action-btn,
            .btn-group, .filter-section, .toast {
                display: none !important;
            }
            
            .col-md-3.col-lg-2.p-4.bg-light {
                display: none !important;
            }
            
            .col-md-9.col-lg-10.p-5 {
                width: 100%;
                flex: 0 0 100%;
                max-width: 100%;
                padding: 0 !important;
            }
            
            .copyright {
                display: none;
            }
            
            .data-table {
                font-size: 10px;
                width: 100% !important;
            }
            
            .data-table th, .data-table td {
                padding: 4px 2px;
            }
            
            /* Sembunyikan kolom aksi dan link Google Drive saat mencetak */
            .data-table th:last-child,
            .data-table td:last-child {
                display: none !important;
            }
            
            /* Judul untuk laporan cetak */
            .print-header {
                display: block !important;
                text-align: center;
                margin-bottom: 15px;
            }
            
            .print-title {
                font-size: 18px;
                font-weight: bold;
                margin-bottom: 5px;
            }
            
            .print-subtitle {
                font-size: 14px;
                margin-bottom: 10px;
            }
            
            .print-date {
                font-size: 12px;
                text-align: right;
                margin-bottom: 10px;
            }
        }

        /* Styling untuk form link Google Drive */
        .link-section {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-sm);
        }

        .link-section-title {
            font-size: 1.1rem;
            color: var(--primary-color);
            font-weight: 600;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 1px solid #dee2e6;
        }

        .link-input-group {
            margin-bottom: 10px;
        }
        
        /* GPS Button */
        .gps-button {
            margin-top: 8px;
            padding: 8px 12px;
            font-size: 0.85rem;
        }
        
        /* View Links Modal */
        .links-modal .modal-dialog {
            max-width: 800px;
        }
        
        .link-item {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .link-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .link-label {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--primary-color);
        }
        
        .link-url {
            word-break: break-all;
            margin-bottom: 5px;
        }
        
        /* Security code hidden by default */
        .security-code {
            display: none;
        }
        
        /* Print header hidden by default */
        .print-header {
            display: none;
        }
        
        /* WhatsApp link style */
        .whatsapp-link {
            color: #25D366;
            text-decoration: none;
        }
        
        .whatsapp-link:hover {
            text-decoration: underline;
        }
        
        /* View Link Button */
        .btn-view {
            background: linear-gradient(135deg, #17a2b8, #138496);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
        }
        
        .btn-view:hover {
            background: linear-gradient(135deg, #138496, #117a8b);
            color: white;
        }
        
        /* Undo Button */
        .btn-undo {
            background: linear-gradient(135deg, #6c757d, #5a6268);
            color: white;
            border: none;
        }
        
        .btn-undo:hover {
            background: linear-gradient(135deg, #5a6268, #4e555b);
            color: white;
        }
        
        /* WhatsApp number link in table */
        .whatsapp-number {
            color: #25D366;
            cursor: pointer;
            text-decoration: underline;
        }
        
        /* Welcome Modal Styles */
        .welcome-modal .modal-content {
            border-radius: 15px;
            overflow: hidden;
            border: none;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .welcome-header {
            background: var(--gradient-primary);
            color: white;
            text-align: center;
            padding: 25px;
        }
        
        .welcome-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }
        
        .welcome-body {
            padding: 25px;
            text-align: center;
        }
        
        .welcome-footer {
            background: #f8f9fa;
            padding: 15px;
            text-align: center;
            border-top: 1px solid #eee;
        }
        
        .countdown-timer {
            font-size: 0.9rem;
            color: #6c757d;
            margin-top: 10px;
        }
        
        /* Button untuk cetak per data */
        .btn-print-individual {
            background: linear-gradient(135deg, #6f42c1, #5a2d95);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
        }
        
        .btn-print-individual:hover {
            background: linear-gradient(135deg, #5a2d95, #4a2479);
            color: white;
        }
        
        /* Developer Info Styles */
        .developer-info {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: var(--shadow-sm);
        }
        
        .developer-logo {
            max-width: 120px;
            margin-bottom: 15px;
            border-radius: 8px;
        }
        
        .developer-contact a {
            color: var(--primary-color);
            text-decoration: none;
            transition: all 0.3s;
        }
        
        .developer-contact a:hover {
            color: var(--dark-blue);
            text-decoration: underline;
        }
        
        /* Welcome Splash Screen */
        .welcome-splash {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient-primary);
            color: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }
        
        .welcome-splash-content {
            text-align: center;
            max-width: 600px;
            padding: 30px;
        }
        
        .welcome-splash-logo {
            font-size: 4rem;
            margin-bottom: 20px;
        }
        
        .welcome-splash-title {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 15px;
        }
        
        .welcome-splash-message {
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 25px;
        }
        
        .welcome-splash-countdown {
            font-size: 1rem;
            margin-top: 20px;
        }
        
        .welcome-splash-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .welcome-splash-close:hover {
            background: rgba(255,255,255,0.3);
            transform: rotate(90deg);
        }
        
        /* Map Autocomplete */
        .pac-container {
            z-index: 1060 !important;
            border-radius: 8px;
            box-shadow: var(--shadow-lg);
            border: none;
            margin-top: 5px;
        }
        
        .pac-item {
            padding: 8px 10px;
            cursor: pointer;
            border-bottom: 1px solid #eee;
        }
        
        .pac-item:hover {
            background-color: #f5f5f5;
        }
        
        .pac-item-query {
            font-size: 0.9rem;
            color: var(--primary-color);
        }
        
        /* Loading spinner */
        .spinner-border-sm {
            width: 1rem;
            height: 1rem;
        }
    </style>
</head>
<body>
    <!-- Welcome Splash Screen -->
    <div class="welcome-splash" id="welcomeSplash">
        <button class="welcome-splash-close" id="closeSplash">
            <i class="fas fa-times"></i>
        </button>
        <div class="welcome-splash-content">
            <div class="welcome-splash-logo">
                <i class="fas fa-hand-holding-water"></i>
            </div>
            <h1 class="welcome-splash-title">Selamat Datang di APLIKASI BARJAS</h1>
            <p class="welcome-splash-message">
                Aplikasi Bantuan Barang dan Jasa - Dinas Peternakan dan Perikanan Situbondo.<br>
                Terima kasih telah menggunakan aplikasi kami. Semoga aplikasi ini dapat membantu 
                dalam pengelolaan data bantuan secara efektif dan efisien.
            </p>
            <div class="welcome-splash-countdown">
                Aplikasi akan dimuat dalam: <span id="splashCountdown">8</span> detik
            </div>
        </div>
    </div>

    <!-- Particle Background -->
    <div id="particles-js"></div>

    <button class="mobile-menu-btn" id="mobileMenuBtn">
        <i class="fas fa-bars"></i>
    </button>
    
    <div class="sidebar-overlay" id="sidebarOverlay"></div>

    <div class="app-container">
        <div class="app-header">
            <div class="app-logo">
                <i class="fas fa-hand-holding-water"></i>
            </div>
            <h1 class="app-title">APLIKASI BARJAS</h1>
            <p class="app-subtitle">Dinas Peternakan dan Perikanan Situbondo</p>
            <div class="watermark">Lentera Karya Situbondo © 2025</div>
        </div>

        <div class="container-fluid">
            <div class="row">
                <div class="col-md-3 col-lg-2 p-4 bg-light">
                    <ul class="nav nav-pills flex-column" id="myTab" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active" id="input-tab" data-bs-toggle="tab" href="#input" role="tab">
                                <i class="fas fa-pen feature-icon"></i>Input & Data
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="stats-tab" data-bs-toggle="tab" href="#stats" role="tab">
                                <i class="fas fa-chart-pie feature-icon"></i>Statistik
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="backup-tab" data-bs-toggle="tab" href="#backup" role="tab">
                                <i class="fas fa-cloud-download-alt feature-icon"></i>Backup & Restore
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="control-tab" data-bs-toggle="tab" href="#control" role="tab">
                                <i class="fas fa-cog feature-icon"></i>Kontrol Panel
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="about-tab" data-bs-toggle="tab" href="#about" role="tab">
                                <i class="fas fa-info-circle feature-icon"></i>Tentang
                            </a>
                        </li>
                    </ul>
                    
                    <div class="mt-4 p-3 bg-white rounded" style="box-shadow: var(--shadow-sm);">
                        <h6 class="text-center mb-3" style="color: var(--primary-color); font-weight: 600;">Total Data</6>
                        <div class="d-flex justify-content-around">
                            <div class="text-center">
                                <div class="fw-bold fs-4 text-primary" id="total-data">0</div>
                                <div class="text-muted small">Data</div>
                            </div>
                            <div class="text-center">
                                <div class="fw-bold fs-4 text-primary" id="current-year">2025</div>
                                <div class="text-muted small">Tahun</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="control-panel">
                        <h6 class="control-title"><i class="fas fa-user-cog me-2"></i>Kontrol Cepat</h6>
                        <div class="d-grid gap-2">
                            <button class="btn btn-outline-primary btn-sm" id="quickBackupBtn">
                                <i class="fas fa-download me-2"></i>Backup Cepat
                            </button>
                            <button class="btn btn-outline-info btn-sm" id="refreshDataBtn">
                                <i class="fas fa-sync-alt me-2"></i>Refresh Data
                            </button>
                            <button class="btn btn-outline-warning btn-sm" id="clearFormBtn">
                                <i class="fas fa-eraser me-2"></i>Bersihkan Form
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-9 col-lg-10 p-5">
                    <div class="tab-content" id="myTabContent">
                        <!-- Input & Data Tab -->
                        <div class="tab-pane fade show active" id="input" role="tabpanel">
                            <h3 class="section-title">Input Data Bantuan</h3>
                            
                            <div class="card mb-4">
                                <div class="card-header">
                                    <i class="fas fa-pen me-2"></i>Form Input Data
                                </div>
                                <div class="card-body">
                                    <form id="inputForm">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label for="nama" class="form-label"><i class="fas fa-user"></i>Nama Penerima</label>
                                                    <input type="text" class="form-control" id="nama" placeholder="Masukkan nama lengkap" required oninput="this.value = this.value.toUpperCase()">
                                                    <div class="error-message" id="nama-error">Nama harus diisi</div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label for="nik" class="form-label"><i class="fas fa-id-card"></i>NIK KTP</label>
                                                    <input type="text" class="form-control" id="nik" placeholder="Masukkan 16 digit NIK" maxlength="16" required>
                                                    <div class="error-message" id="nik-error">NIK harus 16 digit angka</div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label for="jabatan" class="form-label"><i class="fas fa-briefcase"></i>Jabatan</label>
                                                    <select class="form-select" id="jabatan" required>
                                                        <option value="" selected disabled>Pilih jabatan</option>
                                                        <option value="Ketua Kelompok">Ketua Kelompok</option>
                                                        <option value="Sekretaris">Sekretaris</option>
                                                        <option value="Bendahara">Bendahara</option>
                                                        <option value="Pengawas">Pengawas</option>
                                                        <option value="Anggota">Anggota</option>
                                                    </select>
                                                    <div class="error-message" id="jabatan-error">Jabatan harus dipilih</div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label for="kelompok" class="form-label"><i class="fas fa-users"></i>Nama Kelompok</label>
                                                    <input type="text" class="form-control" id="kelompok" placeholder="Masukkan nama kelompok" required oninput="this.value = this.value.toUpperCase()">
                                                    <div class="error-message" id="kelompok-error">Nama kelompok harus diisi</div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label for="whatsapp" class="form-label"><i class="fab fa-whatsapp"></i>Nomor WhatsApp</label>
                                                    <input type="text" class="form-control" id="whatsapp" placeholder="Contoh: 081234567890" required oninput="formatWhatsApp(this)">
                                                    <div class="error-message" id="whatsapp-error">Nomor WhatsApp harus diisi</div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label for="kodeBarang" class="form-label"><i class="fas fa-barcode"></i>Kode Barang</label>
                                                    <input type="text" class="form-control" id="kodeBarang" placeholder="Masukkan kode barang">
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label for="namaBarang" class="form-label"><i class="fas fa-box"></i>Nama Barang</label>
                                                    <input type="text" class="form-control" id="namaBarang" placeholder="Masukkan nama barang" required oninput="this.value = this.value.toUpperCase()">
                                                    <div class="error-message" id="namaBarang-error">Nama barang harus diisi</div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label for="jumlah" class="form-label"><i class="fas fa-hashtag"></i>Jumlah Barang</label>
                                                    <input type="number" class="form-control" id="jumlah" placeholder="Masukkan jumlah barang" min="1" required>
                                                    <div class="error-message" id="jumlah-error">Jumlah barang harus diisi</div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label for="satuan" class="form-label"><i class="fas fa-balance-scale"></i>Satuan</label>
                                                    <select class="form-select" id="satuan" required>
                                                        <option value="" selected disabled>Pilih satuan</option>
                                                        <option value="Unit">Unit</option>
                                                        <option value="Buah">Buah</option>
                                                        <option value="Paket">Paket</option>
                                                        <option value="Set">Set</option>
                                                        <option value="Ekor">Ekor</option>
                                                        <option value="Kilogram">Kilogram</option>
                                                        <option value="Liter">Liter</option>
                                                    </select>
                                                    <div class="error-message" id="satuan-error">Satuan harus dipilih</div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label for="tahunAnggaran" class="form-label"><i class="fas fa-calendar-alt"></i>Tahun Anggaran</label>
                                                    <select class="form-select" id="tahunAnggaran" required>
                                                        <option value="" selected disabled>Pilih tahun anggaran</option>
                                                        <!-- Tahun akan diisi oleh JavaScript -->
                                                    </select>
                                                    <div class="error-message" id="tahunAnggaran-error">Tahun anggaran harus dipilih</div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="mb-3">
                                            <label for="alamatLengkap" class="form-label"><i class="fas fa-map-marker-alt"></i>Alamat Lengkap</label>
                                            <textarea class="form-control" id="alamatLengkap" rows="3" placeholder="Masukkan alamat lengkap" required oninput="this.value = this.value.toUpperCase()"></textarea>
                                            <button type="button" class="btn btn-outline-primary mt-2 gps-button" id="gpsButton">
                                                <i class="fas fa-map-marker-alt me-1"></i> Gunakan GPS untuk Mendapatkan Lokasi
                                            </button>
                                            <div class="error-message" id="alamatLengkap-error">Alamat lengkap harus diisi</div>
                                        </div>
                                        
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label for="desa" class="form-label"><i class="fas fa-map-marked-alt"></i>Desa</label>
                                                    <select class="form-select" id="desa" required>
                                                        <option value="" selected disabled>Pilih desa</option>
                                                        <!-- Opsi desa akan diisi oleh JavaScript -->
                                                    </select>
                                                    <div class="error-message" id="desa-error">Desa harus dipilih</div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label for="kecamatan" class="form-label"><i class="fas fa-map"></i>Kecamatan</label>
                                                    <select class="form-select" id="kecamatan" required>
                                                        <option value="" selected disabled>Pilih kecamatan</option>
                                                        <option value="Arjasa">Arjasa</option>
                                                        <option value="Asembagus">Asembagus</option>
                                                        <option value="Banyuglugur">Banyuglugur</option>
                                                        <option value="Banyuputih">Banyuputih</option>
                                                        <option value="Besuki">Besuki</option>
                                                        <option value="Bungatan">Bungatan</option>
                                                        <option value="Jangkar">Jangkar</option>
                                                        <option value="Jatibanteng">Jatibanteng</option>
                                                        <option value="Kapongan">Kapongan</option>
                                                        <option value="Kendit">Kendit</option>
                                                        <option value="Mangaran">Mangaran</option>
                                                        <option value="Mlandingan">Mlandingan</option>
                                                        <option value="Panarukan">Panarukan</option>
                                                        <option value="Panji">Panji</option>
                                                        <option value="Situbondo">Situbondo</option>
                                                        <option value="Suboh">Suboh</option>
                                                        <option value="Sumbermalang">Sumbermalang</option>
                                                    </select>
                                                    <div class="error-message" id="kecamatan-error">Kecamatan harus dipilih</div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="mb-3">
                                            <label for="keterangan" class="form-label"><i class="fas fa-sticky-note"></i>Keterangan</label>
                                            <textarea class="form-control" id="keterangan" rows="2" placeholder="Tambahkan keterangan jika perlu"></textarea>
                                        </div>
                                        
                                        <div class="link-section">
                                            <h6 class="link-section-title"><i class="fas fa-link me-2"></i>Link Google Drive</h6>
                                            <div class="link-input-group">
                                                <label for="linkLabel" class="form-label">Label Link</label>
                                                <input type="text" class="form-control" id="linkLabel" placeholder="Contoh: Foto KTP, Foto Barang, dll.">
                                            </div>
                                            <div class="link-input-group">
                                                <label for="linkUrl" class="form-label">URL Link</label>
                                                <input type="url" class="form-control" id="linkUrl" placeholder="https://drive.google.com/...">
                                            </div>
                                            <button type="button" class="btn btn-outline-primary btn-sm mt-2" id="addLinkBtn">
                                                <i class="fas fa-plus me-1"></i> Tambah Link
                                            </button>
                                            <div id="linkList" class="mt-3"></div>
                                        </div>
                                        
                                        <div class="d-flex justify-content-between mt-4">
                                            <button type="button" class="btn btn-secondary" id="resetBtn">
                                                <i class="fas fa-redo me-1"></i> Reset Form
                                            </button>
                                            <button type="submit" class="btn btn-primary" id="simpanBtn">
                                                <i class="fas fa-save me-1"></i> Simpan Data
                                            </button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                            
                            <h3 class="section-title">Data Bantuan Tersimpan</h3>
                            
                            <div class="filter-section">
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label for="filterTahun" class="form-label"><i class="fas fa-filter"></i>Filter Tahun</label>
                                            <select class="form-select" id="filterTahun">
                                                <option value="">Semua Tahun</option>
                                                <!-- Tahun akan diisi oleh JavaScript -->
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label for="filterKecamatan" class="form-label"><i class="fas fa-filter"></i>Filter Kecamatan</label>
                                            <select class="form-select" id="filterKecamatan">
                                                <option value="">Semua Kecamatan</option>
                                                <option value="Arjasa">Arjasa</option>
                                                <option value="Asembagus">Asembagus</option>
                                                <option value="Banyuglugur">Banyuglugur</option>
                                                <option value="Banyuputih">Banyuputih</option>
                                                <option value="Besuki">Besuki</option>
                                                <option value="Bungatan">Bungatan</option>
                                                <option value="Jangkar">Jangkar</option>
                                                <option value="Jatibanteng">Jatibanteng</option>
                                                <option value="Kapongan">Kapongan</option>
                                                <option value="Kendit">Kendit</option>
                                                <option value="Mangaran">Mangaran</option>
                                                <option value="Mlandingan">Mlandingan</option>
                                                <option value="Panarukan">Panarukan</option>
                                                <option value="Panji">Panji</option>
                                                <option value="Situbondo">Situbondo</option>
                                                <option value="Suboh">Suboh</option>
                                                <option value="Sumbermalang">Sumbermalang</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label for="filterDesa" class="form-label"><i class="fas fa-filter"></i>Filter Desa</label>
                                            <select class="form-select" id="filterDesa">
                                                <option value="">Semua Desa</option>
                                                <!-- Opsi desa akan diisi oleh JavaScript -->
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label for="searchInput" class="form-label"><i class="fas fa-search"></i>Pencarian</label>
                                            <input type="text" class="form-control" id="searchInput" placeholder="Cari data...">
                                        </div>
                                    </div>
                                </div>
                                <div class="d-flex justify-content-between">
                                    <div class="d-flex gap-2">
                                        <button class="btn btn-outline-primary btn-sm" id="exportExcelBtn">
                                            <i class="fas fa-file-excel me-1"></i> Export Excel
                                        </button>
                                        <button class="btn btn-outline-danger btn-sm" id="exportPdfBtn">
                                            <i class="fas fa-file-pdf me-1"></i> Export PDF
                                        </button>
                                        <button class="btn btn-outline-info btn-sm" id="printBtn">
                                            <i class="fas fa-print me-1"></i> Cetak
                                        </button>
                                    </div>
                                    <div>
                                        <button class="btn btn-outline-warning btn-sm" id="viewLinksBtn">
                                            <i class="fas fa-eye me-1"></i> Lihat Semua Link
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="table-responsive">
                                <table class="table table-hover data-table" id="dataTable">
                                    <thead>
                                        <tr>
                                            <th>No</th>
                                            <th>Nama</th>
                                            <th>NIK</th>
                                            <th>Kelompok</th>
                                            <th>WhatsApp</th>
                                            <th>Barang</th>
                                            <th>Jumlah</th>
                                            <th>Tahun</th>
                                            <th>Desa</th>
                                            <th>Kecamatan</th>
                                            <th>Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody id="tableBody">
                                        <!-- Data akan diisi oleh JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                            
                            <div class="d-flex justify-content-between align-items-center mt-3">
                                <div class="text-muted small" id="tableInfo">Menampilkan 0 data</div>
                                <nav>
                                    <ul class="pagination pagination-sm" id="pagination">
                                        <!-- Pagination akan diisi oleh JavaScript -->
                                    </ul>
                                </nav>
                            </div>
                        </div>
                        
                        <!-- Statistik Tab -->
                        <div class="tab-pane fade" id="stats" role="tabpanel">
                            <h3 class="section-title">Statistik Data Bantuan</h3>
                            
                            <div class="row mb-4">
                                <div class="col-md-3">
                                    <div class="stats-box">
                                        <i class="fas fa-users fa-2x text-primary"></i>
                                        <div class="stats-number" id="totalPenerima">0</div>
                                        <div class="stats-label">Total Penerima</div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="stats-box">
                                        <i class="fas fa-box fa-2x text-primary"></i>
                                        <div class="stats-number" id="totalBarang">0</div>
                                        <div class="stats-label">Total Barang</div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="stats-box">
                                        <i class="fas fa-calendar fa-2x text-primary"></i>
                                        <div class="stats-number" id="tahunTerbanyak">-</div>
                                        <div class="stats-label">Tahun Terbanyak</div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="stats-box">
                                        <i class="fas fa-map-marker-alt fa-2x text-primary"></i>
                                        <div class="stats-number" id="kecamatanTerbanyak">-</div>
                                        <div class="stats-label">Kecamatan Terbanyak</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="card mb-4">
                                        <div class="card-header">
                                            <i class="fas fa-chart-bar me-2"></i>Data per Tahun
                                        </div>
                                        <div class="card-body">
                                            <canvas id="tahunChart" height="250"></canvas>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="card mb-4">
                                        <div class="card-header">
                                            <i class="fas fa-chart-pie me-2"></i>Data per Kecamatan
                                        </div>
                                        <div class="card-body">
                                            <canvas id="kecamatanChart" height="250"></canvas>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="card mb-4">
                                        <div class="card-header">
                                            <i class="fas fa-chart-pie me-2"></i>Data per Jenis Barang
                                        </div>
                                        <div class="card-body">
                                            <canvas id="barangChart" height="250"></canvas>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="card mb-4">
                                        <div class="card-header">
                                            <i class="fas fa-table me-2"></i>Rekapitulasi Data
                                        </div>
                                        <div class="card-body">
                                            <div class="table-responsive">
                                                <table class="table table-sm table-bordered">
                                                    <thead class="table-light">
                                                        <tr>
                                                            <th>Tahun</th>
                                                            <th>Jumlah Penerima</th>
                                                            <th>Total Barang</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody id="rekapitulasiTable">
                                                        <!-- Data akan diisi oleh JavaScript -->
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Backup & Restore Tab -->
                        <div class="tab-pane fade" id="backup" role="tabpanel">
                            <h3 class="section-title">Backup & Restore Data</h3>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="card mb-4">
                                        <div class="card-header">
                                            <i class="fas fa-download me-2"></i>Backup Data
                                        </div>
                                        <div class="card-body">
                                            <p>Backup data ke file Excel untuk keperluan arsip atau cadangan.</p>
                                            <div class="d-grid gap-2">
                                                <button class="btn btn-primary" id="backupExcelBtn">
                                                    <i class="fas fa-file-excel me-2"></i>Backup ke Excel
                                                </button>
                                                <button class="btn btn-secondary" id="backupJsonBtn">
                                                    <i class="fas fa-file-code me-2"></i>Backup ke JSON
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="card mb-4">
                                        <div class="card-header">
                                            <i class="fas fa-upload me-2"></i>Restore Data
                                        </div>
                                        <div class="card-body">
                                            <p>Restore data dari file Excel atau JSON yang sebelumnya telah di-backup.</p>
                                            <div class="mb-3">
                                                <label for="restoreFile" class="form-label">Pilih File</label>
                                                <input class="form-control" type="file" id="restoreFile" accept=".xlsx,.json">
                                            </div>
                                            <div class="d-grid">
                                                <button class="btn btn-warning" id="restoreBtn">
                                                    <i class="fas fa-upload me-2"></i>Restore Data
                                                </button>
                                            </div>
                                            <div class="form-text text-danger">
                                                <i class="fas fa-exclamation-triangle me-1"></i>
                                                Peringatan: Restore data akan menimpa semua data yang ada saat ini.
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card">
                                <div class="card-header">
                                    <i class="fas fa-history me-2"></i>Riwayat Backup
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-sm">
                                            <thead>
                                                <tr>
                                                    <th>Tanggal</th>
                                                    <th>Jenis</th>
                                                    <th>Jumlah Data</th>
                                                    <th>Aksi</th>
                                                </tr>
                                            </thead>
                                            <tbody id="backupHistory">
                                                <!-- Data akan diisi oleh JavaScript -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Control Panel Tab -->
                        <div class="tab-pane fade" id="control" role="tabpanel">
                            <h3 class="section-title">Kontrol Panel</h3>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="card mb-4">
                                        <div class="card-header">
                                            <i class="fas fa-database me-2"></i>Manajemen Data
                                        </div>
                                        <div class="card-body">
                                            <div class="d-grid gap-2">
                                                <button class="btn btn-danger" id="deleteAllBtn">
                                                    <i class="fas fa-trash me-2"></i>Hapus Semua Data
                                                </button>
                                                <button class="btn btn-warning" id="resetSettingsBtn">
                                                    <i class="fas fa-cog me-2"></i>Reset Pengaturan
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="card mb-4">
                                        <div class="card-header">
                                            <i class="fas fa-key me-2"></i>Keamanan
                                        </div>
                                        <div class="card-body">
                                            <div class="mb-3">
                                                <label for="securityCode" class="form-label">Kode Keamanan</label>
                                                <input type="password" class="form-control" id="securityCode" placeholder="Masukkan kode keamanan">
                                            </div>
                                            <div class="d-grid">
                                                <button class="btn btn-primary" id="setSecurityBtn">
                                                    <i class="fas fa-lock me-2"></i>Setel Kode Keamanan
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card mb-4">
                                <div class="card-header">
                                    <i class="fas fa-info-circle me-2"></i>Informasi Aplikasi
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <table class="table table-sm table-borderless">
                                                <tr>
                                                    <th width="40%">Versi Aplikasi</th>
                                                    <td>v2.0.0</td>
                                                </tr>
                                                <tr>
                                                    <th>Tanggal Rilis</th>
                                                    <td>24 Agustus 2025</td>
                                                </tr>
                                                <tr>
                                                    <th>Total Data</th>
                                                    <td id="infoTotalData">0</td>
                                                </tr>
                                                <tr>
                                                    <th>Ukuran Penyimpanan</th>
                                                    <td id="infoStorageSize">0 KB</td>
                                                </tr>
                                            </table>
                                        </div>
                                        <div class="col-md-6">
                                            <table class="table table-sm table-borderless">
                                                <tr>
                                                    <th width="40%">Browser</th>
                                                    <td id="infoBrowser">-</td>
                                                </tr>
                                                <tr>
                                                    <th>Local Storage</th>
                                                    <td id="infoLocalStorage">Tersedia</td>
                                                </tr>
                                                <tr>
                                                    <th>Status</th>
                                                    <td><span class="badge bg-success" id="infoStatus">Aktif</span></td>
                                                </tr>
                                                <tr>
                                                    <th>Terakhir Diperbarui</th>
                                                    <td id="infoLastUpdate">-</td>
                                                </tr>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- About Tab -->
                        <div class="tab-pane fade" id="about" role="tabpanel">
                            <h3 class="section-title">Tentang Aplikasi</h3>
                            
                            <div class="card mb-4">
                                <div class="card-header">
                                    <i class="fas fa-info-circle me-2"></i>Informasi Aplikasi
                                </div>
                                <div class="card-body">
                                    <p><strong>APLIKASI BARJAS</strong> (Bantuan Barang dan Jasa) adalah aplikasi untuk mengelola data bantuan barang dan jasa yang diberikan oleh Dinas Peternakan dan Perikanan Kabupaten Situbondo. Dan dirancang sejak 09 Agustus 2005.</p>
                                    <p>Aplikasi ini dirancang untuk memudahkan dalam:</p>
                                    <ul>
                                        <li>Input data penerima bantuan</li>
                                        <li>Pencatatan dan monitoring bantuan</li>
                                        <li>Pembuatan laporan dan statistik</li>
                                        <li>Backup dan restore data</li>
                                    </ul>
                                    <p>Aplikasi ini menggunakan teknologi web modern yang berjalan di browser dan menyimpan data secara lokal di perangkat pengguna.</p>
                                </div>
                            </div>
                            
                            <div class="card mb-4">
                                <div class="card-header">
                                    <i class="fas fa-code me-2"></i>Pengembang
                                </div>
                                <div class="card-body">
                                    <div class="developer-info text-center">
                                        <img src="https://raw.githubusercontent.com/LKS-88/anekamarket/refs/heads/main/Logo-Anekamarketku.png" alt="Lentera Karya" class="developer-logo">
                                        <h5>Lentera Karya Situbondo</h5>
                                        <p>Pengembang Aplikasi dan Solusi Teknologi</p>
                                        <div class="developer-contact">
                                            <p><i class="fas fa-envelope me-2"></i> <a href="mailto:lenterakarya.situbondo@gmail.com">lenterakarya.situbondo@gmail.com</a></p>
                                            <p><i class="fab fa-whatsapp me-2"></i> <a href="https://wa.me/628123456789" target="_blank">+62 812-3456-789</a></p>
                                            <p><i class="fas fa-map-marker-alt me-2"></i> Situbondo, Jawa Timur, Indonesia</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card">
                                <div class="card-header">
                                    <i class="fas fa-shield-alt me-2"></i>Kebijakan Privasi
                                </div>
                                <div class="card-body">
                                    <p>Aplikasi BARJAS menyimpan semua data secara lokal di perangkat pengguna. Data tidak dikirim ke server manapun dan hanya dapat diakses melalui perangkat ini.</p>
                                    <p>Untuk keamanan data, disarankan untuk melakukan backup data secara berkala ke file Excel atau JSON. Pengguna bertanggung jawab penuh atas keamanan data yang disimpan dalam aplikasi.</p>
                                    <p>Aplikasi ini tidak mengumpulkan data pribadi pengguna untuk tujuan komersial. Semua data yang dimasukkan ke dalam aplikasi hanya digunakan untuk keperluan pengelolaan bantuan barang dan jasa.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="copyright">
            &copy; 2025 Dinas Peternakan dan Perikanan Situbondo. Hak Cipta Dilindungi.
        </div>
    </div>
    
    <!-- Floating Action Button -->
    <div class="floating-action-btn" id="fabBtn">
        <i class="fas fa-plus"></i>
    </div>
    
    <!-- Toast Notification -->
    <div class="toast notification-toast" role="alert" aria-live="assertive" aria-atomic="true" id="notificationToast">
        <div class="toast-header">
            <i class="fas fa-info-circle text-primary me-2"></i>
            <strong class="me-auto" id="toastTitle">Pemberitahuan</strong>
            <small id="toastTime">Baru saja</small>
            <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
        <div class="toast-body" id="toastMessage">
            Operasi berhasil dilakukan.
        </div>
    </div>
    
    <!-- Password Modal -->
    <div class="modal fade password-modal" id="passwordModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-lock me-2"></i>Konfirmasi Keamanan</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>Untuk melanjutkan, masukkan kode keamanan yang telah ditetapkan.</p>
                    <div class="mb-3">
                        <label for="inputPassword" class="form-label">Kode Keamanan</label>
                        <input type="password" class="form-control" id="inputPassword" placeholder="Masukkan kode keamanan">
                    </div>
                    <div class="form-text">Kode keamanan diperlukan untuk operasi yang bersifat kritis.</div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                    <button type="button" class="btn btn-primary" id="confirmPasswordBtn">Konfirmasi</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- View Links Modal -->
    <div class="modal fade links-modal" id="linksModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-link me-2"></i>Semua Link Google Drive</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="linksModalBody">
                    <!-- Konten akan diisi oleh JavaScript -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Tutup</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Welcome Modal -->
    <div class="modal fade welcome-modal" id="welcomeModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="welcome-header">
                    <div class="welcome-icon">
                        <i class="fas fa-hand-holding-water"></i>
                    </div>
                    <h4>Selamat Datang di APLIKASI BARJAS</h4>
                </div>
                <div class="welcome-body">
                    <p>Aplikasi Bantuan Barang dan Jasa - Dinas Peternakan dan Perikanan Situbondo</p>
                    <p>Silakan gunakan aplikasi ini untuk mengelola data bantuan barang dan jasa dengan mudah dan efisien.</p>
                    <div class="countdown-timer" id="welcomeCountdown">
                        Modal ini akan tertutup otomatis dalam <span id="countdownNumber">10</span> detik
                    </div>
                </div>
                <div class="welcome-footer">
                    <button type="button" class="btn btn-primary" id="closeWelcomeBtn">Mulai Menggunakan</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Print Header (hidden by default) -->
    <div class="print-header">
        <h1 class="print-title">LAPORAN DATA BANTUAN BARJAS</h1>
        <p class="print-subtitle">Dinas Peternakan dan Perikanan Kabupaten Situbondo</p>
        <div class="print-date" id="printDate"></div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDcQS_0C5bZ8VcYVfDcL3pNQ4l4V6wX5jE&libraries=places&callback=initMap" async defer></script>
    
    <script>
        // Deklarasi variabel global
        let dataBarjas = [];
        let currentPage = 1;
        const itemsPerPage = 10;
        let securityCode = null;
        let map;
        let autocomplete;
        
        // Fungsi untuk inisialisasi aplikasi
        function initApp() {
            // Inisialisasi data
            loadData();
            setupEventListeners();
            populateDropdowns();
            updateStats();
            renderTable();
            initParticles();
            
            // Tampilkan welcome modal jika pertama kali
            if (!localStorage.getItem('barjas_welcomed')) {
                setTimeout(() => {
                    $('#welcomeModal').modal('show');
                    startWelcomeCountdown();
                    localStorage.setItem('barjas_welcomed', 'true');
                }, 2000);
            }
            
            // Tampilkan splash screen selama 8 detik
            setTimeout(() => {
                document.getElementById('welcomeSplash').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('welcomeSplash').style.display = 'none';
                }, 500);
            }, 8000);
            
            // Hitung mundur splash screen
            let countdown = 8;
            const countdownElement = document.getElementById('splashCountdown');
            const countdownInterval = setInterval(() => {
                countdown--;
                countdownElement.textContent = countdown;
                if (countdown <= 0) {
                    clearInterval(countdownInterval);
                }
            }, 1000);
        }
        
        // Fungsi untuk memuat data dari localStorage
        function loadData() {
            const savedData = localStorage.getItem('barjas_data');
            if (savedData) {
                dataBarjas = JSON.parse(savedData);
                document.getElementById('total-data').textContent = dataBarjas.length;
                document.getElementById('infoTotalData').textContent = dataBarjas.length + ' data';
                
                // Hitung ukuran penyimpanan
                const storageSize = new Blob([savedData]).size;
                document.getElementById('infoStorageSize').textContent = (storageSize / 1024).toFixed(2) + ' KB';
            }
            
            // Load security code
            const savedCode = localStorage.getItem('barjas_security_code');
            if (savedCode) {
                securityCode = savedCode;
            }
            
            // Load last update time
            const lastUpdate = localStorage.getItem('barjas_last_update');
            if (lastUpdate) {
                document.getElementById('infoLastUpdate').textContent = new Date(parseInt(lastUpdate)).toLocaleString();
            }
        }
        
        // Fungsi untuk menyimpan data ke localStorage
        function saveData() {
            localStorage.setItem('barjas_data', JSON.stringify(dataBarjas));
            localStorage.setItem('barjas_last_update', Date.now().toString());
            document.getElementById('infoLastUpdate').textContent = new Date().toLocaleString();
            
            // Hitung ukuran penyimpanan
            const savedData = localStorage.getItem('barjas_data');
            const storageSize = new Blob([savedData]).size;
            document.getElementById('infoStorageSize').textContent = (storageSize / 1024).toFixed(2) + ' KB';
        }
        
        // Fungsi untuk mengatur event listeners
        function setupEventListeners() {
            // Form submission
            document.getElementById('inputForm').addEventListener('submit', function(e) {
                e.preventDefault();
                simpanData();
            });
            
            // Reset form
            document.getElementById('resetBtn').addEventListener('click', function() {
                resetForm();
            });
            
            // Filter events
            document.getElementById('filterTahun').addEventListener('change', function() {
                currentPage = 1;
                renderTable();
            });
            
            document.getElementById('filterKecamatan').addEventListener('change', function() {
                currentPage = 1;
                renderTable();
            });
            
            document.getElementById('filterDesa').addEventListener('change', function() {
                currentPage = 1;
                renderTable();
            });
            
            document.getElementById('searchInput').addEventListener('input', function() {
                currentPage = 1;
                renderTable();
            });
            
            // Export buttons
            document.getElementById('exportExcelBtn').addEventListener('click', function() {
                exportToExcel();
            });
            
            document.getElementById('exportPdfBtn').addEventListener('click', function() {
                exportToPDF();
            });
            
            document.getElementById('printBtn').addEventListener('click', function() {
                printTable();
            });
            
            // Backup buttons
            document.getElementById('backupExcelBtn').addEventListener('click', function() {
                backupToExcel();
            });
            
            document.getElementById('backupJsonBtn').addEventListener('click', function() {
                backupToJSON();
            });
            
            document.getElementById('restoreBtn').addEventListener('click', function() {
                restoreData();
            });
            
            // Control panel buttons
            document.getElementById('deleteAllBtn').addEventListener('click', function() {
                showPasswordModal('deleteAll');
            });
            
            document.getElementById('resetSettingsBtn').addEventListener('click', function() {
                showPasswordModal('resetSettings');
            });
            
            document.getElementById('setSecurityBtn').addEventListener('click', function() {
                setSecurityCode();
            });
            
            // Confirm password button
            document.getElementById('confirmPasswordBtn').addEventListener('click', function() {
                confirmPassword();
            });
            
            // Quick actions
            document.getElementById('quickBackupBtn').addEventListener('click', function() {
                backupToExcel();
            });
            
            document.getElementById('refreshDataBtn').addEventListener('click', function() {
                loadData();
                renderTable();
                updateStats();
                showNotification('Data diperbarui', 'Semua data telah diperbarui.', 'success');
            });
            
            document.getElementById('clearFormBtn').addEventListener('click', function() {
                resetForm();
                showNotification('Form dibersihkan', 'Form input telah dikosongkan.', 'info');
            });
            
            // View links button
            document.getElementById('viewLinksBtn').addEventListener('click', function() {
                viewAllLinks();
            });
            
            // Add link button
            document.getElementById('addLinkBtn').addEventListener('click', function() {
                addLink();
            });
            
            // Mobile menu button
            document.getElementById('mobileMenuBtn').addEventListener('click', function() {
                document.querySelector('.col-md-3.col-lg-2').classList.add('mobile-show');
                document.getElementById('sidebarOverlay').classList.add('mobile-show');
            });
            
            // Sidebar overlay
            document.getElementById('sidebarOverlay').addEventListener('click', function() {
                document.querySelector('.col-md-3.col-lg-2').classList.remove('mobile-show');
                this.classList.remove('mobile-show');
            });
            
            // FAB button
            document.getElementById('fabBtn').addEventListener('click', function() {
                document.getElementById('inputForm').scrollIntoView({ behavior: 'smooth' });
            });
            
            // Close splash button
            document.getElementById('closeSplash').addEventListener('click', function() {
                document.getElementById('welcomeSplash').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('welcomeSplash').style.display = 'none';
                }, 500);
            });
            
            // Close welcome modal button
            document.getElementById('closeWelcomeBtn').addEventListener('click', function() {
                $('#welcomeModal').modal('hide');
            });
            
            // GPS Button
            document.getElementById('gpsButton').addEventListener('click', function() {
                getLocation();
            });
        }
        
        // Fungsi untuk mengisi dropdown dengan opsi
        function populateDropdowns() {
            // Isi dropdown tahun anggaran (2020-2090)
            const tahunAnggaranSelect = document.getElementById('tahunAnggaran');
            const filterTahunSelect = document.getElementById('filterTahun');
            const currentYear = new Date().getFullYear();
            
            for (let year = 2020; year <= 2090; year++) {
                const option = document.createElement('option');
                option.value = year;
                option.textContent = year;
                
                const filterOption = option.cloneNode(true);
                
                tahunAnggaranSelect.appendChild(option);
                filterTahunSelect.appendChild(filterOption);
                
                if (year === currentYear) {
                    option.selected = true;
                }
            }
            
            // Isi dropdown desa untuk Kota Situbondo
            const desaSelect = document.getElementById('desa');
            const filterDesaSelect = document.getElementById('filterDesa');
            
            const desaList = [
                "Arjasa", "Awar-awar", "Badean", "Banyuputih", "Banyuputih Kidul", "Batuinan", "Besuki", "Blimbing", "Bungatan", 
                "Curahtatal", "Jangkar", "Jatibanteng", "Kapongan", "Kendit", "Klatakan", "Kotakan", "Kumberejo", "Kumbo", 
                "Landangan", "Mangaran", "Mlandingan", "Mojosari", "Panarukan", "Panji", "Patokan", "Peleyan", "Sumberanyar", 
                "Sumberejo", "Sumberkencono", "Sumberkolak", "Sumbermalang", "Sumberwaru", "Talkandang", "Wringinanom"
            ];
            
            desaList.sort().forEach(desa => {
                const option = document.createElement('option');
                option.value = desa;
                option.textContent = desa;
                
                const filterOption = option.cloneNode(true);
                
                desaSelect.appendChild(option);
                filterDesaSelect.appendChild(filterOption);
            });
            
            // Set tahun saat ini di info panel
            document.getElementById('current-year').textContent = currentYear;
        }
        
        // Fungsi untuk menyimpan data
        function simpanData() {
            // Validasi form
            if (!validateForm()) {
                showNotification('Error', 'Harap isi semua field yang wajib diisi.', 'error');
                return;
            }
            
            // Ambil nilai dari form
            const newData = {
                id: Date.now().toString(),
                nama: document.getElementById('nama').value.trim(),
                nik: document.getElementById('nik').value.trim(),
                jabatan: document.getElementById('jabatan').value,
                kelompok: document.getElementById('kelompok').value.trim(),
                whatsapp: document.getElementById('whatsapp').value.trim(),
                kodeBarang: document.getElementById('kodeBarang').value.trim(),
                namaBarang: document.getElementById('namaBarang').value.trim(),
                jumlah: parseInt(document.getElementById('jumlah').value),
                satuan: document.getElementById('satuan').value,
                tahunAnggaran: document.getElementById('tahunAnggaran').value,
                alamatLengkap: document.getElementById('alamatLengkap').value.trim(),
                desa: document.getElementById('desa').value,
                kecamatan: document.getElementById('kecamatan').value,
                keterangan: document.getElementById('keterangan').value.trim(),
                links: [],
                tanggalInput: new Date().toISOString()
            };
            
            // Ambil link jika ada
            const linkLabel = document.getElementById('linkLabel').value.trim();
            const linkUrl = document.getElementById('linkUrl').value.trim();
            
            if (linkLabel && linkUrl) {
                newData.links.push({
                    label: linkLabel,
                    url: linkUrl
                });
            }
            
            // Tambahkan ke array data
            dataBarjas.push(newData);
            
            // Simpan ke localStorage
            saveData();
            
            // Update tampilan
            renderTable();
            updateStats();
            
            // Reset form
            resetForm();
            
            // Tampilkan notifikasi
            showNotification('Data Disimpan', 'Data berhasil disimpan ke database.', 'success');
            
            // Scroll ke tabel
            document.getElementById('dataTable').scrollIntoView({ behavior: 'smooth' });
        }
        
        // Fungsi untuk validasi form
        function validateForm() {
            let isValid = true;
            
            // Validasi Nama
            const nama = document.getElementById('nama');
            if (!nama.value.trim()) {
                nama.classList.add('input-error');
                document.getElementById('nama-error').style.display = 'block';
                isValid = false;
            } else {
                nama.classList.remove('input-error');
                document.getElementById('nama-error').style.display = 'none';
            }
            
            // Validasi NIK
            const nik = document.getElementById('nik');
            if (!nik.value.trim() || nik.value.length !== 16 || isNaN(nik.value)) {
                nik.classList.add('input-error');
                document.getElementById('nik-error').style.display = 'block';
                isValid = false;
            } else {
                nik.classList.remove('input-error');
                document.getElementById('nik-error').style.display = 'none';
            }
            
            // Validasi Jabatan
            const jabatan = document.getElementById('jabatan');
            if (!jabatan.value) {
                jabatan.classList.add('input-error');
                document.getElementById('jabatan-error').style.display = 'block';
                isValid = false;
            } else {
                jabatan.classList.remove('input-error');
                document.getElementById('jabatan-error').style.display = 'none';
            }
            
            // Validasi Kelompok
            const kelompok = document.getElementById('kelompok');
            if (!kelompok.value.trim()) {
                kelompok.classList.add('input-error');
                document.getElementById('kelompok-error').style.display = 'block';
                isValid = false;
            } else {
                kelompok.classList.remove('input-error');
                document.getElementById('kelompok-error').style.display = 'none';
            }
            
            // Validasi WhatsApp
            const whatsapp = document.getElementById('whatsapp');
            if (!whatsapp.value.trim()) {
                whatsapp.classList.add('input-error');
                document.getElementById('whatsapp-error').style.display = 'block';
                isValid = false;
            } else {
                whatsapp.classList.remove('input-error');
                document.getElementById('whatsapp-error').style.display = 'none';
            }
            
            // Validasi Nama Barang
            const namaBarang = document.getElementById('namaBarang');
            if (!namaBarang.value.trim()) {
                namaBarang.classList.add('input-error');
                document.getElementById('namaBarang-error').style.display = 'block';
                isValid = false;
            } else {
                namaBarang.classList.remove('input-error');
                document.getElementById('namaBarang-error').style.display = 'none';
            }
            
            // Validasi Jumlah
            const jumlah = document.getElementById('jumlah');
            if (!jumlah.value || parseInt(jumlah.value) <= 0) {
                jumlah.classList.add('input-error');
                document.getElementById('jumlah-error').style.display = 'block';
                isValid = false;
            } else {
                jumlah.classList.remove('input-error');
                document.getElementById('jumlah-error').style.display = 'none';
            }
            
            // Validasi Satuan
            const satuan = document.getElementById('satuan');
            if (!satuan.value) {
                satuan.classList.add('input-error');
                document.getElementById('satuan-error').style.display = 'block';
                isValid = false;
            } else {
                satuan.classList.remove('input-error');
                document.getElementById('satuan-error').style.display = 'none';
            }
            
            // Validasi Tahun Anggaran
            const tahunAnggaran = document.getElementById('tahunAnggaran');
            if (!tahunAnggaran.value) {
                tahunAnggaran.classList.add('input-error');
                document.getElementById('tahunAnggaran-error').style.display = 'block';
                isValid = false;
            } else {
                tahunAnggaran.classList.remove('input-error');
                document.getElementById('tahunAnggaran-error').style.display = 'none';
            }
            
            // Validasi Alamat Lengkap
            const alamatLengkap = document.getElementById('alamatLengkap');
            if (!alamatLengkap.value.trim()) {
                alamatLengkap.classList.add('input-error');
                document.getElementById('alamatLengkap-error').style.display = 'block';
                isValid = false;
            } else {
                alamatLengkap.classList.remove('input-error');
                document.getElementById('alamatLengkap-error').style.display = 'none';
            }
            
            // Validasi Desa
            const desa = document.getElementById('desa');
            if (!desa.value) {
                desa.classList.add('input-error');
                document.getElementById('desa-error').style.display = 'block';
                isValid = false;
            } else {
                desa.classList.remove('input-error');
                document.getElementById('desa-error').style.display = 'none';
            }
            
            // Validasi Kecamatan
            const kecamatan = document.getElementById('kecamatan');
            if (!kecamatan.value) {
                kecamatan.classList.add('input-error');
                document.getElementById('kecamatan-error').style.display = 'block';
                isValid = false;
            } else {
                kecamatan.classList.remove('input-error');
                document.getElementById('kecamatan-error').style.display = 'none';
            }
            
            return isValid;
        }
        
        // Fungsi untuk merender tabel data
        function renderTable() {
            const tableBody = document.getElementById('tableBody');
            const filterTahun = document.getElementById('filterTahun').value;
            const filterKecamatan = document.getElementById('filterKecamatan').value;
            const filterDesa = document.getElementById('filterDesa').value;
            const searchText = document.getElementById('searchInput').value.toLowerCase();
            
            // Filter data
            let filteredData = dataBarjas.filter(item => {
                return (
                    (filterTahun === '' || item.tahunAnggaran === filterTahun) &&
                    (filterKecamatan === '' || item.kecamatan === filterKecamatan) &&
                    (filterDesa === '' || item.desa === filterDesa) &&
                    (searchText === '' || 
                     item.nama.toLowerCase().includes(searchText) ||
                     item.nik.toLowerCase().includes(searchText) ||
                     item.kelompok.toLowerCase().includes(searchText) ||
                     item.namaBarang.toLowerCase().includes(searchText) ||
                     item.desa.toLowerCase().includes(searchText) ||
                     item.kecamatan.toLowerCase().includes(searchText))
                );
            });
            
            // Hitung total halaman
            const totalPages = Math.ceil(filteredData.length / itemsPerPage);
            
            // Pastikan currentPage valid
            if (currentPage > totalPages) currentPage = totalPages;
            if (currentPage < 1) currentPage = 1;
            
            // Data untuk halaman saat ini
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const currentData = filteredData.slice(startIndex, endIndex);
            
            // Kosongkan tabel
            tableBody.innerHTML = '';
            
            // Isi tabel dengan data
            if (currentData.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td colspan="11" class="text-center py-4">
                        <i class="fas fa-database fa-2x mb-2 text-muted"></i>
                        <p class="text-muted">Tidak ada data yang ditemukan</p>
                    </td>
                `;
                tableBody.appendChild(row);
            } else {
                currentData.forEach((item, index) => {
                    const row = document.createElement('tr');
                    const actualIndex = startIndex + index + 1;
                    
                    row.innerHTML = `
                        <td class="text-center">${actualIndex}</td>
                        <td>${item.nama}</td>
                        <td>${item.nik}</td>
                        <td>${item.kelompok}</td>
                        <td>
                            <a href="https://wa.me/${item.whatsapp}" target="_blank" class="whatsapp-link">
                                ${item.whatsapp}
                            </a>
                        </td>
                        <td>${item.namaBarang}</td>
                        <td class="text-center">${item.jumlah} ${item.satuan}</td>
                        <td class="text-center">${item.tahunAnggaran}</td>
                        <td>${item.desa}</td>
                        <td>${item.kecamatan}</td>
                        <td class="text-center">
                            <button class="btn btn-sm btn-primary me-1" onclick="viewData('${item.id}')" title="Lihat Detail">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn btn-sm btn-warning me-1" onclick="editData('${item.id}')" title="Edit">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-sm btn-danger" onclick="deleteData('${item.id}')" title="Hapus">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    `;
                    
                    tableBody.appendChild(row);
                });
            }
            
            // Update info tabel
            document.getElementById('tableInfo').textContent = `Menampilkan ${startIndex + 1} sampai ${Math.min(endIndex, filteredData.length)} dari ${filteredData.length} data`;
            
            // Render pagination
            renderPagination(totalPages);
        }
        
        // Fungsi untuk merender pagination
        function renderPagination(totalPages) {
            const pagination = document.getElementById('pagination');
            pagination.innerHTML = '';
            
            if (totalPages <= 1) return;
            
            // Previous button
            const prevLi = document.createElement('li');
            prevLi.className = `page-item ${currentPage === 1 ? 'disabled' : ''}`;
            prevLi.innerHTML = `<a class="page-link" href="#" onclick="changePage(${currentPage - 1})">&laquo;</a>`;
            pagination.appendChild(prevLi);
            
            // Page numbers
            const startPage = Math.max(1, currentPage - 2);
            const endPage = Math.min(totalPages, startPage + 4);
            
            for (let i = startPage; i <= endPage; i++) {
                const pageLi = document.createElement('li');
                pageLi.className = `page-item ${i === currentPage ? 'active' : ''}`;
                pageLi.innerHTML = `<a class="page-link" href="#" onclick="changePage(${i})">${i}</a>`;
                pagination.appendChild(pageLi);
            }
            
            // Next button
            const nextLi = document.createElement('li');
            nextLi.className = `page-item ${currentPage === totalPages ? 'disabled' : ''}`;
            nextLi.innerHTML = `<a class="page-link" href="#" onclick="changePage(${currentPage + 1})">&raquo;</a>`;
            pagination.appendChild(nextLi);
        }
        
        // Fungsi untuk mengubah halaman
        function changePage(page) {
            currentPage = page;
            renderTable();
        }
        
        // Fungsi untuk melihat data
        function viewData(id) {
            const data = dataBarjas.find(item => item.id === id);
            if (!data) return;
            
            const modalContent = `
                <div class="mb-3">
                    <h5>Detail Data Penerima Bantuan</h5>
                    <hr>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <p><strong>Nama:</strong> ${data.nama}</p>
                        <p><strong>NIK:</strong> ${data.nik}</p>
                        <p><strong>Jabatan:</strong> ${data.jabatan}</p>
                        <p><strong>Kelompok:</strong> ${data.kelompok}</p>
                        <p><strong>WhatsApp:</strong> <a href="https://wa.me/${data.whatsapp}" target="_blank">${data.whatsapp}</a></p>
                    </div>
                    <div class="col-md-6">
                        <p><strong>Barang:</strong> ${data.namaBarang} (${data.kodeBarang || '-'})</p>
                        <p><strong>Jumlah:</strong> ${data.jumlah} ${data.satuan}</p>
                        <p><strong>Tahun Anggaran:</strong> ${data.tahunAnggaran}</p>
                        <p><strong>Lokasi:</strong> ${data.desa}, ${data.kecamatan}</p>
                        <p><strong>Tanggal Input:</strong> ${new Date(data.tanggalInput).toLocaleDateString('id-ID')}</p>
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-12">
                        <p><strong>Alamat Lengkap:</strong></p>
                        <p>${data.alamatLengkap}</p>
                    </div>
                </div>
                ${data.keterangan ? `
                <div class="row mt-3">
                    <div class="col-12">
                        <p><strong>Keterangan:</strong></p>
                        <p>${data.keterangan}</p>
                    </div>
                </div>
                ` : ''}
                ${data.links && data.links.length > 0 ? `
                <div class="row mt-3">
                    <div class="col-12">
                        <p><strong>Link Terkait:</strong></p>
                        <ul>
                            ${data.links.map(link => `<li><a href="${link.url}" target="_blank">${link.label}</a></li>`).join('')}
                        </ul>
                    </div>
                </div>
                ` : ''}
            `;
            
            // Buat modal dinamis
            const modal = new bootstrap.Modal(document.createElement('div'));
            modal._element.className = 'modal fade';
            modal._element.innerHTML = `
                <div class="modal-dialog modal-lg">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title"><i class="fas fa-info-circle me-2"></i>Detail Data</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            ${modalContent}
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Tutup</button>
                            <button type="button" class="btn btn-primary" onclick="editData('${data.id}')">Edit</button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal._element);
            modal.show();
            
            // Hapus modal dari DOM setelah ditutup
            modal._element.addEventListener('hidden.bs.modal', function() {
                document.body.removeChild(modal._element);
            });
        }
        
        // Fungsi untuk mengedit data
        function editData(id) {
            const data = dataBarjas.find(item => item.id === id);
            if (!data) return;
            
            // Isi form dengan data yang ada
            document.getElementById('nama').value = data.nama;
            document.getElementById('nik').value = data.nik;
            document.getElementById('jabatan').value = data.jabatan;
            document.getElementById('kelompok').value = data.kelompok;
            document.getElementById('whatsapp').value = data.whatsapp;
            document.getElementById('kodeBarang').value = data.kodeBarang || '';
            document.getElementById('namaBarang').value = data.namaBarang;
            document.getElementById('jumlah').value = data.jumlah;
            document.getElementById('satuan').value = data.satuan;
            document.getElementById('tahunAnggaran').value = data.tahunAnggaran;
            document.getElementById('alamatLengkap').value = data.alamatLengkap;
            document.getElementById('desa').value = data.desa;
            document.getElementById('kecamatan').value = data.kecamatan;
            document.getElementById('keterangan').value = data.keterangan || '';
            
            // Kosongkan link form
            document.getElementById('linkLabel').value = '';
            document.getElementById('linkUrl').value = '';
            document.getElementById('linkList').innerHTML = '';
            
            // Tambahkan link jika ada
            if (data.links && data.links.length > 0) {
                data.links.forEach(link => {
                    addLinkToUI(link.label, link.url);
                });
            }
            
            // Hapus data lama
            deleteData(id, false);
            
            // Scroll ke form
            document.getElementById('inputForm').scrollIntoView({ behavior: 'smooth' });
            
            // Tampilkan notifikasi
            showNotification('Data Dimuat', 'Data telah dimuat ke form untuk diedit.', 'info');
        }
        
        // Fungsi untuk menghapus data
        function deleteData(id, showNotification = true) {
            if (!confirm('Apakah Anda yakin ingin menghapus data ini?')) return;
            
            // Hapus data dari array
            dataBarjas = dataBarjas.filter(item => item.id !== id);
            
            // Simpan ke localStorage
            saveData();
            
            // Update tampilan
            renderTable();
            updateStats();
            
            // Tampilkan notifikasi
            if (showNotification) {
                showNotification('Data Dihapus', 'Data berhasil dihapus dari database.', 'success');
            }
        }
        
        // Fungsi untuk mereset form
        function resetForm() {
            document.getElementById('inputForm').reset();
            document.getElementById('linkList').innerHTML = '';
            
            // Hapus kelas error
            const errorInputs = document.querySelectorAll('.input-error');
            errorInputs.forEach(input => {
                input.classList.remove('input-error');
            });
            
            // Sembunyikan pesan error
            const errorMessages = document.querySelectorAll('.error-message');
            errorMessages.forEach(message => {
                message.style.display = 'none';
            });
        }
        
        // Fungsi untuk menambah link
        function addLink() {
            const label = document.getElementById('linkLabel').value.trim();
            const url = document.getElementById('linkUrl').value.trim();
            
            if (!label || !url) {
                showNotification('Error', 'Label dan URL link harus diisi.', 'error');
                return;
            }
            
            // Validasi URL
            try {
                new URL(url);
            } catch (e) {
                showNotification('Error', 'Format URL tidak valid.', 'error');
                return;
            }
            
            // Tambahkan ke UI
            addLinkToUI(label, url);
            
            // Reset form link
            document.getElementById('linkLabel').value = '';
            document.getElementById('linkUrl').value = '';
        }
        
        // Fungsi untuk menambahkan link ke UI
        function addLinkToUI(label, url) {
            const linkList = document.getElementById('linkList');
            const linkId = 'link-' + Date.now();
            
            const linkElement = document.createElement('div');
            linkElement.className = 'alert alert-sm alert-info d-flex justify-content-between align-items-center';
            linkElement.id = linkId;
            linkElement.innerHTML = `
                <div>
                    <strong>${label}:</strong> 
                    <a href="${url}" target="_blank" class="alert-link">${url}</a>
                </div>
                <button type="button" class="btn btn-sm btn-outline-danger" onclick="removeLink('${linkId}')">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            linkList.appendChild(linkElement);
        }
        
        // Fungsi untuk menghapus link dari UI
        function removeLink(linkId) {
            const linkElement = document.getElementById(linkId);
            if (linkElement) {
                linkElement.remove();
            }
        }
        
        // Fungsi untuk melihat semua link
        function viewAllLinks() {
            const linksModalBody = document.getElementById('linksModalBody');
            linksModalBody.innerHTML = '';
            
            if (dataBarjas.length === 0) {
                linksModalBody.innerHTML = '<p class="text-center py-4 text-muted">Tidak ada data link</p>';
                $('#linksModal').modal('show');
                return;
            }
            
            // Kumpulkan semua link
            const allLinks = [];
            dataBarjas.forEach(data => {
                if (data.links && data.links.length > 0) {
                    data.links.forEach(link => {
                        allLinks.push({
                            label: link.label,
                            url: link.url,
                            nama: data.nama,
                            kelompok: data.kelompok
                        });
                    });
                }
            });
            
            if (allLinks.length === 0) {
                linksModalBody.innerHTML = '<p class="text-center py-4 text-muted">Tidak ada data link</p>';
            } else {
                allLinks.forEach(link => {
                    const linkElement = document.createElement('div');
                    linkElement.className = 'link-item';
                    linkElement.innerHTML = `
                        <div class="link-label">${link.label} - ${link.nama} (${link.kelompok})</div>
                        <div class="link-url"><a href="${link.url}" target="_blank">${link.url}</a></div>
                    `;
                    linksModalBody.appendChild(linkElement);
                });
            }
            
            $('#linksModal').modal('show');
        }
        
        // Fungsi untuk memperbarui statistik
        function updateStats() {
            // Total penerima
            document.getElementById('totalPenerima').textContent = dataBarjas.length;
            
            // Total barang
            const totalBarang = dataBarjas.reduce((sum, item) => sum + item.jumlah, 0);
            document.getElementById('totalBarang').textContent = totalBarbarang;
            
            // Tahun dengan data terbanyak
            const tahunCount = {};
            dataBarjas.forEach(item => {
                tahunCount[item.tahunAnggaran] = (tahunCount[item.tahunAnggaran] || 0) + 1;
            });
            
            let maxTahun = '-';
            let maxCount = 0;
            for (const tahun in tahunCount) {
                if (tahunCount[tahun] > maxCount) {
                    maxCount = tahunCount[tahun];
                    maxTahun = tahun;
                }
            }
            document.getElementById('tahunTerbanyak').textContent = maxTahun !== '-' ? `${maxTahun} (${maxCount})` : '-';
            
            // Kecamatan dengan data terbanyak
            const kecamatanCount = {};
            dataBarjas.forEach(item => {
                kecamatanCount[item.kecamatan] = (kecamatanCount[item.kecamatan] || 0) + 1;
            });
            
            let maxKecamatan = '-';
            let maxKecCount = 0;
            for (const kecamatan in kecamatanCount) {
                if (kecamatanCount[kecamatan] > maxKecCount) {
                    maxKecCount = kecamatanCount[kecamatan];
                    maxKecamatan = kecamatan;
                }
            }
            document.getElementById('kecamatanTerbanyak').textContent = maxKecamatan !== '-' ? `${maxKecamatan} (${maxKecCount})` : '-';
            
            // Update chart
            updateCharts();
            
            // Update rekapitulasi table
            updateRekapitulasiTable();
        }
        
        // Fungsi untuk memperbarui chart
        function updateCharts() {
            // Data per tahun
            const tahunCount = {};
            dataBarjas.forEach(item => {
                tahunCount[item.tahunAnggaran] = (tahunCount[item.tahunAnggaran] || 0) + 1;
            });
            
            const tahunLabels = Object.keys(tahunCount).sort();
            const tahunData = tahunLabels.map(tahun => tahunCount[tahun]);
            
            // Data per kecamatan
            const kecamatanCount = {};
            dataBarjas.forEach(item => {
                kecamatanCount[item.kecamatan] = (kecamatanCount[item.kecamatan] || 0) + 1;
            });
            
            const kecamatanLabels = Object.keys(kecamatanCount).sort();
            const kecamatanData = kecamatanLabels.map(kecamatan => kecamatanCount[kecamatan]);
            
            // Data per barang
            const barangCount = {};
            dataBarjas.forEach(item => {
                barangCount[item.namaBarang] = (barangCount[item.namaBarang] || 0) + 1;
            });
            
            // Ambil 10 barang terbanyak
            const sortedBarang = Object.entries(barangCount)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 10);
            
            const barangLabels = sortedBarang.map(item => item[0]);
            const barangData = sortedBarang.map(item => item[1]);
            
            // Render charts
            renderBarChart('tahunChart', 'Data per Tahun', tahunLabels, tahunData, 'Jumlah Data');
            renderPieChart('kecamatanChart', 'Data per Kecamatan', kecamatanLabels, kecamatanData);
            renderBarChart('barangChart', 'Data per Jenis Barang', barangLabels, barangData, 'Jumlah Data', true);
        }
        
        // Fungsi untuk merender bar chart
        function renderBarChart(canvasId, title, labels, data, label, horizontal = false) {
            const ctx = document.getElementById(canvasId).getContext('2d');
            
            if (window[canvasId + 'Chart']) {
                window[canvasId + 'Chart'].destroy();
            }
            
            window[canvasId + 'Chart'] = new Chart(ctx, {
                type: horizontal ? 'bar' : 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: label,
                        data: data,
                        backgroundColor: 'rgba(13, 71, 161, 0.7)',
                        borderColor: 'rgba(13, 71, 161, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    indexAxis: horizontal ? 'y' : 'x',
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: title
                        },
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }
        
        // Fungsi untuk merender pie chart
        function renderPieChart(canvasId, title, labels, data) {
            const ctx = document.getElementById(canvasId).getContext('2d');
            
            if (window[canvasId + 'Chart']) {
                window[canvasId + 'Chart'].destroy();
            }
            
            // Generate colors
            const backgroundColors = [];
            for (let i = 0; i < labels.length; i++) {
                const hue = (i * 360 / labels.length) % 360;
                backgroundColors.push(`hsla(${hue}, 70%, 60%, 0.7)`);
            }
            
            window[canvasId + 'Chart'] = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: labels,
                    datasets: [{
                        data: data,
                        backgroundColor: backgroundColors,
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: title
                        }
                    }
                }
            });
        }
        
        // Fungsi untuk memperbarui tabel rekapitulasi
        function updateRekapitulasiTable() {
            const rekapitulasiTable = document.getElementById('rekapitulasiTable');
            rekapitulasiTable.innerHTML = '';
            
            // Kelompokkan data per tahun
            const tahunData = {};
            dataBarjas.forEach(item => {
                if (!tahunData[item.tahunAnggaran]) {
                    tahunData[item.tahunAnggaran] = {
                        count: 0,
                        total: 0
                    };
                }
                
                tahunData[item.tahunAnggaran].count++;
                tahunData[item.tahunAnggaran].total += item.jumlah;
            });
            
            // Urutkan tahun
            const sortedTahun = Object.keys(tahunData).sort();
            
            if (sortedTahun.length === 0) {
                rekapitulasiTable.innerHTML = `
                    <tr>
                        <td colspan="3" class="text-center text-muted py-3">Tidak ada data</td>
                    </tr>
                `;
                return;
            }
            
            // Isi tabel
            sortedTahun.forEach(tahun => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${tahun}</td>
                    <td>${tahunData[tahun].count}</td>
                    <td>${tahunData[tahun].total}</td>
                `;
                rekapitulasiTable.appendChild(row);
            });
        }
        
        // Fungsi untuk mengekspor data ke Excel
        function exportToExcel() {
            if (dataBarjas.length === 0) {
                showNotification('Error', 'Tidak ada data untuk diekspor.', 'error');
                return;
            }
            
            // Siapkan data untuk Excel
            const excelData = dataBarjas.map(item => ({
                'Nama Penerima': item.nama,
                'NIK': item.nik,
                'Jabatan': item.jabatan,
                'Kelompok': item.kelompok,
                'WhatsApp': item.whatsapp,
                'Kode Barang': item.kodeBarang || '',
                'Nama Barang': item.namaBarang,
                'Jumlah': item.jumlah,
                'Satuan': item.satuan,
                'Tahun Anggaran': item.tahunAnggaran,
                'Alamat Lengkap': item.alamatLengkap,
                'Desa': item.desa,
                'Kecamatan': item.kecamatan,
                'Keterangan': item.keterangan || '',
                'Tanggal Input': new Date(item.tanggalInput).toLocaleDateString('id-ID')
            }));
            
            // Buat worksheet
            const ws = XLSX.utils.json_to_sheet(excelData);
            
            // Buat workbook
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Data BARJAS');
            
            // Export ke file
            XLSX.writeFile(wb, `Data_BARJAS_${new Date().toISOString().split('T')[0]}.xlsx`);
            
            showNotification('Berhasil', 'Data berhasil diekspor ke Excel.', 'success');
        }
        
        // Fungsi untuk mengekspor data ke PDF
        function exportToPDF() {
            if (dataBarjas.length === 0) {
                showNotification('Error', 'Tidak ada data untuk diekspor.', 'error');
                return;
            }
            
            // Gunakan jsPDF dengan autotable
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Judul
            doc.setFontSize(18);
            doc.text('LAPORAN DATA BANTUAN BARJAS', 105, 15, { align: 'center' });
            doc.setFontSize(12);
            doc.text('Dinas Peternakan dan Perikanan Kabupaten Situbondo', 105, 22, { align: 'center' });
            
            // Tanggal
            doc.setFontSize(10);
            doc.text(`Tanggal: ${new Date().toLocaleDateString('id-ID')}`, 105, 29, { align: 'center' });
            
            // Data untuk tabel
            const tableData = dataBarjas.map(item => [
                item.nama,
                item.nik,
                item.kelompok,
                item.whatsapp,
                item.namaBarang,
                `${item.jumlah} ${item.satuan}`,
                item.tahunAnggaran,
                item.desa,
                item.kecamatan
            ]);
            
            // Buat tabel
            doc.autoTable({
                head: [['Nama', 'NIK', 'Kelompok', 'WhatsApp', 'Barang', 'Jumlah', 'Tahun', 'Desa', 'Kecamatan']],
                body: tableData,
                startY: 35,
                theme: 'grid',
                styles: { fontSize: 8 },
                headStyles: { fillColor: [13, 71, 161] }
            });
            
            // Simpan PDF
            doc.save(`Data_BARJAS_${new Date().toISOString().split('T')[0]}.pdf`);
            
            showNotification('Berhasil', 'Data berhasil diekspor ke PDF.', 'success');
        }
        
        // Fungsi untuk mencetak tabel
        function printTable() {
            if (dataBarjas.length === 0) {
                showNotification('Error', 'Tidak ada data untuk dicetak.', 'error');
                return;
            }
            
            // Set tanggal cetak
            document.getElementById('printDate').textContent = `Tanggal Cetak: ${new Date().toLocaleDateString('id-ID')}`;
            
            // Tampilkan header cetak
            document.querySelector('.print-header').style.display = 'block';
            
            // Cetak dokumen
            window.print();
            
            // Sembunyikan header cetak setelah mencetak
            setTimeout(() => {
                document.querySelector('.print-header').style.display = 'none';
            }, 500);
        }
        
        // Fungsi untuk backup data ke Excel
        function backupToExcel() {
            if (dataBarjas.length === 0) {
                showNotification('Error', 'Tidak ada data untuk dibackup.', 'error');
                return;
            }
            
            exportToExcel();
            addBackupHistory('Excel', dataBarjas.length);
        }
        
        // Fungsi untuk backup data ke JSON
        function backupToJSON() {
            if (dataBarjas.length === 0) {
                showNotification('Error', 'Tidak ada data untuk dibackup.', 'error');
                return;
            }
            
            // Buat data JSON
            const jsonData = JSON.stringify(dataBarjas, null, 2);
            const blob = new Blob([jsonData], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            // Buat link download
            const a = document.createElement('a');
            a.href = url;
            a.download = `Data_BARJAS_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            
            // Bersihkan
            setTimeout(() => {
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }, 100);
            
            showNotification('Berhasil', 'Data berhasil dibackup ke JSON.', 'success');
            addBackupHistory('JSON', dataBarjas.length);
        }
        
        // Fungsi untuk restore data
        function restoreData() {
            const fileInput = document.getElementById('restoreFile');
            const file = fileInput.files[0];
            
            if (!file) {
                showNotification('Error', 'Pilih file terlebih dahulu.', 'error');
                return;
            }
            
            if (!confirm('PERINGATAN: Restore data akan menimpa semua data yang ada saat ini. Lanjutkan?')) {
                return;
            }
            
            const reader = new FileReader();
            
            reader.onload = function(e) {
                try {
                    let restoredData;
                    
                    if (file.name.endsWith('.json')) {
                        // Restore dari JSON
                        restoredData = JSON.parse(e.target.result);
                    } else if (file.name.endsWith('.xlsx')) {
                        // Restore dari Excel
                        const workbook = XLSX.read(e.target.result, { type: 'binary' });
                        const worksheet = workbook.Sheets[workbook.SheetNames[0]];
                        restoredData = XLSX.utils.sheet_to_json(worksheet);
                        
                        // Konversi format data
                        restoredData = restoredData.map(item => ({
                            id: Date.now().toString() + Math.random().toString(36).substr(2, 5),
                            nama: item['Nama Penerima'] || '',
                            nik: item['NIK'] || '',
                            jabatan: item['Jabatan'] || '',
                            kelompok: item['Kelompok'] || '',
                            whatsapp: item['WhatsApp'] || '',
                            kodeBarang: item['Kode Barang'] || '',
                            namaBarang: item['Nama Barang'] || '',
                            jumlah: parseInt(item['Jumlah']) || 0,
                            satuan: item['Satuan'] || '',
                            tahunAnggaran: item['Tahun Anggaran'] || '',
                            alamatLengkap: item['Alamat Lengkap'] || '',
                            desa: item['Desa'] || '',
                            kecamatan: item['Kecamatan'] || '',
                            keterangan: item['Keterangan'] || '',
                            links: [],
                            tanggalInput: new Date().toISOString()
                        }));
                    } else {
                        throw new Error('Format file tidak didukung');
                    }
                    
                    // Simpan data yang direstore
                    dataBarjas = restoredData;
                    saveData();
                    
                    // Update tampilan
                    renderTable();
                    updateStats();
                    
                    // Reset file input
                    fileInput.value = '';
                    
                    showNotification('Berhasil', 'Data berhasil direstore.', 'success');
                } catch (error) {
                    console.error('Error restoring data:', error);
                    showNotification('Error', 'Gagal merestore data. Pastikan file formatnya benar.', 'error');
                }
            };
            
            reader.onerror = function() {
                showNotification('Error', 'Gagal membaca file.', 'error');
            };
            
            if (file.name.endsWith('.xlsx')) {
                reader.readAsBinaryString(file);
            } else {
                reader.readAsText(file);
            }
        }
        
        // Fungsi untuk menambah riwayat backup
        function addBackupHistory(type, count) {
            const backupHistory = document.getElementById('backupHistory');
            const now = new Date();
            
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${now.toLocaleDateString('id-ID')} ${now.toLocaleTimeString('id-ID')}</td>
                <td>${type}</td>
                <td>${count} data</td>
                <td>
                    <span class="badge bg-success">Berhasil</span>
                </td>
            `;
            
            // Tambahkan di paling atas
            if (backupHistory.firstChild) {
                backupHistory.insertBefore(row, backupHistory.firstChild);
            } else {
                backupHistory.appendChild(row);
            }
        }
        
        // Fungsi untuk menampilkan modal password
        function showPasswordModal(action) {
            if (!securityCode) {
                // Jika belum ada kode keamanan, langsung jalankan aksi
                executeAction(action);
                return;
            }
            
            // Tampilkan modal
            const modal = new bootstrap.Modal(document.getElementById('passwordModal'));
            modal.show();
            
            // Simpan aksi yang akan dilakukan
            document.getElementById('passwordModal').dataset.action = action;
        }
        
        // Fungsi untuk konfirmasi password
        function confirmPassword() {
            const inputPassword = document.getElementById('inputPassword').value;
            const action = document.getElementById('passwordModal').dataset.action;
            
            if (inputPassword === securityCode) {
                // Tutup modal
                const modal = bootstrap.Modal.getInstance(document.getElementById('passwordModal'));
                modal.hide();
                
                // Jalankan aksi
                executeAction(action);
            } else {
                showNotification('Error', 'Kode keamanan salah.', 'error');
            }
            
            // Reset input
            document.getElementById('inputPassword').value = '';
        }
        
        // Fungsi untuk menjalankan aksi
        function executeAction(action) {
            switch (action) {
                case 'deleteAll':
                    deleteAllData();
                    break;
                case 'resetSettings':
                    resetSettings();
                    break;
            }
        }
        
        // Fungsi untuk menghapus semua data
        function deleteAllData() {
            if (!confirm('APAKAH ANDA YAKIN INGIN MENGHAPUS SEMUA DATA? Tindakan ini tidak dapat dibatalkan!')) {
                return;
            }
            
            dataBarjas = [];
            saveData();
            renderTable();
            updateStats();
            
            showNotification('Data Dihapus', 'Semua data berhasil dihapus.', 'success');
        }
        
        // Fungsi untuk mereset pengaturan
        function resetSettings() {
            if (!confirm('Apakah Anda yakin ingin mereset semua pengaturan ke default?')) {
                return;
            }
            
            localStorage.removeItem('barjas_security_code');
            securityCode = null;
            
            showNotification('Pengaturan Direset', 'Semua pengaturan telah direset ke default.', 'success');
        }
        
        // Fungsi untuk mengatur kode keamanan
        function setSecurityCode() {
            const newCode = document.getElementById('securityCode').value.trim();
            
            if (!newCode) {
                showNotification('Error', 'Masukkan kode keamanan terlebih dahulu.', 'error');
                return;
            }
            
            securityCode = newCode;
            localStorage.setItem('barjas_security_code', newCode);
            document.getElementById('securityCode').value = '';
            
            showNotification('Berhasil', 'Kode keamanan berhasil disetel.', 'success');
        }
        
        // Fungsi untuk menampilkan notifikasi
        function showNotification(title, message, type = 'info') {
            const toast = document.getElementById('notificationToast');
            const toastTitle = document.getElementById('toastTitle');
            const toastMessage = document.getElementById('toastMessage');
            const toastTime = document.getElementById('toastTime');
            
            // Set judul dan pesan
            toastTitle.textContent = title;
            toastMessage.textContent = message;
            toastTime.textContent = new Date().toLocaleTimeString('id-ID');
            
            // Set warna berdasarkan type
            switch (type) {
                case 'success':
                    toast.querySelector('.toast-header').classList.remove('bg-danger', 'bg-warning');
                    toast.querySelector('.toast-header').classList.add('bg-success');
                    break;
                case 'error':
                    toast.querySelector('.toast-header').classList.remove('bg-success', 'bg-warning');
                    toast.querySelector('.toast-header').classList.add('bg-danger');
                    break;
                case 'warning':
                    toast.querySelector('.toast-header').classList.remove('bg-success', 'bg-danger');
                    toast.querySelector('.toast-header').classList.add('bg-warning');
                    break;
                default:
                    toast.querySelector('.toast-header').classList.remove('bg-success', 'bg-danger', 'bg-warning');
            }
            
            // Tampilkan toast
            const bsToast = new bootstrap.Toast(toast);
            bsToast.show();
        }
        
        // Fungsi untuk memformat nomor WhatsApp
        function formatWhatsApp(input) {
            // Hapus semua karakter non-digit
            let value = input.value.replace(/\D/g, '');
            
            // Jika diawali dengan '0', ganti dengan '62'
            if (value.startsWith('0')) {
                value = '62' + value.substring(1);
            }
            
            // Jika tidak diawali dengan '62', tambahkan '62'
            if (!value.startsWith('62')) {
                value = '62' + value;
            }
            
            input.value = value;
        }
        
        // Fungsi untuk inisialisasi particles.js
        function initParticles() {
            particlesJS('particles-js', {
                particles: {
                    number: { value: 30, density: { enable: true, value_area: 800 } },
                    color: { value: "#0d47a1" },
                    shape: { type: "circle" },
                    opacity: { value: 0.5, random: true },
                    size: { value: 3, random: true },
                    line_linked: {
                        enable: true,
                        distance: 150,
                        color: "#0d47a1",
                        opacity: 0.4,
                        width: 1
                    },
                    move: {
                        enable: true,
                        speed: 2,
                        direction: "none",
                        random: true,
                        straight: false,
                        out_mode: "out",
                        bounce: false
                    }
                },
                interactivity: {
                    detect_on: "canvas",
                    events: {
                        onhover: { enable: true, mode: "grab" },
                        onclick: { enable: true, mode: "push" },
                        resize: true
                    },
                    modes: {
                        grab: { distance: 140, line_linked: { opacity: 1 } },
                        push: { particles_nb: 4 }
                    }
                },
                retina_detect: true
            });
        }
        
        // Fungsi untuk inisialisasi Google Maps Autocomplete
        function initMap() {
            // Buat autocomplete untuk input alamat
            const alamatInput = document.getElementById('alamatLengkap');
            autocomplete = new google.maps.places.Autocomplete(alamatInput, {
                types: ['geocode'],
                componentRestrictions: { country: 'id' }
            });
            
            // Tambahkan listener untuk ketika tempat dipilih
            autocomplete.addListener('place_changed', function() {
                const place = autocomplete.getPlace();
                if (!place.geometry) {
                    window.alert("Tidak ada detail yang tersedia untuk: " + place.name);
                    return;
                }
                
                // Dapatkan informasi alamat
                let addressComponents = place.address_components;
                let desa = '';
                let kecamatan = '';
                
                // Cari desa dan kecamatan dari komponen alamat
                for (let i = 0; i < addressComponents.length; i++) {
                    let types = addressComponents[i].types;
                    
                    if (types.includes('sublocality_level_2') || types.includes('sublocality_level_1')) {
                        desa = addressComponents[i].long_name;
                    } else if (types.includes('administrative_area_level_3') || types.includes('locality')) {
                        kecamatan = addressComponents[i].long_name;
                    }
                }
                
                // Isi dropdown desa dan kecamatan jika ditemukan
                if (desa) {
                    const desaSelect = document.getElementById('desa');
                    for (let i = 0; i < desaSelect.options.length; i++) {
                        if (desaSelect.options[i].text === desa) {
                            desaSelect.value = desa;
                            break;
                        }
                    }
                }
                
                if (kecamatan) {
                    const kecamatanSelect = document.getElementById('kecamatan');
                    for (let i = 0; i < kecamatanSelect.options.length; i++) {
                        if (kecamatanSelect.options[i].text === kecamatan) {
                            kecamatanSelect.value = kecamatan;
                            break;
                        }
                    }
                }
            });
        }
        
        // Fungsi untuk mendapatkan lokasi menggunakan GPS
        function getLocation() {
            if (!navigator.geolocation) {
                showNotification('Error', 'Geolocation tidak didukung oleh browser Anda.', 'error');
                return;
            }
            
            // Tampilkan loading state
            const gpsButton = document.getElementById('gpsButton');
            const originalText = gpsButton.innerHTML;
            gpsButton.innerHTML = '<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Mendapatkan lokasi...';
            gpsButton.disabled = true;
            
            navigator.geolocation.getCurrentPosition(
                function(position) {
                    // Dapatkan koordinat
                    const latitude = position.coords.latitude;
                    const longitude = position.coords.longitude;
                    
                    // Gunakan Geocoding untuk mendapatkan alamat dari koordinat
                    const geocoder = new google.maps.Geocoder();
                    const latlng = { lat: latitude, lng: longitude };
                    
                    geocoder.geocode({ location: latlng }, function(results, status) {
                        // Kembalikan state button
                        gpsButton.innerHTML = originalText;
                        gpsButton.disabled = false;
                        
                        if (status === 'OK') {
                            if (results[0]) {
                                // Isi field alamat dengan hasil geocoding
                                document.getElementById('alamatLengkap').value = results[0].formatted_address.toUpperCase();
                                
                                // Coba dapatkan informasi desa dan kecamatan
                                let desa = '';
                                let kecamatan = '';
                                
                                for (let i = 0; i < results[0].address_components.length; i++) {
                                    const component = results[0].address_components[i];
                                    const types = component.types;
                                    
                                    if (types.includes('sublocality_level_2') || types.includes('sublocality_level_1')) {
                                        desa = component.long_name;
                                    } else if (types.includes('administrative_area_level_3') || types.includes('locality')) {
                                        kecamatan = component.long_name;
                                    }
                                }
                                
                                // Isi dropdown desa dan kecamatan jika ditemukan
                                if (desa) {
                                    const desaSelect = document.getElementById('desa');
                                    for (let i = 0; i < desaSelect.options.length; i++) {
                                        if (desaSelect.options[i].text === desa) {
                                            desaSelect.value = desa;
                                            break;
                                        }
                                    }
                                }
                                
                                if (kecamatan) {
                                    const kecamatanSelect = document.getElementById('kecamatan');
                                    for (let i = 0; i < kecamatanSelect.options.length; i++) {
                                        if (kecamatanSelect.options[i].text === kecamatan) {
                                            kecamatanSelect.value = kecamatan;
                                            break;
                                        }
                                    }
                                }
                                
                                showNotification('Berhasil', 'Lokasi berhasil didapatkan.', 'success');
                            } else {
                                showNotification('Error', 'Tidak ada hasil yang ditemukan.', 'error');
                            }
                        } else {
                            showNotification('Error', 'Geocoder gagal karena: ' + status, 'error');
                        }
                    });
                },
                function(error) {
                    // Kembalikan state button
                    gpsButton.innerHTML = originalText;
                    gpsButton.disabled = false;
                    
                    let errorMessage;
                    switch (error.code) {
                        case error.PERMISSION_DENIED:
                            errorMessage = 'Pengguna menolak permintaan geolokasi.';
                            break;
                        case error.POSITION_UNAVAILABLE:
                            errorMessage = 'Informasi lokasi tidak tersedia.';
                            break;
                        case error.TIMEOUT:
                            errorMessage = 'Permintaan untuk mendapatkan lokasi pengguna waktu habis.';
                            break;
                        case error.UNKNOWN_ERROR:
                            errorMessage = 'Terjadi kesalahan yang tidak diketahui.';
                            break;
                    }
                    
                    showNotification('Error', errorMessage, 'error');
                },
                { enableHighAccuracy: true, timeout: 10000, maximumAge: 60000 }
            );
        }
        
        // Fungsi untuk countdown welcome modal
        function startWelcomeCountdown() {
            let countdown = 10;
            const countdownElement = document.getElementById('countdownNumber');
            const countdownInterval = setInterval(() => {
                countdown--;
                countdownElement.textContent = countdown;
                
                if (countdown <= 0) {
                    clearInterval(countdownInterval);
                    $('#welcomeModal').modal('hide');
                }
            }, 1000);
        }
        
        // Inisialisasi aplikasi saat dokumen siap
        document.addEventListener('DOMContentLoaded', initApp);
        
        // Deteksi browser
        document.getElementById('infoBrowser').textContent = navigator.userAgent.split(' ')[0];
    </script>
</body>
</html>
