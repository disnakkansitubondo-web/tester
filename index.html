<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APLIKASI BARJAS - SISTEM BANTUAN</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary-color: #0d47a1;
            --secondary-color: #00695c;
            --accent-color: #ff8f00;
            --light-blue: #e3f2fd;
            --dark-blue: #082e5c;
            --gradient-primary: linear-gradient(135deg, var(--primary-color), var(--dark-blue));
            --gradient-secondary: linear-gradient(135deg, var(--secondary-color), #004d40);
            --gradient-accent: linear-gradient(135deg, var(--accent-color), #e65100);
            --shadow-sm: 0 2px 8px rgba(0,0,0,0.08);
            --shadow-md: 0 4px 16px rgba(0,0,0,0.12);
            --shadow-lg: 0 8px 28px rgba(0,0,0,0.15);
            --login-gradient: linear-gradient(135deg, #0d47a1, #00695c, #ff8f00);
        }
        
        body {
            background: linear-gradient(135deg, #f5f9ff 0%, #e8f5e9 100%);
            font-family: 'Poppins', 'Segoe UI', sans-serif;
            min-height: 100vh;
            padding: 10px 0;
            overflow-x: hidden;
        }
        
        .app-container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            box-shadow: var(--shadow-lg);
            border-radius: 12px;
            overflow: hidden;
            position: relative;
            z-index: 10;
        }
        
        .app-header {
            background: var(--gradient-primary);
            color: white;
            padding: 20px 15px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .app-header::before {
            content: "";
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.15) 0%, transparent 70%);
            pointer-events: none;
        }
        
        .app-logo {
            font-size: 2.5rem;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }
        
        .app-title {
            font-size: 1.8rem;
            font-weight: 800;
            margin: 0;
            position: relative;
            z-index: 1;
            text-shadow: 1px 1px 4px rgba(0,0,0,0.3);
        }
        
        .app-subtitle {
            font-size: 1rem;
            opacity: 0.95;
            position: relative;
            z-index: 1;
            font-weight: 300;
            letter-spacing: 0.5px;
            margin-bottom: 5px;
        }
        
        .nav-pills .nav-link {
            border-radius: 8px;
            margin-bottom: 8px;
            padding: 12px 15px;
            font-weight: 500;
            color: #444;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            font-size: 0.9rem;
        }
        
        .nav-pills .nav-link:hover {
            background-color: #f0f7ff;
            transform: translateX(3px);
        }
        
        .nav-pills .nav-link.active {
            background: var(--gradient-primary);
            font-weight: 600;
            box-shadow: var(--shadow-md);
            transform: translateX(3px);
            color: white;
        }
        
        .section-title {
            border-left: 4px solid var(--primary-color);
            padding-left: 12px;
            margin: 20px 0;
            font-weight: 700;
            color: var(--dark-blue);
            font-size: 1.4rem;
            position: relative;
        }
        
        .section-title::after {
            content: "";
            position: absolute;
            bottom: -5px;
            left: 12px;
            width: 40px;
            height: 2px;
            background: var(--gradient-primary);
            border-radius: 2px;
        }
        
        .btn-primary {
            background: var(--gradient-primary);
            border: none;
            padding: 10px 20px;
            font-weight: 600;
            box-shadow: var(--shadow-md);
            border-radius: 8px;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .btn-success {
            background: var(--gradient-secondary);
            border: none;
            padding: 10px 20px;
            font-weight: 600;
            box-shadow: var(--shadow-md);
            border-radius: 8px;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .btn-warning {
            background: var(--gradient-accent);
            border: none;
            padding: 10px 20px;
            font-weight: 600;
            box-shadow: var(--shadow-md);
            border-radius: 8px;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .btn-warning:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .form-label {
            font-weight: 600;
            color: #444;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            font-size: 0.9rem;
        }
        
        .form-label i {
            margin-right: 6px;
            color: var(--primary-color);
        }
        
        .form-control, .form-select {
            border-radius: 8px;
            padding: 12px 15px;
            border: 1px solid #ddd;
            transition: all 0.3s;
            box-shadow: var(--shadow-sm);
            font-size: 0.9rem;
        }
        
        .form-control:focus, .form-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(13, 71, 161, 0.2);
            transform: translateY(-2px);
        }
        
        .copyright {
            text-align: center;
            padding: 20px;
            background-color: var(--light-blue);
            color: var(--dark-blue);
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .data-table {
            font-size: 0.85rem;
            border-collapse: separate;
            border-spacing: 0;
            box-shadow: var(--shadow-sm);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .data-table th {
            background: var(--gradient-primary);
            color: white;
            font-weight: 600;
            padding: 12px 10px;
            text-align: center;
            position: relative;
            font-size: 0.85rem;
        }
        
        .data-table th::after {
            content: "";
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 1px;
            background: rgba(255,255,255,0.3);
        }
        
        .data-table td {
            padding: 10px 8px;
            vertical-align: middle;
            border-bottom: 1px solid #eee;
            font-size: 0.85rem;
        }
        
        .data-table tr:nth-child(even) {
            background-color: #f9fbff;
        }
        
        .data-table tr:hover {
            background-color: #edf5ff;
        }
        
        .feature-icon {
            font-size: 1.1rem;
            margin-right: 8px;
            width: 24px;
            text-align: center;
        }
        
        .card {
            border-radius: 10px;
            border: none;
            box-shadow: var(--shadow-md);
            transition: all 0.3s ease;
            overflow: hidden;
            margin-bottom: 15px;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        
        .card-header {
            border-radius: 10px 10px 0 0 !important;
            font-weight: 600;
            padding: 15px 20px;
            background: var(--gradient-primary);
            color: white;
            font-size: 0.95rem;
        }
        
        .stats-box {
            text-align: center;
            padding: 20px 15px;
            border-radius: 10px;
            background: white;
            box-shadow: var(--shadow-md);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
            margin-bottom: 15px;
        }
        
        .stats-box::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--gradient-primary);
            border-radius: 2px;
        }
        
        .stats-box:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }
        
        .stats-number {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--primary-color);
            margin: 10px 0;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        
        .stats-label {
            font-size: 0.9rem;
            color: #666;
            font-weight: 500;
        }
        
        .notification-toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1050;
            min-width: 280px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: var(--shadow-lg);
            max-width: calc(100vw - 40px);
        }
        
        .input-error {
            border-color: #dc3545;
            box-shadow: 0 0 0 3px rgba(220, 53, 69, 0.2);
        }
        
        .error-message {
            color: #dc3545;
            font-size: 0.8rem;
            margin-top: 5px;
            display: none;
            font-weight: 500;
        }
        
        .watermark {
            position: absolute;
            bottom: 10px;
            right: 15px;
            opacity: 0.8;
            font-size: 0.8rem;
            color: white;
            font-weight: 300;
        }
        
        .control-panel {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            box-shadow: var(--shadow-sm);
        }
        
        .control-title {
            font-size: 1rem;
            color: var(--primary-color);
            font-weight: 600;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--light-blue);
        }
        
        .floating-action-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--gradient-primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .floating-action-btn:hover {
            transform: scale(1.1) rotate(90deg);
        }
        
        .filter-section {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-sm);
        }
        
        .badge-custom {
            background: var(--gradient-primary);
            color: white;
            padding: 6px 12px;
            border-radius: 16px;
            font-weight: 600;
            font-size: 0.8rem;
        }
        
        .mobile-menu-btn {
            display: none;
            position: fixed;
            top: 15px;
            left: 15px;
            z-index: 1050;
            background: var(--gradient-primary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            box-shadow: var(--shadow-lg);
        }
        
        .sidebar-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1040;
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-fadeIn {
            animation: fadeIn 0.5s ease forwards;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 8px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 8px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--dark-blue);
        }
        
        /* Responsive styles */
        @media (max-width: 991.98px) {
            .col-md-3.col-lg-2 {
                position: fixed;
                left: -300px;
                top: 0;
                bottom: 0;
                z-index: 1050;
                width: 280px;
                transition: left 0.3s ease;
                overflow-y: auto;
                padding-top: 60px;
            }
            
            .col-md-3.col-lg-2.mobile-show {
                left: 0;
            }
            
            .col-md-9.col-lg-10 {
                width: 100%;
                flex: 0 0 100%;
                max-width: 100%;
            }
            
            .mobile-menu-btn {
                display: flex;
                align-items: center;
                justify-content: center;
            }
            
            .sidebar-overlay.mobile-show {
                display: block;
            }
        }
        
        /* Print Styles - IMPROVED FOR LANDSCAPE */
        @media print {
            @page {
                size: landscape;
                margin: 0.5cm;
            }
            
            body * {
                visibility: hidden;
            }
            
            .app-container, .app-container * {
                visibility: visible;
            }
            
            .app-container {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                box-shadow: none;
            }
            
            .nav-pills, .mobile-menu-btn, .sidebar-overlay, .floating-action-btn,
            .btn-group, .filter-section, .toast {
                display: none !important;
            }
            
            .col-md-3.col-lg-2.p-4.bg-light {
                display: none !important;
            }
            
            .col-md-9.col-lg-10.p-5 {
                width: 100%;
                flex: 0 0 100%;
                max-width: 100%;
                padding: 0 !important;
            }
            
            .copyright {
                display: none;
            }
            
            .data-table {
                font-size: 10px;
                width: 100% !important;
            }
            
            .data-table th, .data-table td {
                padding: 4px 2px;
            }
            
            /* Sembunyikan kolom aksi dan link Google Drive saat mencetak */
            .data-table th:last-child,
            .data-table td:last-child {
                display: none !important;
            }
            
            /* Judul untuk laporan cetak */
            .print-header {
                display: block !important;
                text-align: center;
                margin-bottom: 15px;
            }
            
            .print-title {
                font-size: 18px;
                font-weight: bold;
                margin-bottom: 5px;
            }
            
            .print-subtitle {
                font-size: 14px;
                margin-bottom: 10px;
            }
            
            .print-date {
                font-size: 12px;
                text-align: right;
                margin-bottom: 10px;
            }
        }

        /* WhatsApp link style */
        .whatsapp-link {
            color: #25D366;
            text-decoration: none;
        }
        
        .whatsapp-link:hover {
            text-decoration: underline;
        }
        
        /* View Link Button */
        .btn-view {
            background: linear-gradient(135deg, #17a2b8, #138496);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
        }
        
        .btn-view:hover {
            background: linear-gradient(135deg, #138496, #117a8b);
            color: white;
        }
        
        /* Undo Button */
        .btn-undo {
            background: linear-gradient(135deg, #6c757d, #5a6268);
            color: white;
            border: none;
        }
        
        .btn-undo:hover {
            background: linear-gradient(135deg, #5a6268, #4e555b);
            color: white;
        }
        
        /* WhatsApp number link in table */
        .whatsapp-number {
            color: #25D366;
            cursor: pointer;
            text-decoration: underline;
        }
        
        /* Welcome Modal Styles */
        .welcome-modal .modal-content {
            border-radius: 15px;
            overflow: hidden;
            border: none;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .welcome-header {
            background: var(--gradient-primary);
            color: white;
            text-align: center;
            padding: 25px;
        }
        
        .welcome-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            color: white;
        }
        
        .welcome-body {
            padding: 25px;
            text-align: center;
        }
        
        .welcome-footer {
            background: #f8f9fa;
            padding: 15px;
            text-align: center;
            border-top: 1px solid #eee;
        }
        
        .countdown-timer {
            font-size: 0.9rem;
            color: #6c757d;
            margin-top: 10px;
        }
        
        /* Button untuk cetak per data */
        .btn-print-individual {
            background: linear-gradient(135deg, #6f42c1, #5a2d95);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
        }
        
        .btn-print-individual:hover {
            background: linear-gradient(135deg, #5a2d95, #4a2479);
            color: white;
        }
        
        /* Developer Info Styles */
        .developer-info {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            box-shadow: var(--shadow-sm);
        }
        
        .developer-info h6 {
            color: var(--primary-color);
            font-weight: 600;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 1px solid #ddd;
        }
        
        .developer-contact p {
            margin-bottom: 8px;
            font-size: 0.85rem;
        }
        
        .developer-contact a {
            color: var(--primary-color);
            text-decoration: none;
            transition: all 0.3s;
        }
        
        .developer-contact a:hover {
            color: var(--dark-blue);
            text-decoration: underline;
        }
        
        /* Welcome Splash Screen */
        .welcome-splash {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient-primary);
            color: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }
        
        .welcome-splash-content {
            text-align: center;
            max-width: 600px;
            padding: 30px;
        }
        
        .welcome-splash-logo {
            font-size: 4rem;
            margin-bottom: 20px;
        }
        
        .welcome-splash-title {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 15px;
        }
        
        .welcome-splash-message {
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 25px;
        }
        
        .welcome-splash-countdown {
            font-size: 1rem;
            margin-top: 20px;
        }
        
        .welcome-splash-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .welcome-splash-close:hover {
            background: rgba(255,255,255,0.3);
            transform: rotate(90deg);
        }
        
        /* Loading spinner */
        .spinner-border-sm {
            width: 1rem;
            height: 1rem;
        }

        /* Login Modal Styles */
        .login-modal .modal-content {
            border-radius: 15px;
            overflow: hidden;
            border: none;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .login-header {
            background: var(--login-gradient);
            color: white;
            text-align: center;
            padding: 25px 20px;
            position: relative;
        }

        .login-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            color: white;
        }

        .login-title {
            font-size: 1.8rem;
            font-weight: 700;
            margin: 0;
        }

        .login-subtitle {
            font-size: 1rem;
            opacity: 0.9;
            margin: 5px 0 0;
        }

        .login-body {
            padding: 25px;
            position: relative;
            z-index: 1;
        }

        .login-form-group {
            margin-bottom: 20px;
        }

        .login-form-label {
            font-weight: 600;
            color: var(--dark-blue);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
        }

        .login-form-label i {
            margin-right: 10px;
            color: var(--dark-blue);
        }

        .login-form-control {
            border-radius: 8px;
            padding: 12px 15px;
            border: 2px solid #ddd;
            transition: all 0.3s;
        }

        .login-form-control:focus {
            border-color: var(--dark-blue);
            box-shadow: 0 0 0 3px rgba(13, 71, 161, 0.2);
        }

        .login-input-group-text {
            background: var(--light-blue);
            border: 2px solid #ddd;
            border-left: none;
        }

        .btn-login {
            background: var(--gradient-secondary);
            color: white;
            border: none;
            padding: 12px;
            font-weight: 600;
            border-radius: 8px;
            width: 100%;
            transition: all 0.3s;
            margin-top: 10px;
        }

        .btn-login:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 105, 92, 0.4);
        }

        .btn-login:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .login-security-notice {
            text-align: center;
            margin-top: 20px;
            font-size: 0.85rem;
            color: #666;
        }

        .login-attempts-count {
            text-align: center;
            font-size: 0.9rem;
            color: #ff8f00;
            font-weight: 500;
            margin-top: 5px;
        }

        .login-blocked-message {
            text-align: center;
            background: rgba(220, 53, 69, 0.1);
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            color: #dc3545;
            font-weight: 500;
        }

        .login-countdown {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--dark-blue);
        }

        .login-developer-info {
            background: var(--light-blue);
            border-radius: 10px;
            padding: 20px;
            margin-top: 25px;
            text-align: center;
        }

        .login-developer-logo {
            max-width: 180px;
            margin-bottom: 15px;
            border-radius: 8px;
        }

        .login-developer-contact a {
            color: var(--dark-blue);
            text-decoration: none;
            transition: all 0.3s;
            display: inline-block;
            margin: 5px 0;
        }

        .login-developer-contact a:hover {
            color: var(--primary-color);
            text-decoration: underline;
            transform: translateY(-2px);
        }

        .login-copyright {
            text-align: center;
            margin-top: 20px;
            color: #666;
            font-size: 0.9rem;
            opacity: 0.9;
        }

        /* Animations */
        @keyframes login-shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-10px); }
            20%, 40%, 60%, 80% { transform: translateX(10px); }
        }

        .login-shake {
            animation: login-shake 0.6s cubic-bezier(.36,.07,.19,.97) both;
        }

        /* Login particle background */
        #login-particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1040; /* Higher than modal backdrop */
            display: none;
        }

        /* Link Google Drive dalam tabel */
        .drive-link {
            color: #0d47a1;
            text-decoration: none;
            cursor: pointer;
        }

        .drive-link:hover {
            text-decoration: underline;
        }

        /* Modal untuk menambah link */
        .link-modal .modal-dialog {
            max-width: 600px;
        }
        
        /* App content when not authenticated */
        .app-content-unauthenticated {
            display: none;
        }

        /* Search box for desa dropdown */
        .dropdown-search-container {
            position: relative;
        }

        .dropdown-search {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 1000;
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 8px;
            display: none;
        }

        .dropdown-search input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <!-- Login Modal -->
    <div class="modal fade login-modal" id="loginModal" tabindex="-1" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="login-header">
                    <div class="login-icon">
                        <i class="fas fa-lock"></i>
                    </div>
                    <h2 class="login-title">AUTHENTICATION REQUIRED</h2>
                    <p class="login-subtitle">Masukkan Kode Keamanan untuk Mengakses Aplikasi</p>
                </div>
                <div class="login-body">
                    <form id="loginForm">
                        <div class="mb-3 login-form-group">
                            <label class="form-label login-form-label">
                                <i class="fas fa-key"></i> Kode Keamanan
                            </label>
                            <div class="input-group">
                                <input type="password" class="form-control login-form-control" id="securityCode" placeholder="Masukkan kode akses aplikasi">
                                <button class="btn btn-outline-secondary toggle-password" type="button">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                            <div class="form-text text-danger login-attempts-count" id="attemptsCount"></div>
                        </div>
                        <button type="submit" class="btn btn-login" id="loginButton">
                            <span class="login-button-text">Masuk ke Aplikasi</span>
                            <span class="spinner-border spinner-border-sm d-none" id="loginSpinner"></span>
                        </button>
                    </form>
                    
                    <div class="login-blocked-message d-none" id="blockedMessage">
                        <i class="fas fa-ban me-2"></i>
                        <span id="blockedText">Terlalu banyak percobaan gagal. Silakan coba lagi dalam </span>
                        <span class="login-countdown" id="countdown">30</span> detik.
                    </div>
                    
                    <div class="login-security-notice">
                        <i class="fas fa-info-circle me-2"></i>
                        Hubungi Administrator untuk mendapatkan kode akses
                    </div>
                    
                    <div class="login-developer-info">
                        <h5 class="mb-3">Developer Information</h5>
                        <div class="login-developer-contact">
                            <p><i class="fab fa-whatsapp me-2"></i> <a href="https://wa.me/6285647709114" target="_blank">+62 856-4770-9114</a></p>
                            <p><i class="fas fa-envelope me-2"></i> <a href="mailto:admin@anekamarket.my.id">admin@anekamarket.my.id</a></p>
                        </div>
                    </div>
                    
                    <div class="login-copyright">
                        &copy; 2025 Lentera karya Situbondo
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Login particle background -->
    <div id="login-particles"></div>
    
    <!-- Welcome Splash Screen -->
    <div class="welcome-splash" id="welcomeSplash">
        <button class="welcome-splash-close" id="closeSplash">
            <i class="fas fa-times"></i>
        </button>
        <div class="welcome-splash-content">
            <div class="welcome-splash-logo">
                <i class="fas fa-hands-helping"></i>
            </div>
            <h1 class="welcome-splash-title">SISTEM BANTUAN BARJAS</h1>
            <p class="welcome-splash-message">
                Aplikasi Sistem Bantuan BARJAS merupakan platform terpadu yang dirancang untuk mentransformasi pendataan, penyaluran, 
                dan monitoring program bantuan pemerintah. Aplikasi ini kami ciptakan untuk mendorong efisiensi, akurasi, 
                dan transparansi dalam pengelolaan bantuan, guna mempercepat penyerapan dan meningkatkan akuntabilitas.
            </p>
            <div class="welcome-splash-countdown" id="splashCountdown">
                Membuka aplikasi dalam <span id="countdownTimer">5</span> detik...
            </div>
        </div>
    </div>
    
    <!-- Main Application Content (initially hidden) -->
    <div class="app-content-unauthenticated" id="appContent">
        <!-- Mobile Menu Button -->
        <button class="mobile-menu-btn" id="mobileMenuBtn">
            <i class="fas fa-bars"></i>
        </button>
        
        <!-- Sidebar Overlay -->
        <div class="sidebar-overlay" id="sidebarOverlay"></div>
        
        <div class="app-container animate-fadeIn">
            <div class="app-header">
                <div class="app-logo">
                    <i class="fas fa-hands-helping"></i>
                </div>
                <h1 class="app-title">BARJAS</h1>
                <p class="app-subtitle">Sistem Bantuan Terpadu</p>
                <p class="app-subtitle" id="institutionName">Dinas Peternakan dan Perikanan Kabupaten Situbondo</p>
                <div class="watermark">v2.5.0</div>
            </div>
            
            <div class="row g-0">
                <!-- Sidebar Navigation -->
                <div class="col-md-3 col-lg-2 p-4 bg-light" id="sidebarMenu">
                    <ul class="nav nav-pills flex-column mb-auto">
                        <li class="nav-item">
                            <a class="nav-link active" href="#" data-bs-target="dashboard">
                                <i class="fas fa-tachometer-alt feature-icon"></i> Dashboard
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-bs-target="inputData">
                                <i class="fas fa-pen-to-square feature-icon"></i> Input Data
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-bs-target="dataTable">
                                <i class="fas fa-table feature-icon"></i> Data Bantuan
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-bs-target="settings">
                                <i class="fas fa-cog feature-icon"></i> Pengaturan
                            </a>
                        </li>
                        <li class="nav-item mt-4">
                            <a class="nav-link text-danger" href="#" id="logoutBtn">
                                <i class="fas fa-sign-out-alt feature-icon"></i> Keluar
                            </a>
                        </li>
                    </ul>
                </div>
                
                <!-- Main Content -->
                <div class="col-md-9 col-lg-10 p-5">
                    <!-- Dashboard Section -->
                    <div class="content-section" id="dashboard">
                        <h3 class="section-title">Dashboard</h3>
                        
                        <div class="row">
                            <div class="col-md-3">
                                <div class="stats-box">
                                    <i class="fas fa-users text-primary"></i>
                                    <div class="stats-number" id="totalPenerima">0</div>
                                    <div class="stats-label">Total Penerima</div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="stats-box">
                                    <i class="fas fa-box text-success"></i>
                                    <div class="stats-number" id="totalBantuan">0</div>
                                    <div class="stats-label">Jenis Bantuan</div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="stats-box">
                                    <i class="fas fa-map-marker-alt text-warning"></i>
                                    <div class="stats-number" id="totalDesa">0</div>
                                    <div class="stats-label">Desa Terjangkau</div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="stats-box">
                                    <i class="fas fa-calendar-alt text-info"></i>
                                    <div class="stats-number" id="tahunAktif">2025</div>
                                    <div class="stats-label">Tahun Anggaran</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mt-4">
                            <div class="col-md-8">
                                <div class="card">
                                    <div class="card-header">
                                        <i class="fas fa-chart-bar me-2"></i> Statistik Bantuan per Desa
                                    </div>
                                    <div class="card-body">
                                        <canvas id="desaChart" height="250"></canvas>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card">
                                    <div class="card-header">
                                        <i class="fas fa-chart-pie me-2"></i> Jenis Bantuan
                                    </div>
                                    <div class="card-body">
                                        <canvas id="bantuanChart" height="250"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mt-4">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-header">
                                        <i class="fas fa-history me-2"></i> Data Bantuan Terbaru
                                    </div>
                                    <div class="card-body">
                                        <div class="table-responsive">
                                            <table class="table table-hover data-table" id="recentDataTable">
                                                <thead>
                                                    <tr>
                                                        <th>No</th>
                                                        <th>Nama Penerima</th>
                                                        <th>NIK</th>
                                                        <th>Desa</th>
                                                        <th>Jenis Bantuan</th>
                                                        <th>Tanggal</th>
                                                        <th>Status</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <!-- Data akan diisi oleh JavaScript -->
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Developer Information -->
                        <div class="developer-info mt-4">
                            <h6><i class="fas fa-info-circle me-2"></i> Informasi Pengembang</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="developer-contact">
                                        <p><strong>Nama:</strong> Lentera Karya Situbondo</p>
                                        <p><strong>Alamat:</strong> Jl. Raya Panji No. 123, Situbondo</p>
                                        <p><strong>Email:</strong> <a href="mailto:admin@anekamarket.my.id">admin@anekamarket.my.id</a></p>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="developer-contact">
                                        <p><strong>WhatsApp:</strong> <a href="https://wa.me/6285647709114" target="_blank" class="whatsapp-link">+62 856-4770-9114</a></p>
                                        <p><strong>Website:</strong> <a href="https://anekamarket.my.id" target="_blank">anekamarket.my.id</a></p>
                                        <p><strong>Layanan:</strong> Pembuatan Aplikasi dan Sistem Informasi</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Input Data Section -->
                    <div class="content-section d-none" id="inputData">
                        <h3 class="section-title">Input Data Bantuan</h3>
                        
                        <form id="bantuanForm">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label"><i class="fas fa-user"></i> Nama Penerima</label>
                                        <input type="text" class="form-control" id="namaPenerima" required>
                                        <div class="error-message" id="namaPenerimaError">Nama penerima harus diisi</div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label"><i class="fas fa-id-card"></i> NIK</label>
                                        <input type="text" class="form-control" id="nik" maxlength="16" required>
                                        <div class="error-message" id="nikError">NIK harus 16 digit angka</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label"><i class="fas fa-users"></i> Nama Kelompok</label>
                                        <input type="text" class="form-control" id="namaKelompok">
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label"><i class="fas fa-briefcase"></i> Jabatan</label>
                                        <select class="form-select" id="jabatan">
                                            <option value="">Pilih Jabatan</option>
                                            <option value="Ketua Kelompok">Ketua Kelompok</option>
                                            <option value="Sekretaris">Sekretaris</option>
                                            <option value="Bendahara">Bendahara</option>
                                            <option value="Pengawas">Pengawas</option>
                                            <option value="Anggota">Anggota</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label"><i class="fas fa-home"></i> Desa/Kelurahan</label>
                                        <select class="form-select" id="desa" required>
                                            <option value="">Pilih Desa/Kelurahan</option>
                                            <option value="Agel">Agel</option>
                                            <option value="Alas Bayur">Alas Bayur</option>
                                            <option value="Alasmalang">Alasmalang</option>
                                            <option value="Alastengah">Alastengah</option>
                                            <option value="Arjasa">Arjasa</option>
                                            <option value="Ardirejo">Ardirejo</option>
                                            <option value="Asembagus">Asembagus</option>
                                            <option value="Awar-awar">Awar-awar</option>
                                            <option value="Awang-awang">Awang-awang</option>
                                            <option value="Baderan">Baderan</option>
                                            <option value="Balung">Balung</option>
                                            <option value="Bantal">Bantal</option>
                                            <option value="Battal">Battal</option>
                                            <option value="Bayeman">Bayeman</option>
                                            <option value="Besuki">Besuki</option>
                                            <option value="Bletok">Bletok</option>
                                            <option value="Blimbing">Blimbing</option>
                                            <option value="Bloro">Bloro</option>
                                            <option value="Buduan">Buduan</option>
                                            <option value="Bugeman">Bugeman</option>
                                            <option value="Bungatan">Bungatan</option>
                                            <option value="Campoan">Campoan</option>
                                            <option value="Cemara">Cemara</option>
                                            <option value="Curah Cottok">Curah Cottok</option>
                                            <option value="Curah Jeru">Curah Jeru</option>
                                            <option value="Curah Kalak">Curah Kalak</option>
                                            <option value="Curah Suri">Curah Suri</option>
                                            <option value="Curah Tatal">Curah Tatal</option>
                                            <option value="Dawuhan">Dawuhan</option>
                                            <option value="Demung">Demung</option>
                                            <option value="Duwet">Duwet</option>
                                            <option value="Gadingan">Gadingan</option>
                                            <option value="Gebangan">Gebangan</option>
                                            <option value="Gelung">Gelung</option>
                                            <option value="Gudang">Gudang</option>
                                            <option value="Gunung Malang">Gunung Malang</option>
                                            <option value="Gunung Putri">Gunung Putri</option>
                                            <option value="Jangkar">Jangkar</option>
                                            <option value="Jatisari">Jatisari</option>
                                            <option value="Jatibanteng">Jatibanteng</option>
                                            <option value="Jetis">Jetis</option>
                                            <option value="Juglangan">Juglangan</option>
                                            <option value="Kalianget">Kalianget</option>
                                            <option value="Kalibagor">Kalibagor</option>
                                            <option value="Kalimas">Kalimas</option>
                                            <option value="Kalirejo">Kalirejo</option>
                                            <option value="Kalisari">Kalisari</option>
                                            <option value="Kandang">Kandang</option>
                                            <option value="Kayu Putih">Kayu Putih</option>
                                            <option value="Kayumas">Kayumas</option>
                                            <option value="Kedungdowo">Kedungdowo</option>
                                            <option value="Kedunglo">Kedunglo</option>
                                            <option value="Kembangsari">Kembangsari</option>
                                            <option value="Ketah">Ketah</option>
                                            <option value="Ketowan">Ketowan</option>
                                            <option value="Kilensari">Kilensari</option>
                                            <option value="Klampokan">Klampokan</option>
                                            <option value="Klatakan">Klatakan</option>
                                            <option value="Kotakan">Kotakan</option>
                                            <option value="Kumbangsari">Kumbangsari</option>
                                            <option value="Kukusan">Kukusan</option>
                                            <option value="Lamongan">Lamongan</option>
                                            <option value="Landangan">Landangan</option>
                                            <option value="Langkap">Langkap</option>
                                            <option value="Lebeng">Lebeng</option>
                                            <option value="Lubawang">Lubawang</option>
                                            <option value="Mangaran">Mangaran</option>
                                            <option value="Mimbaan">Mimbaan</option>
                                            <option value="Mlandingan Kulon">Mlandingan Kulon</option>
                                            <option value="Mlandingan Wetan">Mlandingan Wetan</option>
                                            <option value="Mojodungkol">Mojodungkol</option>
                                            <option value="Mojosari">Mojosari</option>
                                            <option value="Olean">Olean</option>
                                            <option value="Palangan">Palangan</option>
                                            <option value="Panarukan">Panarukan</option>
                                            <option value="Panji Kidul">Panji Kidul</option>
                                            <option value="Panji Lor">Panji Lor</option>
                                            <option value="Parante">Parante</option>
                                            <option value="Pasir Putih">Pasir Putih</option>
                                            <option value="Patemon">Patemon</option>
                                            <option value="Patokan">Patokan</option>
                                            <option value="Paowan">Paowan</option>
                                            <option value="Peleyan">Peleyan</option>
                                            <option value="Pesisir">Pesisir</option>
                                            <option value="Pesanggrahan">Pesanggrahan</option>
                                            <option value="Pategalan">Pategalan</option>
                                            <option value="Plalangan">Plalangan</option>
                                            <option value="Pokaan">Pokaan</option>
                                            <option value="Rajekwesi">Rajekwesi</option>
                                            <option value="Seletreng">Seletreng</option>
                                            <option value="Selobanteng">Selobanteng</option>
                                            <option value="Selomukti">Selomukti</option>
                                            <option value="Selowogo">Selowogo</option>
                                            <option value="Semambung">Semambung</option>
                                            <option value="Semiring">Semiring</option>
                                            <option value="Sliwung">Sliwung</option>
                                            <option value="Sopet">Sopet</option>
                                            <option value="Sumber Pinang">Sumber Pinang</option>
                                            <option value="Sumberanyar">Sumberanyar</option>
                                            <option value="Sumberargo">Sumberargo</option>
                                            <option value="Sumberkolak">Sumberkolak</option>
                                            <option value="Sumberejo">Sumberejo</option>
                                            <option value="Sumbertengah">Sumbertengah</option>
                                            <option value="Sumberwaru">Sumberwaru</option>
                                            <option value="Tamankursi">Tamankursi</option>
                                            <option value="Tamansari">Tamansari</option>
                                            <option value="Taman">Taman</option>
                                            <option value="Talkandang">Talkandang</option>
                                            <option value="Tanjung Glugur">Tanjung Glugur</option>
                                            <option value="Tanjung Kamal">Tanjung Kamal</option>
                                            <option value="Tanjung Pecinan">Tanjung Pecinan</option>
                                            <option value="Tambak Ukir">Tambak Ukir</option>
                                            <option value="Telempong">Telempong</option>
                                            <option value="Tenggir">Tenggir</option>
                                            <option value="Tepos">Tepos</option>
                                            <option value="Tokelan">Tokelan</option>
                                            <option value="Tlogosari">Tlogosari</option>
                                            <option value="Trigonco">Trigonco</option>
                                            <option value="Trebungan">Trebungan</option>
                                            <option value="Widoropayung">Widoropayung</option>
                                            <option value="Wonokoyo">Wonokoyo</option>
                                            <option value="Wonorejo">Wonorejo</option>
                                            <option value="Wringinanom">Wringinanom</option>
                                        </select>
                                        <div class="error-message" id="desaError">Desa/Kelurahan harus dipilih</div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label"><i class="fas fa-calendar"></i> Tahun Anggaran</label>
                                        <select class="form-select" id="tahunAnggaran" required>
                                            <option value="">Pilih Tahun Anggaran</option>
                                            <!-- Tahun akan diisi oleh JavaScript -->
                                        </select>
                                        <div class="error-message" id="tahunAnggaranError">Tahun Anggaran harus dipilih</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label"><i class="fas fa-box"></i> Jenis Bantuan</label>
                                        <input type="text" class="form-control" id="jenisBantuan" required>
                                        <div class="error-message" id="jenisBantuanError">Jenis bantuan harus diisi</div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label"><i class="fas fa-calendar-day"></i> Tanggal Penerimaan</label>
                                        <input type="date" class="form-control" id="tanggalPenerimaan" required>
                                        <div class="error-message" id="tanggalPenerimaanError">Tanggal penerimaan harus diisi</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label"><i class="fas fa-link"></i> Link Google Drive (opsional)</label>
                                <input type="url" class="form-control" id="linkDrive" placeholder="https://drive.google.com/...">
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label"><i class="fas fa-sticky-note"></i> Keterangan (opsional)</label>
                                <textarea class="form-control" id="keterangan" rows="3"></textarea>
                            </div>
                            
                            <div class="d-flex justify-content-end gap-2">
                                <button type="reset" class="btn btn-secondary">Reset</button>
                                <button type="submit" class="btn btn-primary">Simpan Data</button>
                            </div>
                        </form>
                    </div>
                    
                    <!-- Data Table Section -->
                    <div class="content-section d-none" id="dataTable">
                        <h3 class="section-title">Data Bantuan</h3>
                        
                        <div class="filter-section">
                            <div class="row g-3">
                                <div class="col-md-4">
                                    <label class="form-label">Cari Data</label>
                                    <input type="text" class="form-control" id="searchInput" placeholder="Cari berdasarkan nama, NIK, desa...">
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label">Filter Berdasarkan Desa</label>
                                    <select class="form-select" id="filterDesa">
                                        <option value="">Semua Desa</option>
                                        <!-- Opsi desa akan diisi oleh JavaScript -->
                                    </select>
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label">Filter Berdasarkan Tahun</label>
                                    <select class="form-select" id="filterTahun">
                                        <option value="">Semua Tahun</option>
                                        <!-- Opsi tahun akan diisi oleh JavaScript -->
                                    </select>
                                </div>
                                <div class="col-md-2 d-flex align-items-end">
                                    <button class="btn btn-outline-secondary w-100" id="resetFilter">Reset Filter</button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="control-panel">
                            <div class="control-title">Kelola Data</div>
                            <div class="d-flex flex-wrap gap-2">
                                <button class="btn btn-success" id="exportExcelBtn">
                                    <i class="fas fa-file-excel me-2"></i> Export Excel
                                </button>
                                <button class="btn btn-danger" id="exportPdfBtn">
                                    <i class="fas fa-file-pdf me-2"></i> Export PDF
                                </button>
                                <button class="btn btn-warning" id="printBtn">
                                    <i class="fas fa-print me-2"></i> Cetak
                                </button>
                                <button class="btn btn-info" id="importBtn">
                                    <i class="fas fa-file-import me-2"></i> Import Data
                                </button>
                                <button class="btn btn-outline-danger" id="deleteAllBtn">
                                    <i class="fas fa-trash-alt me-2"></i> Hapus Semua Data
                                </button>
                            </div>
                        </div>
                        
                        <div class="table-responsive mt-4">
                            <table class="table table-hover data-table" id="bantuanDataTable">
                                <thead>
                                    <tr>
                                        <th>No</th>
                                        <th>Nama Penerima</th>
                                        <th>NIK</th>
                                        <th>Nama Kelompok</th>
                                        <th>Jabatan</th>
                                        <th>Desa</th>
                                        <th>Tahun</th>
                                        <th>Jenis Bantuan</th>
                                        <th>Tanggal</th>
                                        <th>Link Drive</th>
                                        <th>Aksi</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Data akan diisi oleh JavaScript -->
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="d-flex justify-content-between align-items-center mt-3">
                            <div class="text-muted" id="tableInfo">Menampilkan 0 data</div>
                            <nav>
                                <ul class="pagination justify-content-end" id="pagination">
                                    <!-- Pagination akan diisi oleh JavaScript -->
                                </ul>
                            </nav>
                        </div>
                    </div>
                    
                    <!-- Settings Section -->
                    <div class="content-section d-none" id="settings">
                        <h3 class="section-title">Pengaturan Aplikasi</h3>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-header">
                                        <i class="fas fa-key me-2"></i> Pengaturan Keamanan
                                    </div>
                                    <div class="card-body">
                                        <form id="securitySettingsForm">
                                            <div class="mb-3">
                                                <label class="form-label">Kode Keamanan Saat Ini</label>
                                                <input type="password" class="form-control" id="currentSecurityCode" disabled>
                                            </div>
                                            <div class="mb-3">
                                                <label class="form-label">Kode Keamanan Baru</label>
                                                <input type="password" class="form-control" id="newSecurityCode" placeholder="Masukkan kode keamanan baru">
                                            </div>
                                            <div class="mb-3">
                                                <label class="form-label">Konfirmasi Kode Keamanan Baru</label>
                                                <input type="password" class="form-control" id="confirmSecurityCode" placeholder="Konfirmasi kode keamanan baru">
                                            </div>
                                            <button type="submit" class="btn btn-primary">Simpan Perubahan</button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-header">
                                        <i class="fas fa-database me-2"></i> Kelola Data
                                    </div>
                                    <div class="card-body">
                                        <div class="mb-4">
                                            <h6 class="mb-3">Cadangkan Data</h6>
                                            <p class="text-muted small mb-3">Unduh salinan data sebagai file JSON untuk cadangan.</p>
                                            <button class="btn btn-outline-primary w-100" id="backupDataBtn">
                                                <i class="fas fa-download me-2"></i> Cadangkan Data
                                            </button>
                                        </div>
                                        
                                        <div class="mb-4">
                                            <h6 class="mb-3">Pulihkan Data</h6>
                                            <p class="text-muted small mb-3">Unggah file JSON untuk memulihkan data sebelumnya.</p>
                                            <input type="file" class="form-control mb-2" id="restoreDataInput" accept=".json">
                                            <button class="btn btn-outline-success w-100" id="restoreDataBtn" disabled>
                                                <i class="fas fa-upload me-2"></i> Pulihkan Data
                                            </button>
                                        </div>
                                        
                                        <div>
                                            <h6 class="mb-3">Reset Aplikasi</h6>
                                            <p class="text-muted small mb-3">Hapus semua data dan setel ulang aplikasi ke pengaturan awal.</p>
                                            <button class="btn btn-outline-danger w-100" id="resetAppBtn">
                                                <i class="fas fa-trash-alt me-2"></i> Reset Aplikasi
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card mt-4">
                            <div class="card-header">
                                <i class="fas fa-info-circle me-2"></i> Informasi Aplikasi
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <table class="table table-borderless">
                                            <tr>
                                                <th width="40%">Nama Aplikasi</th>
                                                <td>BARJAS - Sistem Bantuan Terpadu</td>
                                            </tr>
                                            <tr>
                                                <th>Versi</th>
                                                <td>v2.5.0</td>
                                            </tr>
                                            <tr>
                                                <th>Tanggal Rilis</th>
                                                <td>15 Agustus 2025</td>
                                            </tr>
                                        </table>
                                    </div>
                                    <div class="col-md-6">
                                        <table class="table table-borderless">
                                            <tr>
                                                <th width="40%">Pengembang</th>
                                                <td>Lentera Karya Situbondo</td>
                                            </tr>
                                            <tr>
                                                <th>Kontak</th>
                                                <td>
                                                    <a href="https://wa.me/6285647709114" target="_blank" class="whatsapp-link">
                                                        <i class="fab fa-whatsapp me-1"></i> +62 856-4770-9114
                                                    </a>
                                                </td>
                                            </tr>
                                            <tr>
                                                <th>Email</th>
                                                <td>
                                                    <a href="mailto:admin@anekamarket.my.id">admin@anekamarket.my.id</a>
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="copyright">
                &copy; 2025 <strong>BARJAS - Sistem Bantuan Terpadu</strong> | Dikembangkan oleh <strong>Lentera Karya Situbondo</strong>
            </div>
        </div>
        
        <!-- Floating Action Button -->
        <div class="floating-action-btn" id="fab">
            <i class="fas fa-plus"></i>
        </div>
        
        <!-- Toast Notification -->
        <div class="toast notification-toast" role="alert" aria-live="assertive" aria-atomic="true" id="notificationToast">
            <div class="toast-header">
                <i class="fas fa-bell text-primary me-2"></i>
                <strong class="me-auto">Notifikasi</strong>
                <small>Baru saja</small>
                <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
            <div class="toast-body" id="toastMessage">
                <!-- Pesan notifikasi akan dimuat di sini -->
            </div>
        </div>
    </div>
    
    <!-- Import Modal -->
    <div class="modal fade" id="importModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Import Data dari Excel</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">Pilih File Excel</label>
                        <input type="file" class="form-control" id="importFile" accept=".xlsx, .xls">
                    </div>
                    <div class="form-text">
                        <a href="#" id="downloadTemplate">Unduh template Excel</a>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                    <button type="button" class="btn btn-primary" id="confirmImport">Import</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Confirmation Modal -->
    <div class="modal fade" id="confirmationModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="confirmationModalTitle">Konfirmasi</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="confirmationModalBody">
                    <!-- Pesan konfirmasi akan dimuat di sini -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                    <button type="button" class="btn btn-danger" id="confirmAction">Ya, Lanjutkan</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Link Modal -->
    <div class="modal fade link-modal" id="linkModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Tambah/Ubah Link Google Drive</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">Link Google Drive</label>
                        <input type="url" class="form-control" id="modalLinkDrive" placeholder="https://drive.google.com/...">
                    </div>
                    <input type="hidden" id="modalLinkIndex">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                    <button type="button" class="btn btn-primary" id="saveLinkBtn">Simpan</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <script>
        // Konfigurasi dan Inisialisasi Aplikasi
        document.addEventListener('DOMContentLoaded', function() {
            // Konstanta dan variabel global
            const APP_NAME = 'BARJAS';
            const APP_VERSION = '2.5.0';
            const DEFAULT_SECURITY_CODE = '123456';
            const MAX_LOGIN_ATTEMPTS = 3;
            const BLOCK_DURATION = 30; // dalam detik
            
            // Elemen DOM
            const loginModal = new bootstrap.Modal(document.getElementById('loginModal'));
            const welcomeSplash = document.getElementById('welcomeSplash');
            const appContent = document.getElementById('appContent');
            const securityCodeInput = document.getElementById('securityCode');
            const loginForm = document.getElementById('loginForm');
            const loginButton = document.getElementById('loginButton');
            const loginSpinner = document.getElementById('loginSpinner');
            const attemptsCount = document.getElementById('attemptsCount');
            const blockedMessage = document.getElementById('blockedMessage');
            const blockedText = document.getElementById('blockedText');
            const countdown = document.getElementById('countdown');
            const mobileMenuBtn = document.getElementById('mobileMenuBtn');
            const sidebarMenu = document.getElementById('sidebarMenu');
            const sidebarOverlay = document.getElementById('sidebarOverlay');
            const navLinks = document.querySelectorAll('.nav-link');
            const contentSections = document.querySelectorAll('.content-section');
            const bantuanForm = document.getElementById('bantuanForm');
            const bantuanDataTable = document.getElementById('bantuanDataTable');
            const recentDataTable = document.getElementById('recentDataTable');
            const notificationToast = new bootstrap.Toast(document.getElementById('notificationToast'));
            const toastMessage = document.getElementById('toastMessage');
            const fab = document.getElementById('fab');
            const searchInput = document.getElementById('searchInput');
            const filterDesa = document.getElementById('filterDesa');
            const filterTahun = document.getElementById('filterTahun');
            const resetFilter = document.getElementById('resetFilter');
            const exportExcelBtn = document.getElementById('exportExcelBtn');
            const exportPdfBtn = document.getElementById('exportPdfBtn');
            const printBtn = document.getElementById('printBtn');
            const importBtn = document.getElementById('importBtn');
            const deleteAllBtn = document.getElementById('deleteAllBtn');
            const tableInfo = document.getElementById('tableInfo');
            const pagination = document.getElementById('pagination');
            const importModal = new bootstrap.Modal(document.getElementById('importModal'));
            const confirmationModal = new bootstrap.Modal(document.getElementById('confirmationModal'));
            const confirmActionBtn = document.getElementById('confirmAction');
            const linkModal = new bootstrap.Modal(document.getElementById('linkModal'));
            const saveLinkBtn = document.getElementById('saveLinkBtn');
            const backupDataBtn = document.getElementById('backupDataBtn');
            const restoreDataInput = document.getElementById('restoreDataInput');
            const restoreDataBtn = document.getElementById('restoreDataBtn');
            const resetAppBtn = document.getElementById('resetAppBtn');
            const securitySettingsForm = document.getElementById('securitySettingsForm');
            const currentSecurityCode = document.getElementById('currentSecurityCode');
            const newSecurityCode = document.getElementById('newSecurityCode');
            const confirmSecurityCode = document.getElementById('confirmSecurityCode');
            const namaKelompokInput = document.getElementById('namaKelompok');
            const tahunAnggaranSelect = document.getElementById('tahunAnggaran');
            const desaSelect = document.getElementById('desa');
            const filterDesaSelect = document.getElementById('filterDesa');
            
            // State aplikasi
            let loginAttempts = 0;
            let isBlocked = false;
            let blockTimeout;
            let bantuanData = [];
            let currentPage = 1;
            const itemsPerPage = 10;
            let filteredData = [];
            let currentFilter = {};
            let desaChart, bantuanChart;
            
            // Inisialisasi aplikasi
            function initApp() {
                // Tampilkan splash screen
                showSplashScreen();
                
                // Inisialisasi data
                loadData();
                
                // Setup event listeners
                setupEventListeners();
                
                // Setup form validation
                setupFormValidation();
                
                // Setup tahun anggaran dropdown
                setupTahunAnggaran();
                
                // Setup filter desa dropdown
                setupFilterDesa();
                
                // Setup filter tahun dropdown
                setupFilterTahun();
                
                // Setup security code display
                setupSecurityCodeDisplay();
            }
            
            // Tampilkan splash screen
            function showSplashScreen() {
                let countdownTime = 5;
                const countdownTimer = document.getElementById('countdownTimer');
                
                const countdownInterval = setInterval(() => {
                    countdownTime--;
                    countdownTimer.textContent = countdownTime;
                    
                    if (countdownTime <= 0) {
                        clearInterval(countdownInterval);
                        welcomeSplash.style.opacity = '0';
                        setTimeout(() => {
                            welcomeSplash.style.display = 'none';
                            loginModal.show();
                        }, 500);
                    }
                }, 1000);
                
                // Close splash screen manually
                document.getElementById('closeSplash').addEventListener('click', function() {
                    clearInterval(countdownInterval);
                    welcomeSplash.style.opacity = '0';
                    setTimeout(() => {
                        welcomeSplash.style.display = 'none';
                        loginModal.show();
                    }, 500);
                });
            }
            
            // Muat data dari localStorage
            function loadData() {
                const savedData = localStorage.getItem('bantuanData');
                const savedSecurityCode = localStorage.getItem('securityCode');
                
                if (savedData) {
                    bantuanData = JSON.parse(savedData);
                } else {
                    bantuanData = [];
                }
                
                if (!savedSecurityCode) {
                    localStorage.setItem('securityCode', DEFAULT_SECURITY_CODE);
                }
            }
            
            // Setup event listeners
            function setupEventListeners() {
                // Toggle password visibility
                document.querySelector('.toggle-password').addEventListener('click', function() {
                    const type = securityCodeInput.getAttribute('type') === 'password' ? 'text' : 'password';
                    securityCodeInput.setAttribute('type', type);
                    this.innerHTML = type === 'password' ? '<i class="fas fa-eye"></i>' : '<i class="fas fa-eye-slash"></i>';
                });
                
                // Login form submission
                loginForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    handleLogin();
                });
                
                // Mobile menu toggle
                mobileMenuBtn.addEventListener('click', toggleMobileMenu);
                sidebarOverlay.addEventListener('click', toggleMobileMenu);
                
                // Navigation
                navLinks.forEach(link => {
                    link.addEventListener('click', function(e) {
                        e.preventDefault();
                        
                        // Handle logout
                        if (this.id === 'logoutBtn') {
                            handleLogout();
                            return;
                        }
                        
                        // Activate nav link
                        navLinks.forEach(nav => nav.classList.remove('active'));
                        this.classList.add('active');
                        
                        // Show corresponding section
                        const target = this.getAttribute('data-bs-target');
                        contentSections.forEach(section => section.classList.add('d-none'));
                        document.getElementById(target).classList.remove('d-none');
                        
                        // Close mobile menu if open
                        if (window.innerWidth < 992) {
                            toggleMobileMenu();
                        }
                        
                        // Jika menuju ke dashboard, refresh chart
                        if (target === 'dashboard') {
                            refreshDashboard();
                        }
                        
                        // Jika menuju ke data table, refresh tabel
                        if (target === 'dataTable') {
                            refreshDataTable();
                        }
                    });
                });
                
                // Form submission
                bantuanForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    handleFormSubmit();
                });
                
                // FAB click
                fab.addEventListener('click', function() {
                    navLinks.forEach(nav => nav.classList.remove('active'));
                    document.querySelector('[data-bs-target="inputData"]').classList.add('active');
                    
                    contentSections.forEach(section => section.classList.add('d-none'));
                    document.getElementById('inputData').classList.remove('d-none');
                    
                    bantuanForm.scrollIntoView({ behavior: 'smooth' });
                });
                
                // Search and filter
                searchInput.addEventListener('input', applyFilters);
                filterDesa.addEventListener('change', applyFilters);
                filterTahun.addEventListener('change', applyFilters);
                resetFilter.addEventListener('click', resetFilters);
                
                // Export and actions
                exportExcelBtn.addEventListener('click', exportToExcel);
                exportPdfBtn.addEventListener('click', exportToPDF);
                printBtn.addEventListener('click', printTable);
                importBtn.addEventListener('click', () => importModal.show());
                deleteAllBtn.addEventListener('click', confirmDeleteAll);
                
                // Confirmation modal
                confirmActionBtn.addEventListener('click', handleConfirmAction);
                
                // Link modal
                saveLinkBtn.addEventListener('click', saveLink);
                
                // Backup and restore
                backupDataBtn.addEventListener('click', backupData);
                restoreDataInput.addEventListener('change', function() {
                    restoreDataBtn.disabled = !this.files.length;
                });
                restoreDataBtn.addEventListener('click', restoreData);
                resetAppBtn.addEventListener('click', confirmResetApp);
                
                // Security settings
                securitySettingsForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    updateSecurityCode();
                });
                
                // Nama Kelompok auto uppercase
                namaKelompokInput.addEventListener('input', function() {
                    this.value = this.value.toUpperCase();
                });
                
                // NIK validation (only numbers, max 16 digits)
                document.getElementById('nik').addEventListener('input', function(e) {
                    this.value = this.value.replace(/\D/g, '').slice(0, 16);
                });
                
                // Setup search for desa dropdown
                setupDesaSearch();
            }
            
            // Setup form validation
            function setupFormValidation() {
                const inputs = bantuanForm.querySelectorAll('input[required], select[required]');
                
                inputs.forEach(input => {
                    input.addEventListener('blur', function() {
                        validateField(this);
                    });
                });
            }
            
            // Validasi field form
            function validateField(field) {
                const errorElement = document.getElementById(field.id + 'Error');
                
                if (field.hasAttribute('required') && !field.value.trim()) {
                    field.classList.add('input-error');
                    errorElement.style.display = 'block';
                    return false;
                }
                
                // Validasi khusus untuk NIK
                if (field.id === 'nik' && field.value.length !== 16) {
                    field.classList.add('input-error');
                    errorElement.style.display = 'block';
                    return false;
                }
                
                field.classList.remove('input-error');
                errorElement.style.display = 'none';
                return true;
            }
            
            // Setup tahun anggaran dropdown
            function setupTahunAnggaran() {
                const currentYear = new Date().getFullYear();
                let options = '<option value="">Pilih Tahun Anggaran</option>';
                
                for (let year = 2020; year <= 2090; year++) {
                    options += `<option value="${year}" ${year === currentYear ? 'selected' : ''}>${year}</option>`;
                }
                
                tahunAnggaranSelect.innerHTML = options;
                
                // Juga isi filter tahun
                const filterTahunSelect = document.getElementById('filterTahun');
                filterTahunSelect.innerHTML = '<option value="">Semua Tahun</option>' + options.replace(/selected/g, '');
            }
            
            // Setup filter desa dropdown
            function setupFilterDesa() {
                const desaOptions = desaSelect.querySelectorAll('option');
                let options = '<option value="">Semua Desa</option>';
                
                desaOptions.forEach(option => {
                    if (option.value) {
                        options += `<option value="${option.value}">${option.textContent}</option>`;
                    }
                });
                
                filterDesaSelect.innerHTML = options;
            }
            
            // Setup filter tahun dropdown
            function setupFilterTahun() {
                const tahunOptions = tahunAnggaranSelect.querySelectorAll('option');
                let options = '<option value="">Semua Tahun</option>';
                
                tahunOptions.forEach(option => {
                    if (option.value) {
                        options += `<option value="${option.value}">${option.textContent}</option>`;
                    }
                });
                
                document.getElementById('filterTahun').innerHTML = options;
            }
            
            // Setup security code display
            function setupSecurityCodeDisplay() {
                const savedSecurityCode = localStorage.getItem('securityCode') || DEFAULT_SECURITY_CODE;
                currentSecurityCode.value = savedSecurityCode;
            }
            
            // Setup desa search functionality
            function setupDesaSearch() {
                const desaOptions = desaSelect.options;
                const searchContainer = document.createElement('div');
                searchContainer.className = 'dropdown-search-container';
                
                const searchInput = document.createElement('input');
                searchInput.type = 'text';
                searchInput.placeholder = 'Cari desa...';
                searchInput.className = 'form-control';
                
                const searchResults = document.createElement('div');
                searchResults.className = 'dropdown-search';
                
                desaSelect.parentNode.insertBefore(searchContainer, desaSelect);
                searchContainer.appendChild(desaSelect);
                searchContainer.appendChild(searchResults);
                
                searchInput.addEventListener('focus', function() {
                    searchResults.style.display = 'block';
                    filterDesaOptions(this.value);
                });
                
                searchInput.addEventListener('input', function() {
                    filterDesaOptions(this.value);
                });
                
                searchInput.addEventListener('blur', function() {
                    setTimeout(() => {
                        searchResults.style.display = 'none';
                    }, 200);
                });
                
                searchResults.addEventListener('mousedown', function(e) {
                    if (e.target.tagName === 'OPTION') {
                        desaSelect.value = e.target.value;
                        searchInput.value = '';
                        searchResults.style.display = 'none';
                    }
                });
                
                function filterDesaOptions(searchTerm) {
                    searchResults.innerHTML = '';
                    
                    for (let i = 0; i < desaOptions.length; i++) {
                        const option = desaOptions[i];
                        if (option.value && option.text.toLowerCase().includes(searchTerm.toLowerCase())) {
                            const resultOption = document.createElement('div');
                            resultOption.textContent = option.text;
                            resultOption.setAttribute('data-value', option.value);
                            resultOption.style.padding = '5px 10px';
                            resultOption.style.cursor = 'pointer';
                            
                            resultOption.addEventListener('mouseenter', function() {
                                this.style.backgroundColor = '#f0f0f0';
                            });
                            
                            resultOption.addEventListener('mouseleave', function() {
                                this.style.backgroundColor = 'transparent';
                            });
                            
                            searchResults.appendChild(resultOption);
                        }
                    }
                    
                    if (searchResults.children.length === 0) {
                        const noResult = document.createElement('div');
                        noResult.textContent = 'Tidak ditemukan';
                        noResult.style.padding = '5px 10px';
                        noResult.style.color = '#999';
                        searchResults.appendChild(noResult);
                    }
                }
            }
            
            // Handle login
            function handleLogin() {
                if (isBlocked) {
                    showNotification('Anda sedang dalam masa blokir. Silakan coba lagi nanti.', 'error');
                    return;
                }
                
                const enteredCode = securityCodeInput.value;
                const savedCode = localStorage.getItem('securityCode') || DEFAULT_SECURITY_CODE;
                
                loginButton.disabled = true;
                loginSpinner.classList.remove('d-none');
                document.querySelector('.login-button-text').textContent = 'Memverifikasi...';
                
                // Simulasi proses verifikasi
                setTimeout(() => {
                    if (enteredCode === savedCode) {
                        // Login berhasil
                        loginAttempts = 0;
                        attemptsCount.classList.add('d-none');
                        blockedMessage.classList.add('d-none');
                        
                        loginModal.hide();
                        appContent.classList.remove('app-content-unauthenticated');
                        
                        showNotification('Login berhasil. Selamat datang di ' + APP_NAME, 'success');
                        
                        // Refresh dashboard
                        refreshDashboard();
                    } else {
                        // Login gagal
                        loginAttempts++;
                        
                        if (loginAttempts >= MAX_LOGIN_ATTEMPTS) {
                            // Blokir akses
                            isBlocked = true;
                            attemptsCount.classList.add('d-none');
                            blockedMessage.classList.remove('d-none');
                            
                            let remainingTime = BLOCK_DURATION;
                            countdown.textContent = remainingTime;
                            
                            blockTimeout = setInterval(() => {
                                remainingTime--;
                                countdown.textContent = remainingTime;
                                
                                if (remainingTime <= 0) {
                                    clearInterval(blockTimeout);
                                    isBlocked = false;
                                    loginAttempts = 0;
                                    blockedMessage.classList.add('d-none');
                                }
                            }, 1000);
                        } else {
                            attemptsCount.textContent = `Percobaan login gagal: ${loginAttempts} dari ${MAX_LOGIN_ATTEMPTS}`;
                            attemptsCount.classList.remove('d-none');
                            
                            // Animasi shake
                            loginForm.classList.add('login-shake');
                            setTimeout(() => {
                                loginForm.classList.remove('login-shake');
                            }, 600);
                        }
                        
                        showNotification('Kode keamanan salah. Silakan coba lagi.', 'error');
                    }
                    
                    loginButton.disabled = false;
                    loginSpinner.classList.add('d-none');
                    document.querySelector('.login-button-text').textContent = 'Masuk ke Aplikasi';
                    securityCodeInput.value = '';
                }, 1000);
            }
            
            // Handle logout
            function handleLogout() {
                confirmationModalTitle.textContent = 'Konfirmasi Keluar';
                confirmationModalBody.textContent = 'Apakah Anda yakin ingin keluar dari aplikasi?';
                confirmActionBtn.textContent = 'Ya, Keluar';
                
                confirmActionBtn.onclick = function() {
                    appContent.classList.add('app-content-unauthenticated');
                    loginModal.show();
                    confirmationModal.hide();
                    showNotification('Anda telah keluar dari aplikasi', 'info');
                };
                
                confirmationModal.show();
            }
            
            // Toggle mobile menu
            function toggleMobileMenu() {
                sidebarMenu.classList.toggle('mobile-show');
                sidebarOverlay.classList.toggle('mobile-show');
                
                if (sidebarMenu.classList.contains('mobile-show')) {
                    mobileMenuBtn.innerHTML = '<i class="fas fa-times"></i>';
                } else {
                    mobileMenuBtn.innerHTML = '<i class="fas fa-bars"></i>';
                }
            }
            
            // Handle form submission
            function handleFormSubmit() {
                // Validasi semua field
                const inputs = bantuanForm.querySelectorAll('input[required], select[required]');
                let isValid = true;
                
                inputs.forEach(input => {
                    if (!validateField(input)) {
                        isValid = false;
                    }
                });
                
                if (!isValid) {
                    showNotification('Harap periksa kembali form input. Terdapat data yang tidak valid.', 'error');
                    return;
                }
                
                // Ambil data dari form
                const newData = {
                    id: Date.now(),
                    namaPenerima: document.getElementById('namaPenerima').value,
                    nik: document.getElementById('nik').value,
                    namaKelompok: document.getElementById('namaKelompok').value.toUpperCase(),
                    jabatan: document.getElementById('jabatan').value,
                    desa: document.getElementById('desa').value,
                    tahunAnggaran: document.getElementById('tahunAnggaran').value,
                    jenisBantuan: document.getElementById('jenisBantuan').value,
                    tanggalPenerimaan: document.getElementById('tanggalPenerimaan').value,
                    linkDrive: document.getElementById('linkDrive').value,
                    keterangan: document.getElementById('keterangan').value,
                    tanggalInput: new Date().toISOString()
                };
                
                // Tambahkan ke array data
                bantuanData.unshift(newData);
                
                // Simpan ke localStorage
                saveData();
                
                // Reset form
                bantuanForm.reset();
                
                // Tampilkan notifikasi
                showNotification('Data bantuan berhasil disimpan', 'success');
                
                // Refresh dashboard dan tabel
                refreshDashboard();
            }
            
            // Simpan data ke localStorage
            function saveData() {
                localStorage.setItem('bantuanData', JSON.stringify(bantuanData));
            }
            
            // Refresh dashboard
            function refreshDashboard() {
                // Update stats
                document.getElementById('totalPenerima').textContent = bantuanData.length;
                
                const uniqueBantuan = [...new Set(bantuanData.map(item => item.jenisBantuan))];
                document.getElementById('totalBantuan').textContent = uniqueBantuan.length;
                
                const uniqueDesa = [...new Set(bantuanData.map(item => item.desa))];
                document.getElementById('totalDesa').textContent = uniqueDesa.length;
                
                const tahunTerbaru = bantuanData.length > 0 ? 
                    Math.max(...bantuanData.map(item => parseInt(item.tahunAnggaran))) : 
                    new Date().getFullYear();
                document.getElementById('tahunAktif').textContent = tahunTerbaru;
                
                // Update recent data table
                updateRecentDataTable();
                
                // Update charts
                updateCharts();
            }
            
            // Update recent data table
            function updateRecentDataTable() {
                const tbody = recentDataTable.querySelector('tbody');
                tbody.innerHTML = '';
                
                const recentData = bantuanData.slice(0, 5);
                
                if (recentData.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="7" class="text-center">Tidak ada data</td></tr>';
                    return;
                }
                
                recentData.forEach((data, index) => {
                    const row = document.createElement('tr');
                    
                    row.innerHTML = `
                        <td class="text-center">${index + 1}</td>
                        <td>${data.namaPenerima}</td>
                        <td>${data.nik}</td>
                        <td>${data.desa}</td>
                        <td>${data.jenisBantuan}</td>
                        <td>${formatDate(data.tanggalPenerimaan)}</td>
                        <td class="text-center"><span class="badge bg-success">Tersalurkan</span></td>
                    `;
                    
                    tbody.appendChild(row);
                });
            }
            
            // Update charts
            function updateCharts() {
                // Data untuk chart desa
                const desaCount = {};
                bantuanData.forEach(item => {
                    if (desaCount[item.desa]) {
                        desaCount[item.desa]++;
                    } else {
                        desaCount[item.desa] = 1;
                    }
                });
                
                const desaLabels = Object.keys(desaCount);
                const desaData = Object.values(desaCount);
                
                // Data untuk chart bantuan
                const bantuanCount = {};
                bantuanData.forEach(item => {
                    if (bantuanCount[item.jenisBantuan]) {
                        bantuanCount[item.jenisBantuan]++;
                    } else {
                        bantuanCount[item.jenisBantuan] = 1;
                    }
                });
                
                const bantuanLabels = Object.keys(bantuanCount);
                const bantuanDataValues = Object.values(bantuanCount);
                
                // Hancurkan chart sebelumnya jika ada
                if (desaChart) {
                    desaChart.destroy();
                }
                
                if (bantuanChart) {
                    bantuanChart.destroy();
                }
                
                // Buat chart desa
                const desaCtx = document.getElementById('desaChart').getContext('2d');
                desaChart = new Chart(desaCtx, {
                    type: 'bar',
                    data: {
                        labels: desaLabels,
                        datasets: [{
                            label: 'Jumlah Bantuan per Desa',
                            data: desaData,
                            backgroundColor: 'rgba(54, 162, 235, 0.7)',
                            borderColor: 'rgba(54, 162, 235, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    stepSize: 1
                                }
                            }
                        }
                    }
                });
                
                // Buat chart bantuan
                const bantuanCtx = document.getElementById('bantuanChart').getContext('2d');
                bantuanChart = new Chart(bantuanCtx, {
                    type: 'pie',
                    data: {
                        labels: bantuanLabels,
                        datasets: [{
                            data: bantuanDataValues,
                            backgroundColor: [
                                'rgba(255, 99, 132, 0.7)',
                                'rgba(54, 162, 235, 0.7)',
                                'rgba(255, 206, 86, 0.7)',
                                'rgba(75, 192, 192, 0.7)',
                                'rgba(153, 102, 255, 0.7)',
                                'rgba(255, 159, 64, 0.7)',
                                'rgba(199, 199, 199, 0.7)',
                                'rgba(83, 102, 255, 0.7)',
                                'rgba(40, 159, 64, 0.7)',
                                'rgba(210, 99, 132, 0.7)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });
            }
            
            // Refresh data table
            function refreshDataTable() {
                applyFilters();
            }
            
            // Apply filters to data table
            function applyFilters() {
                const searchTerm = searchInput.value.toLowerCase();
                const desaFilter = filterDesa.value;
                const tahunFilter = filterTahun.value;
                
                currentFilter = {
                    searchTerm,
                    desaFilter,
                    tahunFilter
                };
                
                filteredData = bantuanData.filter(item => {
                    // Filter berdasarkan pencarian
                    const matchesSearch = searchTerm === '' || 
                        item.namaPenerima.toLowerCase().includes(searchTerm) ||
                        item.nik.toLowerCase().includes(searchTerm) ||
                        item.desa.toLowerCase().includes(searchTerm) ||
                        item.jenisBantuan.toLowerCase().includes(searchTerm);
                    
                    // Filter berdasarkan desa
                    const matchesDesa = desaFilter === '' || item.desa === desaFilter;
                    
                    // Filter berdasarkan tahun
                    const matchesTahun = tahunFilter === '' || item.tahunAnggaran === tahunFilter;
                    
                    return matchesSearch && matchesDesa && matchesTahun;
                });
                
                currentPage = 1;
                renderTable();
            }
            
            // Reset filters
            function resetFilters() {
                searchInput.value = '';
                filterDesa.value = '';
                filterTahun.value = '';
                applyFilters();
            }
            
            // Render table dengan pagination
            function renderTable() {
                const tbody = bantuanDataTable.querySelector('tbody');
                tbody.innerHTML = '';
                
                if (filteredData.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="11" class="text-center">Tidak ada data</td></tr>';
                    tableInfo.textContent = 'Menampilkan 0 data';
                    pagination.innerHTML = '';
                    return;
                }
                
                // Hitung total halaman
                const totalPages = Math.ceil(filteredData.length / itemsPerPage);
                
                // Data untuk halaman saat ini
                const startIndex = (currentPage - 1) * itemsPerPage;
                const endIndex = Math.min(startIndex + itemsPerPage, filteredData.length);
                const currentData = filteredData.slice(startIndex, endIndex);
                
                // Render data
                currentData.forEach((data, index) => {
                    const row = document.createElement('tr');
                    const actualIndex = startIndex + index + 1;
                    
                    row.innerHTML = `
                        <td class="text-center">${actualIndex}</td>
                        <td>${data.namaPenerima}</td>
                        <td>${data.nik}</td>
                        <td>${data.namaKelompok || '-'}</td>
                        <td>${data.jabatan || '-'}</td>
                        <td>${data.desa}</td>
                        <td>${data.tahunAnggaran}</td>
                        <td>${data.jenisBantuan}</td>
                        <td>${formatDate(data.tanggalPenerimaan)}</td>
                        <td>
                            ${data.linkDrive ? 
                                `<a href="${data.linkDrive}" target="_blank" class="drive-link">Lihat</a>` : 
                                '<button class="btn btn-sm btn-outline-primary add-link-btn" data-index="${data.id}">Tambah</button>'
                            }
                        </td>
                        <td class="text-center">
                            <button class="btn btn-sm btn-primary view-btn" data-index="${data.id}">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn btn-sm btn-warning edit-btn" data-index="${data.id}">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-sm btn-danger delete-btn" data-index="${data.id}">
                                <i class="fas fa-trash-alt"></i>
                            </button>
                            <button class="btn btn-sm btn-print-individual" data-index="${data.id}">
                                <i class="fas fa-print"></i>
                            </button>
                        </td>
                    `;
                    
                    tbody.appendChild(row);
                });
                
                // Update table info
                tableInfo.textContent = `Menampilkan ${startIndex + 1} hingga ${endIndex} dari ${filteredData.length} data`;
                
                // Render pagination
                renderPagination(totalPages);
                
                // Add event listeners to buttons
                addTableButtonListeners();
            }
            
            // Render pagination
            function renderPagination(totalPages) {
                let paginationHTML = '';
                
                if (currentPage > 1) {
                    paginationHTML += `
                        <li class="page-item">
                            <a class="page-link" href="#" data-page="${currentPage - 1}">Sebelumnya</a>
                        </li>
                    `;
                }
                
                for (let i = 1; i <= totalPages; i++) {
                    paginationHTML += `
                        <li class="page-item ${i === currentPage ? 'active' : ''}">
                            <a class="page-link" href="#" data-page="${i}">${i}</a>
                        </li>
                    `;
                }
                
                if (currentPage < totalPages) {
                    paginationHTML += `
                        <li class="page-item">
                            <a class="page-link" href="#" data-page="${currentPage + 1}">Selanjutnya</a>
                        </li>
                    `;
                }
                
                pagination.innerHTML = paginationHTML;
                
                // Add event listeners to pagination links
                pagination.querySelectorAll('.page-link').forEach(link => {
                    link.addEventListener('click', function(e) {
                        e.preventDefault();
                        currentPage = parseInt(this.getAttribute('data-page'));
                        renderTable();
                    });
                });
            }
            
            // Add event listeners to table buttons
            function addTableButtonListeners() {
                // View buttons
                document.querySelectorAll('.view-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const id = parseInt(this.getAttribute('data-index'));
                        viewData(id);
                    });
                });
                
                // Edit buttons
                document.querySelectorAll('.edit-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const id = parseInt(this.getAttribute('data-index'));
                        editData(id);
                    });
                });
                
                // Delete buttons
                document.querySelectorAll('.delete-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const id = parseInt(this.getAttribute('data-index'));
                        confirmDeleteData(id);
                    });
                });
                
                // Add link buttons
                document.querySelectorAll('.add-link-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const id = parseInt(this.getAttribute('data-index'));
                        showLinkModal(id);
                    });
                });
                
                // Print individual buttons
                document.querySelectorAll('.btn-print-individual').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const id = parseInt(this.getAttribute('data-index'));
                        printIndividualData(id);
                    });
                });
            }
            
            // View data
            function viewData(id) {
                const data = bantuanData.find(item => item.id === id);
                
                if (!data) {
                    showNotification('Data tidak ditemukan', 'error');
                    return;
                }
                
                // Tampilkan modal dengan detail data
                confirmationModalTitle.textContent = 'Detail Data Bantuan';
                
                let modalBody = `
                    <div class="row">
                        <div class="col-md-6">
                            <table class="table table-borderless">
                                <tr>
                                    <th width="40%">Nama Penerima</th>
                                    <td>${data.namaPenerima}</td>
                                </tr>
                                <tr>
                                    <th>NIK</th>
                                    <td>${data.nik}</td>
                                </tr>
                                <tr>
                                    <th>Nama Kelompok</th>
                                    <td>${data.namaKelompok || '-'}</td>
                                </tr>
                                <tr>
                                    <th>Jabatan</th>
                                    <td>${data.jabatan || '-'}</td>
                                </tr>
                                <tr>
                                    <th>Desa</th>
                                    <td>${data.desa}</td>
                                </tr>
                            </table>
                        </div>
                        <div class="col-md-6">
                            <table class="table table-borderless">
                                <tr>
                                    <th width="40%">Tahun Anggaran</th>
                                    <td>${data.tahunAnggaran}</td>
                                </tr>
                                <tr>
                                    <th>Jenis Bantuan</th>
                                    <td>${data.jenisBantuan}</td>
                                </tr>
                                <tr>
                                    <th>Tanggal Penerimaan</th>
                                    <td>${formatDate(data.tanggalPenerimaan)}</td>
                                </tr>
                                <tr>
                                    <th>Link Drive</th>
                                    <td>${data.linkDrive ? `<a href="${data.linkDrive}" target="_blank">${data.linkDrive}</a>` : '-'}</td>
                                </tr>
                            </table>
                        </div>
                    </div>
                `;
                
                if (data.keterangan) {
                    modalBody += `
                        <div class="row mt-3">
                            <div class="col-12">
                                <strong>Keterangan:</strong>
                                <p>${data.keterangan}</p>
                            </div>
                        </div>
                    `;
                }
                
                confirmationModalBody.innerHTML = modalBody;
                confirmActionBtn.style.display = 'none';
                
                confirmationModal.show();
                
                // Set event listener untuk menutup modal
                confirmActionBtn.onclick = null;
                document.querySelector('#confirmationModal .btn-secondary').textContent = 'Tutup';
            }
            
            // Edit data
            function editData(id) {
                const data = bantuanData.find(item => item.id === id);
                
                if (!data) {
                    showNotification('Data tidak ditemukan', 'error');
                    return;
                }
                
                // Isi form dengan data yang ada
                document.getElementById('namaPenerima').value = data.namaPenerima;
                document.getElementById('nik').value = data.nik;
                document.getElementById('namaKelompok').value = data.namaKelompok || '';
                document.getElementById('jabatan').value = data.jabatan || '';
                document.getElementById('desa').value = data.desa;
                document.getElementById('tahunAnggaran').value = data.tahunAnggaran;
                document.getElementById('jenisBantuan').value = data.jenisBantuan;
                document.getElementById('tanggalPenerimaan').value = data.tanggalPenerimaan;
                document.getElementById('linkDrive').value = data.linkDrive || '';
                document.getElementById('keterangan').value = data.keterangan || '';
                
                // Hapus data lama
                bantuanData = bantuanData.filter(item => item.id !== id);
                
                // Simpan perubahan
                saveData();
                
                // Scroll ke form
                document.getElementById('inputData').scrollIntoView({ behavior: 'smooth' });
                
                // Tampilkan notifikasi
                showNotification('Data siap untuk diedit', 'info');
                
                // Buka tab input data
                navLinks.forEach(nav => nav.classList.remove('active'));
                document.querySelector('[data-bs-target="inputData"]').classList.add('active');
                
                contentSections.forEach(section => section.classList.add('d-none'));
                document.getElementById('inputData').classList.remove('d-none');
            }
            
            // Confirm delete data
            function confirmDeleteData(id) {
                const data = bantuanData.find(item => item.id === id);
                
                if (!data) {
                    showNotification('Data tidak ditemukan', 'error');
                    return;
                }
                
                confirmationModalTitle.textContent = 'Konfirmasi Hapus Data';
                confirmationModalBody.textContent = `Apakah Anda yakin ingin menghapus data bantuan untuk ${data.namaPenerima} (NIK: ${data.nik})?`;
                confirmActionBtn.textContent = 'Ya, Hapus';
                confirmActionBtn.style.display = 'block';
                
                confirmActionBtn.onclick = function() {
                    deleteData(id);
                    confirmationModal.hide();
                };
                
                confirmationModal.show();
            }
            
            // Delete data
            function deleteData(id) {
                bantuanData = bantuanData.filter(item => item.id !== id);
                saveData();
                applyFilters();
                refreshDashboard();
                showNotification('Data berhasil dihapus', 'success');
            }
            
            // Confirm delete all data
            function confirmDeleteAll() {
                if (bantuanData.length === 0) {
                    showNotification('Tidak ada data untuk dihapus', 'info');
                    return;
                }
                
                confirmationModalTitle.textContent = 'Konfirmasi Hapus Semua Data';
                confirmationModalBody.textContent = `Apakah Anda yakin ingin menghapus semua data (${bantuanData.length} data)? Tindakan ini tidak dapat dibatalkan.`;
                confirmActionBtn.textContent = 'Ya, Hapus Semua';
                
                confirmActionBtn.onclick = function() {
                    deleteAllData();
                    confirmationModal.hide();
                };
                
                confirmationModal.show();
            }
            
            // Delete all data
            function deleteAllData() {
                bantuanData = [];
                saveData();
                applyFilters();
                refreshDashboard();
                showNotification('Semua data berhasil dihapus', 'success');
            }
            
            // Show link modal
            function showLinkModal(id) {
                const data = bantuanData.find(item => item.id === id);
                
                if (!data) {
                    showNotification('Data tidak ditemukan', 'error');
                    return;
                }
                
                document.getElementById('modalLinkDrive').value = data.linkDrive || '';
                document.getElementById('modalLinkIndex').value = id;
                
                linkModal.show();
            }
            
            // Save link
            function saveLink() {
                const id = parseInt(document.getElementById('modalLinkIndex').value);
                const link = document.getElementById('modalLinkDrive').value;
                
                const index = bantuanData.findIndex(item => item.id === id);
                
                if (index === -1) {
                    showNotification('Data tidak ditemukan', 'error');
                    return;
                }
                
                bantuanData[index].linkDrive = link;
                saveData();
                applyFilters();
                
                linkModal.hide();
                showNotification('Link Google Drive berhasil disimpan', 'success');
            }
            
            // Handle confirm action
            function handleConfirmAction() {
                // Function ini dipanggil melalui event listener yang sudah di-set
                // pada setiap konfirmasi aksi
            }
            
            // Export to Excel
            function exportToExcel() {
                if (filteredData.length === 0) {
                    showNotification('Tidak ada data untuk diexport', 'info');
                    return;
                }
                
                try {
                    // Siapkan data untuk export
                    const dataToExport = filteredData.map(item => ({
                        'Nama Penerima': item.namaPenerima,
                        'NIK': item.nik,
                        'Nama Kelompok': item.namaKelompok || '',
                        'Jabatan': item.jabatan || '',
                        'Desa/Kelurahan': item.desa,
                        'Tahun Anggaran': item.tahunAnggaran,
                        'Jenis Bantuan': item.jenisBantuan,
                        'Tanggal Penerimaan': formatDate(item.tanggalPenerimaan),
                        'Link Google Drive': item.linkDrive || '',
                        'Keterangan': item.keterangan || ''
                    }));
                    
                    // Buat worksheet
                    const ws = XLSX.utils.json_to_sheet(dataToExport);
                    
                    // Buat workbook
                    const wb = XLSX.utils.book_new();
                    XLSX.utils.book_append_sheet(wb, ws, 'Data Bantuan');
                    
                    // Export ke file
                    const date = new Date().toISOString().slice(0, 10);
                    XLSX.writeFile(wb, `Data_Bantuan_${date}.xlsx`);
                    
                    showNotification('Data berhasil diexport ke Excel', 'success');
                } catch (error) {
                    console.error('Error exporting to Excel:', error);
                    showNotification('Gagal mengeksport data ke Excel', 'error');
                }
            }
            
            // Export to PDF
            function exportToPDF() {
                if (filteredData.length === 0) {
                    showNotification('Tidak ada data untuk diexport', 'info');
                    return;
                }
                
                try {
                    const { jsPDF } = window.jspdf;
                    const doc = new jsPDF();
                    
                    // Judul
                    doc.setFontSize(18);
                    doc.text('DATA BANTUAN TERPADU', 105, 15, { align: 'center' });
                    doc.setFontSize(12);
                    doc.text(`Dicetak pada: ${new Date().toLocaleDateString('id-ID')}`, 105, 22, { align: 'center' });
                    
                    // Siapkan data untuk tabel
                    const tableData = filteredData.map(item => [
                        item.namaPenerima,
                        item.nik,
                        item.desa,
                        item.tahunAnggaran,
                        item.jenisBantuan,
                        formatDate(item.tanggalPenerimaan)
                    ]);
                    
                    // Buat tabel
                    doc.autoTable({
                        head: [['Nama Penerima', 'NIK', 'Desa', 'Tahun', 'Jenis Bantuan', 'Tanggal']],
                        body: tableData,
                        startY: 30,
                        theme: 'grid',
                        styles: { fontSize: 8 },
                        headStyles: { fillColor: [13, 71, 161] }
                    });
                    
                    // Simpan PDF
                    const date = new Date().toISOString().slice(0, 10);
                    doc.save(`Data_Bantuan_${date}.pdf`);
                    
                    showNotification('Data berhasil diexport ke PDF', 'success');
                } catch (error) {
                    console.error('Error exporting to PDF:', error);
                    showNotification('Gagal mengeksport data ke PDF', 'error');
                }
            }
            
            // Print table
            function printTable() {
                if (filteredData.length === 0) {
                    showNotification('Tidak ada data untuk dicetak', 'info');
                    return;
                }
                
                // Buat elemen untuk print
                const printWindow = window.open('', '_blank');
                printWindow.document.write(`
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <title>Cetak Data Bantuan</title>
                        <style>
                            body { font-family: Arial, sans-serif; margin: 20px; }
                            .print-header { text-align: center; margin-bottom: 20px; }
                            .print-title { font-size: 18px; font-weight: bold; }
                            .print-subtitle { font-size: 14px; }
                            .print-date { text-align: right; margin-bottom: 10px; }
                            table { width: 100%; border-collapse: collapse; font-size: 12px; }
                            th, td { border: 1px solid #ddd; padding: 6px; text-align: left; }
                            th { background-color: #f0f0f0; }
                            @media print {
                                @page { size: landscape; margin: 0.5cm; }
                                body { margin: 0; }
                            }
                        </style>
                    </head>
                    <body>
                        <div class="print-header">
                            <div class="print-title">DATA BANTUAN TERPADU</div>
                            <div class="print-subtitle">Dinas Peternakan dan Perikanan Kabupaten Situbondo</div>
                        </div>
                        <div class="print-date">Dicetak pada: ${new Date().toLocaleDateString('id-ID')}</div>
                        <table>
                            <thead>
                                <tr>
                                    <th>No</th>
                                    <th>Nama Penerima</th>
                                    <th>NIK</th>
                                    <th>Nama Kelompok</th>
                                    <th>Jabatan</th>
                                    <th>Desa</th>
                                    <th>Tahun</th>
                                    <th>Jenis Bantuan</th>
                                    <th>Tanggal</th>
                                </tr>
                            </thead>
                            <tbody>
                `);
                
                // Isi data
                filteredData.forEach((item, index) => {
                    printWindow.document.write(`
                        <tr>
                            <td>${index + 1}</td>
                            <td>${item.namaPenerima}</td>
                            <td>${item.nik}</td>
                            <td>${item.namaKelompok || '-'}</td>
                            <td>${item.jabatan || '-'}</td>
                            <td>${item.desa}</td>
                            <td>${item.tahunAnggaran}</td>
                            <td>${item.jenisBantuan}</td>
                            <td>${formatDate(item.tanggalPenerimaan)}</td>
                        </tr>
                    `);
                });
                
                printWindow.document.write(`
                            </tbody>
                        </table>
                    </body>
                    </html>
                `);
                
                printWindow.document.close();
                printWindow.focus();
                
                // Tunggu sebentar sebelum mencetak
                setTimeout(() => {
                    printWindow.print();
                    printWindow.close();
                }, 250);
            }
            
            // Print individual data
            function printIndividualData(id) {
                const data = bantuanData.find(item => item.id === id);
                
                if (!data) {
                    showNotification('Data tidak ditemukan', 'error');
                    return;
                }
                
                const printWindow = window.open('', '_blank');
                printWindow.document.write(`
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <title>Cetak Data Bantuan - ${data.namaPenerima}</title>
                        <style>
                            body { font-family: Arial, sans-serif; margin: 20px; }
                            .print-header { text-align: center; margin-bottom: 20px; }
                            .print-title { font-size: 18px; font-weight: bold; }
                            .print-subtitle { font-size: 14px; }
                            .data-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
                            .data-table th, .data-table td { border: 1px solid #ddd; padding: 8px; }
                            .data-table th { background-color: #f0f0f0; text-align: left; width: 30%; }
                            @media print {
                                @page { margin: 1cm; }
                                body { margin: 0; }
                            }
                        </style>
                    </head>
                    <body>
                        <div class="print-header">
                            <div class="print-title">DATA BANTUAN TERPADU</div>
                            <div class="print-subtitle">Dinas Peternakan dan Perikanan Kabupaten Situbondo</div>
                        </div>
                        
                        <table class="data-table">
                            <tr>
                                <th>Nama Penerima</th>
                                <td>${data.namaPenerima}</td>
                            </tr>
                            <tr>
                                <th>NIK</th>
                                <td>${data.nik}</td>
                            </tr>
                            <tr>
                                <th>Nama Kelompok</th>
                                <td>${data.namaKelompok || '-'}</td>
                            </tr>
                            <tr>
                                <th>Jabatan</th>
                                <td>${data.jabatan || '-'}</td>
                            </tr>
                            <tr>
                                <th>Desa/Kelurahan</th>
                                <td>${data.desa}</td>
                            </tr>
                            <tr>
                                <th>Tahun Anggaran</th>
                                <td>${data.tahunAnggaran}</td>
                            </tr>
                            <tr>
                                <th>Jenis Bantuan</th>
                                <td>${data.jenisBantuan}</td>
                            </tr>
                            <tr>
                                <th>Tanggal Penerimaan</th>
                                <td>${formatDate(data.tanggalPenerimaan)}</td>
                            </tr>
                `);
                
                if (data.linkDrive) {
                    printWindow.document.write(`
                        <tr>
                            <th>Link Google Drive</th>
                            <td>${data.linkDrive}</td>
                        </tr>
                    `);
                }
                
                if (data.keterangan) {
                    printWindow.document.write(`
                        <tr>
                            <th>Keterangan</th>
                            <td>${data.keterangan}</td>
                        </tr>
                    `);
                }
                
                printWindow.document.write(`
                        </table>
                        
                        <div style="margin-top: 40px; text-align: right;">
                            <div>Situbondo, ${new Date().toLocaleDateString('id-ID')}</div>
                            <div style="margin-top: 60px;">(___________________)</div>
                        </div>
                    </body>
                    </html>
                `);
                
                printWindow.document.close();
                printWindow.focus();
                
                // Tunggu sebentar sebelum mencetak
                setTimeout(() => {
                    printWindow.print();
                    printWindow.close();
                }, 250);
            }
            
            // Backup data
            function backupData() {
                if (bantuanData.length === 0) {
                    showNotification('Tidak ada data untuk dicadangkan', 'info');
                    return;
                }
                
                const dataStr = JSON.stringify(bantuanData, null, 2);
                const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
                
                const exportFileDefaultName = `backup_bantuan_${new Date().toISOString().slice(0,10)}.json`;
                
                const linkElement = document.createElement('a');
                linkElement.setAttribute('href', dataUri);
                linkElement.setAttribute('download', exportFileDefaultName);
                linkElement.click();
                
                showNotification('Data berhasil dicadangkan', 'success');
            }
            
            // Restore data
            function restoreData() {
                const file = restoreDataInput.files[0];
                
                if (!file) {
                    showNotification('Pilih file backup terlebih dahulu', 'error');
                    return;
                }
                
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    try {
                        const restoredData = JSON.parse(e.target.result);
                        
                        if (!Array.isArray(restoredData)) {
                            throw new Error('Format file tidak valid');
                        }
                        
                        // Konfirmasi restore
                        confirmationModalTitle.textContent = 'Konfirmasi Pulihkan Data';
                        confirmationModalBody.textContent = `Apakah Anda yakin ingin memulihkan ${restoredData.length} data? Data saat ini akan digantikan.`;
                        confirmActionBtn.textContent = 'Ya, Pulihkan';
                        
                        confirmActionBtn.onclick = function() {
                            bantuanData = restoredData;
                            saveData();
                            applyFilters();
                            refreshDashboard();
                            restoreDataInput.value = '';
                            restoreDataBtn.disabled = true;
                            confirmationModal.hide();
                            showNotification('Data berhasil dipulihkan', 'success');
                        };
                        
                        confirmationModal.show();
                    } catch (error) {
                        console.error('Error restoring data:', error);
                        showNotification('Gagal memulihkan data. File mungkin rusak atau format tidak sesuai.', 'error');
                    }
                };
                
                reader.readAsText(file);
            }
            
            // Confirm reset app
            function confirmResetApp() {
                confirmationModalTitle.textContent = 'Konfirmasi Reset Aplikasi';
                confirmationModalBody.textContent = 'Apakah Anda yakin ingin mereset aplikasi? Semua data akan dihapus dan pengaturan akan dikembalikan ke awal. Tindakan ini tidak dapat dibatalkan.';
                confirmActionBtn.textContent = 'Ya, Reset Aplikasi';
                
                confirmActionBtn.onclick = function() {
                    resetApp();
                    confirmationModal.hide();
                };
                
                confirmationModal.show();
            }
            
            // Reset app
            function resetApp() {
                localStorage.removeItem('bantuanData');
                localStorage.removeItem('securityCode');
                
                bantuanData = [];
                loginAttempts = 0;
                isBlocked = false;
                
                if (blockTimeout) {
                    clearInterval(blockTimeout);
                }
                
                applyFilters();
                refreshDashboard();
                
                showNotification('Aplikasi telah direset ke pengaturan awal', 'success');
                
                // Reload halaman setelah beberapa detik
                setTimeout(() => {
                    window.location.reload();
                }, 2000);
            }
            
            // Update security code
            function updateSecurityCode() {
                const newCode = newSecurityCode.value;
                const confirmCode = confirmSecurityCode.value;
                
                if (!newCode || !confirmCode) {
                    showNotification('Harap isi kedua field kode keamanan', 'error');
                    return;
                }
                
                if (newCode !== confirmCode) {
                    showNotification('Kode keamanan baru tidak cocok', 'error');
                    return;
                }
                
                localStorage.setItem('securityCode', newCode);
                currentSecurityCode.value = newCode;
                
                newSecurityCode.value = '';
                confirmSecurityCode.value = '';
                
                showNotification('Kode keamanan berhasil diperbarui', 'success');
            }
            
            // Format tanggal
            function formatDate(dateString) {
                const options = { day: '2-digit', month: '2-digit', year: 'numeric' };
                return new Date(dateString).toLocaleDateString('id-ID', options);
            }
            
            // Tampilkan notifikasi
            function showNotification(message, type = 'info') {
                // Set kelas berdasarkan jenis notifikasi
                const toast = document.getElementById('notificationToast');
                
                toast.classList.remove('bg-primary', 'bg-success', 'bg-warning', 'bg-danger');
                
                switch (type) {
                    case 'success':
                        toast.classList.add('bg-success');
                        break;
                    case 'warning':
                        toast.classList.add('bg-warning');
                        break;
                    case 'error':
                        toast.classList.add('bg-danger');
                        break;
                    default:
                        toast.classList.add('bg-primary');
                }
                
                // Set pesan
                toastMessage.textContent = message;
                
                // Tampilkan notifikasi
                notificationToast.show();
            }
            
            // Inisialisasi aplikasi
            initApp();
        });
    </script>
</body>
</html>
